function initApp(){update_lang(),isIEMobile&&insertStyle(".ui-toolbar-back-btn{display:none!important}ul{list-style: none !important;}@media(max-width:940px){.wicon{margin:-10px -10px -15px -15px !important}#forecast .wicon{position:relative;left:37.5px;margin:0 auto !important}}"),isIE&&"9"===isIE[1]&&insertStyle(".input_with_buttons button{zoom:1!important}"),isChromeApp&&insertStyle("html,body{overflow-y:scroll}"),isAndroid?(insertStyle(".ui-toolbar-back-btn{display:none!important}"),$(this).ajaxStart(function(){try{navigator.app.clearCache()}catch(a){}})):$.ajaxSetup(isFireFoxOS?{xhrFields:{mozSystem:!0}}:{cache:!1}),$("#site-selector").on("change",function(){update_site($(this).val())}),$("#auto-scan").find("a").on("click",function(){return start_scan(),!1}),$("#sprinklers").on("datarefresh",check_status).find("div[data-role='header'] > .ui-btn-left").on("click",function(){return open_panel(),!1}),$("#stop-all").on("click",function(){areYouSure(_("Are you sure you want to stop all stations?"),"",function(){$.mobile.loading("show"),send_to_os("/cv?pw=&rsn=1").done(function(){$.mobile.loading("hide"),showLoading("#footer-running"),setTimeout(function(){$.when(update_controller_settings(),update_controller_status()).then(check_status)},1e3),showerror(_("All stations have been stopped"))})})}),(isChromeApp||isOSXApp)&&checkAutoScan()}function flipSwitched(){if(!switching){var a,b=$(this),c=b.attr("id"),d=b.is(":checked"),e="mmm"===c?"mm":c;a=send_to_os(d?"/cv?pw=&"+e+"=1":"/cv?pw=&"+e+"=0"),$.when(a).then(function(){update_controller_settings(),update_controller_status(),"mmm"===c&&$("#mm_list .green").removeClass("green"),check_status()},function(){switching=!0,setTimeout(function(){switching=!1},200),b.prop("checked",!d).flipswitch("refresh")})}}function send_to_os(a,b){a=a.replace("pw=","pw="+encodeURIComponent(curr_pw)),b=b||"text";var c,d={url:curr_prefix+curr_ip+a,type:"GET",dataType:b,retry:{times:retryCount,statusCodes:[0,408,500]}};return curr_auth&&$.extend(d,{beforeSend:function(a){a.setRequestHeader("Authorization","Basic "+btoa(curr_auth_user+":"+curr_auth_pw))}}),curr_183&&$.extend(d,{cache:"true"}),c=$.ajaxQueue(d).then(function(b){if("string"==typeof b)try{b=$.parseJSON(b)}catch(c){return b}return"object"!=typeof b||"number"!=typeof b.result?b:1===b.result?b:2===b.result?(showerror(_("Check device password and try again.")),$.Deferred().reject({status:401})):32===b.result?$.Deferred().reject({status:401}):/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|up|cm)/.exec(a)?(showerror(_(2===b.result?"Check device password and try again.":48===b.result?"The selected station is already running or is scheduled to run.":"Please check input and try again.")),$.Deferred().reject(b)):void 0},function(b){"timeout"!==b.statusText&&0!==b.status||!/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|cm)/.exec(a)?401===b.status&&showerror(_("Check device password and try again.")):showerror(_("Connection timed-out. Please try again."))})}function network_fail(){change_status(0,"red","<p class='running-text center'>"+_("Network Error")+"</p>",function(){showLoading("#weather,#footer-running"),refresh_status(),update_weather()}),hide_weather()}function newload(){var a=$("#site-selector").val(),b="<div class='logo'></div><h1 style='padding-top:5px'>"+_("Connecting to")+" "+a+"</h1><p class='cancel tight center inline-icon'><span class='btn-no-border ui-btn ui-icon-delete ui-btn-icon-notext'></span>Cancel</p>";$.mobile.loading("show",{html:curr_local?"<h1>"+_("Loading")+"</h1>":b,textVisible:!0,theme:"b"}),$(".ui-loader").css({"box-shadow":"none","margin-top":"-4em"}).find(".cancel").one("click",function(){$.ajaxQueue.clear(),changePage("#site-control",{showBack:!1})}),controller={},$.ajaxQueue.clear(),update_controller(function(){var b=$("#log_button"),c=$(".manual_mode"),d=$(".weatherAdjust"),e=$(".change_password");$.mobile.loading("hide"),check_status(),update_weather(),checkOSVersion(210)?(c.hide(),d.css("display","")):(c.css("display",""),d.hide()),checkOSVersion(206)||checkOSPiVersion("1.9")?b.css("display",""):b.hide(),isOSPi()||checkOSVersion(208)?e.css("display",""):e.hide(),curr_local?$("#info-list").find("li[data-role='list-divider']").text(_("Information")):($("#info-list").find("li[data-role='list-divider']").text(a),document.title="OpenSprinkler - "+a),checkWeatherPlugin(),goHome()},function(){$.ajaxQueue.clear(),controller={},curr_local?storage.remove(["sites"],function(){window.location.reload()}):changePage("#site-control",{showBack:!1})})}function update_controller(a,b){a=a||function(){},b=b||function(){},$.when(update_controller_programs(),update_controller_stations(),update_controller_options(),update_controller_status(),update_controller_settings()).then(a,b)}function update_controller_programs(a){return a=a||function(){},curr_183===!0?send_to_os("/gp?d=0").done(function(b){for(var c,d,e=b.match(/(nprogs|nboards|mnp)=[\w|\d|.\"]+/g),f=/pd=\[\];(.*);/.exec(b),g={},h=0;h<e.length;h++)""!==e[h]&&(c=e[h].split("="),g[c[0]]=parseInt(c[1]));if(g.pd=[],null!==f)for(f=f[1].split(";"),h=0;h<f.length;h++)d=f[h].split("="),d=d[1].replace("[",""),d=d.replace("]",""),g.pd[h]=parseIntArray(d.split(","));controller.programs=g,a()}):send_to_os("/jp?pw=","json").done(function(b){controller.programs=b,a()})}function update_controller_stations(a){return a=a||function(){},curr_183===!0?send_to_os("/vs").done(function(b){var c=/snames=\[(.*?)\];/.exec(b),d=b.match(/(?:masop|mo)\s?[=|:]\s?\[(.*?)\]/);c=c[1].split(","),c.pop();for(var e=0;e<c.length;e++)c[e]=c[e].replace(/'/g,"");d=parseIntArray(d[1].split(",")),controller.stations={snames:c,masop:d,maxlen:c.length},a()}):send_to_os("/jn?pw=","json").done(function(b){controller.stations=b,a()})}function update_controller_options(a){return a=a||function(){},curr_183===!0?send_to_os("/vo").done(function(b){var c,d,e,f=b.match(/var sd\s*=/),g={};if(f){for(var h,i=/(tz|htp|htp2|nbrd|seq|sdt|mas|mton|mtoff|urs|rst|wl|ipas)\s?[=|:]\s?([\w|\d|.\"]+)/gm;null!==(c=i.exec(b));)h=c[1].replace("nbrd","ext").replace("mtoff","mtof"),g[h]=+c[2];g.ext--,g.fwv="1.8.3-ospi"}else{var j={1:"tz",2:"ntp",12:"hp0",13:"hp1",14:"ar",15:"ext",16:"seq",17:"sdt",18:"mas",19:"mton",20:"mtof",21:"urs",22:"rso",23:"wl",25:"ipas",26:"devid",36:"lg"};for(c=/var opts=\[(.*)\];/.exec(b),c=c[1].replace(/"/g,"").split(","),d=0;d<c.length-1;d+=4)e=+c[d+3],-1!==$.inArray(e,[1,2,12,13,14,15,16,17,18,19,20,21,22,23,25,26,36])&&(g[j[e]]=+c[d+2]);g.fwv=183}controller.options=g,a()}):send_to_os("/jo?pw=","json").done(function(b){controller.options=b,a()})}function update_controller_status(a){return a=a||function(){},curr_183===!0?send_to_os("/sn0").then(function(b){var c=b.toString().match(/\d+/);c=parseIntArray(c[0].split("")),controller.status=c,a()},function(){controller.status=[]}):send_to_os("/js?pw=","json").then(function(b){controller.status=b.sn,a()},function(){controller.status=[]})}function update_controller_settings(a){return a=a||function(){},curr_183===!0?send_to_os("").then(function(a){var b,c,d=/(ver|devt|nbrd|tz|en|rd|rs|mm|rdst|urs)\s?[=|:]\s?([\w|\d|.\"]+)/gm,e=a.match(/loc\s?[=|:]\s?[\"|'](.*)[\"|']/),f=a.match(/lrun=\[(.*)\]/),g=a.match(/ps=\[(.*)\];/),h={};for(g=g[1].split("],["),c=g.length-1;c>=0;c--)g[c]=parseIntArray(g[c].replace(/\[|\]/g,"").split(","));for(;null!==(b=d.exec(a));)h[b[1]]=+b[2];h.loc=e[1],h.ps=g,h.lrun=parseIntArray(f[1].split(",")),controller.settings=h},function(){if(controller.settings&&controller.stations){var a,b=[];for(a=0;a<controller.stations.maxlen;a++)b.push([0,0]);controller.settings.ps=b}}):send_to_os("/jc?pw=","json").then(function(b){"undefined"==typeof b.lrun&&(b.lrun=[0,0,0,0]),controller.settings=b,a()},function(){if(controller.settings&&controller.stations){var a,b=[];for(a=0;a<controller.stations.maxlen;a++)b.push([0,0]);controller.settings.ps=b}})}function check_configured(a){storage.get(["sites","current_site"],function(b){var c,d=b.sites,e=b.current_site;try{d=JSON.parse(d)||{}}catch(f){d={}}return c=Object.keys(d),c.length?null!==e&&e in d?(update_site_list(c,e),curr_ip=d[e].os_ip,curr_pw=d[e].os_pw,curr_prefix="undefined"!=typeof d[e].ssl&&"1"===d[e].ssl?"https://":"http://","undefined"!=typeof d[e].auth_user&&"undefined"!=typeof d[e].auth_pw?(curr_auth=!0,curr_auth_user=d[e].auth_user,curr_auth_pw=d[e].auth_pw):curr_auth=!1,curr_183=d[e].is183?!0:!1,void newload()):($.mobile.loading("hide"),void changePage("#site-control",{showBack:!1})):void(a&&changePage("#start",{showStart:!0}))})}function submit_newuser(a,b){document.activeElement.blur(),$.mobile.loading("show");var c,d=$.mobile.path.parseUrl($("#os_ip").val()).hrefNoHash.replace(/https?:\/\//,""),e=function(c,e){$.mobile.loading("hide");var f;if(("string"==typeof c&&c.match(/var (en|sd)\s*=/)||"number"==typeof c.fwv&&203===c.fwv)&&(f=!0),void 0!==c.fwv||f===!0){var g=$("#os_name").val();""===g&&(g="Site "+(Object.keys(e).length+1)),e[g]={},e[g].os_ip=curr_ip=d,e[g].os_pw=curr_pw=$("#os_pw").val(),a?(e[g].ssl="1",curr_prefix="https://"):curr_prefix="http://",b?(e[g].auth_user=$("#os_auth_user").val(),e[g].auth_pw=$("#os_auth_pw").val(),curr_auth=!0,curr_auth_user=e[g].auth_user,curr_auth_pw=e[g].auth_pw):curr_auth=!1,f===!0&&(e[g].is183="1",curr_183=!0),$("#os_name,#os_ip,#os_pw,#os_auth_user,#os_auth_pw").val(""),storage.set({sites:JSON.stringify(e),current_site:g},function(){update_site_list(Object.keys(e),g),newload()})}else showerror(_("Check IP/Port and try again."))},f=function(c){return b||401!==c.status?void(a?($.mobile.loading("hide"),showerror(_("Check IP/Port and try again."))):submit_newuser(!0)):void g()},g=function(){$("#addnew-auth").length?submit_newuser(a,!0):h()},h=function(){$.mobile.loading("hide");var b=$("<div class='ui-content' id='addnew-auth'><form method='post' novalidate><p class='center smaller'>"+_("Authorization Required")+"</p><label for='os_auth_user'>"+_("Username:")+"</label><input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' name='os_auth_user' id='os_auth_user'><label for='os_auth_pw'>"+_("Password:")+"</label><input type='password' name='os_auth_pw' id='os_auth_pw'><input type='submit' value='"+_("Submit")+"'></form></div>").enhanceWithin();b.on("submit","form",function(){return submit_newuser(a,!0),!1}),$("#addnew-content").hide(),$("#addnew").append(b).popup("reposition",{positionTo:"window"})};return d?b!==!0&&$("#os_useauth").is(":checked")?void g():($("#os_usessl").is(":checked")===!0&&(a=!0),c=a?"https://":"http://",b&&($("#addnew-auth").hide(),$("#addnew-content").show(),$("#addnew").popup("reposition",{positionTo:"window"})),void $.ajax({url:c+d+"/jo?pw="+$("#os_pw").val(),type:"GET",dataType:"json",timeout:3e3,global:!1,beforeSend:function(a){b&&a.setRequestHeader("Authorization","Basic "+btoa($("#os_auth_user").val()+":"+$("#os_auth_pw").val()))},error:function(a){return b||401!==a.status?void $.ajax({url:c+d,type:"GET",dataType:"text",timeout:3e3,global:!1,cache:!0,beforeSend:function(a){b&&a.setRequestHeader("Authorization","Basic "+btoa($("#os_auth_user").val()+":"+$("#os_auth_pw").val()))},success:function(a){storage.get("sites",function(b){var c=void 0===b.sites||null===b.sites?{}:JSON.parse(b.sites);e(a,c)})},error:f}):void g()},success:function(a){storage.get("sites",function(b){var c=void 0===b.sites||null===b.sites?{}:JSON.parse(b.sites);e(a,c)})}})):void showerror(_("An IP address is required to continue."))}function show_site_select(a){$("#site-select").popup("destroy").remove();var b=$("<div data-role='popup' id='site-select' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+_("Select Site")+"</h1></div><div class='ui-content'><ul data-role='none' class='ui-listview ui-corner-all ui-shadow'></ul></div></div>");a&&b.find("ul").html(a),b.one("popupafterclose",function(){$(this).popup("destroy").remove()}).popup({history:!1,positionTo:"window"}).enhanceWithin().popup("open")}function show_addnew(a,b){$("#addnew").popup("destroy").remove();var c=a?!0:!1,d=$("<div data-role='popup' id='addnew' data-theme='a'><div data-role='header' data-theme='b'><h1>"+_("New Device")+"</h1></div><div class='ui-content' id='addnew-content'><form method='post' novalidate>"+(c?"":"<p class='center smaller'>"+_("Note: The name is used to identify the OpenSprinkler within the app. OpenSprinkler IP can be either an IP or hostname. You can also specify a port by using IP:Port")+"</p>")+"<label for='os_name'>"+_("Open Sprinkler Name:")+"</label><input autocorrect='off' spellcheck='false' type='text' name='os_name' id='os_name' placeholder='Home'>"+(c?"":"<label for='os_ip'>"+_("Open Sprinkler IP:")+"</label>")+"<input "+(c?"data-role='none' style='display:none' ":"")+"autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='url' pattern='' name='os_ip' id='os_ip' value='"+(c?a:"")+"' placeholder='home.dyndns.org'><label for='os_pw'>"+_("Open Sprinkler Password:")+"</label><input type='password' name='os_pw' id='os_pw' value=''>"+(c?"":"<div data-theme='a' data-mini='true' data-role='collapsible'><h4>Advanced</h4><fieldset data-role='controlgroup' data-type='horizontal' data-mini='true' class='center'><input type='checkbox' name='os_useauth' id='os_useauth'><label for='os_useauth'>"+_("Use Auth")+"</label><input type='checkbox' name='os_usessl' id='os_usessl'><label for='os_usessl'>"+_("Use SSL")+"</label></fieldset></div>")+"<input type='submit' data-theme='b' value='"+_("Submit")+"'></form></div></div>");d.find("form").on("submit",function(){return submit_newuser(),!1}),d.one("popupafterclose",function(){$(this).popup("destroy").remove()}).popup({history:!1,positionTo:"window"}).enhanceWithin(),b?$(".ui-popup-active").children().first().one("popupafterclose",function(){d.popup("open")}).popup("close"):d.popup("open"),fixInputClick(d),d.find(".ui-collapsible-heading-toggle").on("click",function(){var a=$(this).parents(".ui-collapsible").hasClass("ui-collapsible-collapsed"),b=$.mobile.pageContainer.pagecontainer("getActivePage"),c=parseInt(b.css("min-height"));a?b.css("min-height",c+65+"px"):b.css("min-height",c-65+"px"),d.popup("reposition",{positionTo:"window"})})}function show_sites(a){var b,c,d=$("<div data-role='page' id='site-control'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false' data-hide-during-focus=''><a role='button' href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Manage Sites")+"</h3><button id='site-add' data-icon='plus' class='ui-btn-right'>"+_("Add")+"</button></div><div class='ui-content'></div><div data-role='popup' id='addsite' data-theme='b'><ul data-role='listview'><li data-icon='false'><a href='#' id='site-add-scan'>"+_("Scan For Device")+"</a></li><li data-icon='false'><a href='#' id='site-add-manual'>"+_("Manually Add Device")+"</a></li></ul></div></div>"),e=d.find("#addsite"),f=d.find("#site-add");d.find(".ui-toolbar-back-btn").on("click",checkChangesBeforeBack),e.popup({history:!1,positionTo:f}).enhanceWithin(),f.on("click",function(){"undefined"==typeof deviceip?show_addnew():e.popup("open").popup("reposition",{positionTo:"#site-add"})}),e.find("#site-add-scan").on("click",function(){return e.popup("close"),start_scan(),!1}),e.find("#site-add-manual").on("click",function(){return show_addnew(!1,!0),!1}),d.one("pagehide",function(){d.remove()}),storage.get(["sites","current_site"],function(e){if(void 0===e.sites||null===e.sites)changePage("#start",{showStart:!0});else{var f="<div data-role='collapsible-set'>",g=[],h=0;b=JSON.parse(e.sites),c=Object.keys(b).length,c&&a!==!1&&e.current_site in b||(d.one("pagebeforeshow",function(){d.find(".ui-btn-left").hide()}),document.title="OpenSprinkler"),$.each(b,function(a,b){g.push(a),a=htmlEscape(a),f+="<fieldset "+(1===c?"data-collapsed='false'":"")+" id='site-"+h+"' data-role='collapsible'>",f+="<legend>"+a+"</legend>",f+="<a data-role='button' class='connectnow' data-site='"+h+"' href='#'>"+_("Connect Now")+"</a>",f+="<form data-site='"+h+"' novalidate>",f+="<label for='cnm-"+h+"'>"+_("Change Name")+"</label><input id='cnm-"+h+"' type='text' placeholder='"+a+"'>",f+="<label for='cip-"+h+"'>"+_("Change IP")+"</label><input id='cip-"+h+"' type='url' placeholder='"+b.os_ip+"' autocomplete='off' autocorrect='off' autocapitalize='off' pattern='' spellcheck='false'>",f+="<label for='cpw-"+h+"'>"+_("Change Password")+"</label><input id='cpw-"+h+"' type='password'>",f+="<input class='submit' type='submit' value='"+_("Save Changes to")+" "+a+"'></form>",f+="<a data-role='button' class='deletesite' data-site='"+h+"' href='#' data-theme='b'>"+_("Delete")+" "+a+"</a>",f+="</fieldset>",h++}),f=$(f+"</div>"),f.find("form").one("change input",function(){$(this).find(".submit").addClass("hasChanges")}),f.find(".connectnow").on("click",function(){return update_site(g[$(this).data("site")]),!1}),f.find("form").on("submit",function(){var a=$(this),c=a.data("site"),d=g[c],h=f.find("#cip-"+c).val(),i=f.find("#cpw-"+c).val(),j=f.find("#cnm-"+c).val(),k=d===e.current_site,l=""!==j&&j!==d;return a.find(".submit").removeClass("hasChanges"),""!==h&&(b[d].os_ip=h),""!==i&&(b[d].os_pw=i),l&&(b[j]=b[d],delete b[d],d=j,k&&(storage.set({current_site:d}),e.current_site=d),update_site_list(Object.keys(b),e.current_site)),storage.set({sites:JSON.stringify(b)}),showerror(_("Site updated successfully")),d===e.current_site&&(""!==i&&(curr_pw=i),""!==h&&check_configured()),l&&changePage("#site-control"),!1}),f.find(".deletesite").on("click",function(){var a=g[$(this).data("site")];return delete b[a],storage.set({sites:JSON.stringify(b)},function(){return update_site_list(Object.keys(b),e.current_site),$.isEmptyObject(b)?(changePage("#start",{showStart:!0}),!1):(changePage("#site-control",{showLoadMsg:!1}),showerror(_("Site deleted successfully")),!1)}),!1}),d.find(".ui-content").html(f.enhanceWithin())}}),$("#site-control").remove(),d.appendTo("body")}function update_site_list(a,b){var c="",d=$("#site-selector");$.each(a,function(a,d){c+="<option "+(d===b?"selected ":"")+"value='"+htmlEscape(d)+"'>"+d+"</option>"}),$("#info-list").find("li[data-role='list-divider']").text(b),d.html(c),d.parent().parent().hasClass("ui-select")&&d.selectmenu("refresh")}function update_site(a){storage.get("sites",function(b){var c=void 0===b.sites||null===b.sites?{}:JSON.parse(b.sites);a in c&&storage.set({current_site:a},check_configured)})}function checkAutoScan(){var a,b=function(){if(void 0===a)return void resetStartMenu();if(!isLocalIP(a))return void resetStartMenu();var b=$("#auto-scan"),c=b.next();c.removeClass("ui-first-child").find("a.ui-btn").text(_("Manually Add Device")),b.show(),deviceip=a};try{isChromeApp?chrome.system.network.getNetworkInterfaces(function(c){var d;for(d in c)c.hasOwnProperty(d)&&/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/.test(c[d].address)&&(a=c[d].address);b()}):networkinterface.getIPAddress(function(c){a=c,b()})}catch(c){find_router(function(c,d){return c===!1?void resetStartMenu():(a=d,void b())})}}function isLocalIP(a){var b=parseIntArray(a.split("."));return 10===b[0]||172===b[0]&&b[1]>17&&b[1]<32||192===b[0]&&168===b[1]}function resetStartMenu(){var a=$("#auto-scan"),b=a.next();deviceip=void 0,b.addClass("ui-first-child").find("a.ui-btn").text(_("Add Controller")),a.hide()}function start_scan(a,b){var c,d,e,f,g,h,i,j,k,l=deviceip.split("."),m=1,n=0,o="",p="",q=[],r=!1;for(b=b||0,a="number"==typeof a?a:80,storage.get("sites",function(a){var b,c=void 0===a.sites||null===a.sites?{}:JSON.parse(a.sites);for(b in c)c.hasOwnProperty(b)&&q.push(c[b].os_ip)}),e=function(){m++},f=function(a){m++;var b,c,d=$.mobile.path.parseUrl(this.url).authority;if(-1===$.inArray(d,q)){if("text"===this.dataType){if(c=a.match(/var\s*ver=(\d+)/),!c)return;b=c[1]}else{if(!a.hasOwnProperty("fwv"))return;b=a.fwv}n++,o+="<li><a class='ui-btn ui-btn-icon-right ui-icon-carat-r' href='#' data-ip='"+d+"'>"+d+"<p>"+_("Firmware")+": "+getOSVersion(b)+"</p></a></li>"}},h=function(){return r===!0?($.mobile.loading("hide"),clearInterval(i),!1):void(245===m&&($.mobile.loading("hide"),clearInterval(i),n?(o=$(o),o.find("a").on("click",function(){return add_found($(this).data("ip")),!1}),show_site_select(o)):0===b?start_scan(8080,1):1===b?start_scan(80,2):2===b?start_scan(8080,3):showerror(_("No new devices were detected on your network"))))},l.pop(),g=l.join("."),0===b?k=_("Scanning for OpenSprinkler"):1===b?k=_("Scanning for OpenSprinkler Pi"):2===b?k=_("Scanning for OpenSprinkler (1.8.3)"):3===b&&(k=_("Scanning for OpenSprinkler Pi (1.8.3)")),$.mobile.loading("show",{html:"<h1>"+k+"</h1><p class='cancel tight center inline-icon'><span class='btn-no-border ui-btn ui-icon-delete ui-btn-icon-notext'></span>"+_("Cancel")+"</p>",textVisible:!0,theme:"b"}),$(".ui-loader").find(".cancel").one("click",function(){r=!0}),c=1;244>=c;c++)l=g+"."+c,2>b?(p="/jo",j="json"):j="text",d="http://"+l+(a&&80!==a?":"+a:"")+p,$.ajax({url:d,type:"GET",dataType:j,timeout:3e3,global:!1,error:e,success:f});i=setInterval(h,200)}function find_router(a){a=a||function(){};var b,c,d,e=["192.168.1.1","10.0.1.1","192.168.1.220","192.168.2.1","10.1.1.1","192.168.11.1","192.168.0.1","192.168.0.30","192.168.0.50","192.168.10.1","192.168.20.1","192.168.30.1","192.168.62.1","192.168.102.1","192.168.1.254","192.168.0.227","10.0.0.138","192.168.123.254","192.168.4.1","10.0.0.2","10.0.2.1","10.0.3.1","10.0.4.1","10.0.5.1"],f=e.length,g=0,h=!1,i=function(a,b){g++,a===!0&&(c=b)},j=function(){return h===!0?($.mobile.loading("hide"),clearInterval(b),!1):void((g===f||"string"==typeof c)&&($.mobile.loading("hide"),clearInterval(b),"string"==typeof c?a(!0,c):a(!1)))};for($(".ui-loader").find(".cancel").one("click",function(){h=!0}),d=0;f>d;d++)"string"!=typeof c&&ping(e[d],i);b=setInterval(j,50)}function ping(a,b){b=b||function(){},a&&""!==a||b(!1),$.ajax({url:"http://"+a,type:"GET",timeout:3e3,global:!1}).then(function(){b(!0,a)},function(c){"timeout"===c.statusText?b(!1):b(!0,a)})}function add_found(a){$("#site-select").one("popupafterclose",function(){show_addnew(a)}).popup("close")}function show_weather_settings(){var a=$("<div data-role='page' id='weather_settings'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false' data-hide-during-focus=''><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Weather Settings")+"</h3><a href='#' class='ui-btn-right wsubmit'>"+_("Submit")+"</a></div><div class='ui-content' role='main'><ul data-role='listview' data-inset='true'><li><label for='weather_provider'>"+_("Weather Provider")+"</label><select data-mini='true' id='weather_provider'><option value='yahoo' "+("yahoo"===curr_wa.weather_provider?"selected":"")+">"+_("Yahoo!")+"</option><option value='wunderground' "+("wunderground"===curr_wa.weather_provider?"selected":"")+">"+_("Wunderground")+"</option></select><label "+("wunderground"===curr_wa.weather_provider?"":"style='display:none' ")+"for='wapikey'>"+_("Wunderground API Key")+"</label><input "+("wunderground"===curr_wa.weather_provider?"":"style='display:none' ")+"data-mini='true' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' id='wapikey' value='"+curr_wa.wapikey+"'></li></ul><ul data-role='listview' data-inset='true'> <li><p class='rain-desc'>"+_("When automatic rain delay is enabled, the weather will be checked for rain every hour. If the weather reports any condition suggesting rain, a rain delay is automatically issued using the below set delay duration.")+"</p><div class='ui-field-contain'><label for='auto_delay'>"+_("Auto Rain Delay")+"</label><input type='checkbox' data-on-text='On' data-off-text='Off' data-role='flipswitch' name='auto_delay' id='auto_delay' "+("on"===curr_wa.auto_delay?"checked":"")+"></div><div class='ui-field-contain duration-input'><label for='delay_duration'>"+_("Delay Duration")+"</label><button id='delay_duration' data-mini='true' value='"+3600*curr_wa.delay_duration+"'>"+dhms2str(sec2dhms(3600*curr_wa.delay_duration))+"</button></div></li></ul><a class='wsubmit' href='#' data-role='button' data-theme='b' type='submit'>"+_("Submit")+"</a></div></div>");a.find("#weather_provider").on("change",function(){var b=$(this).val();"wunderground"===b?(a.find("#wapikey,label[for='wapikey']").show("fast"),a.find("#wapikey").parent(".ui-input-text").css("border-style","solid")):(a.find("#wapikey,label[for='wapikey']").hide("fast"),a.find("#wapikey").parent(".ui-input-text").css("border-style","none"))}),a.find(".wsubmit").on("click",function(){return submit_weather_settings(),!1}),a.find("#delay_duration").on("click",function(){var b=$(this),c=a.find("label[for='"+b.attr("id")+"']").text();showDurationBox({seconds:b.val(),title:c,callback:function(a){b.val(a),b.text(dhms2str(sec2dhms(a)))},maximum:345600,granularity:2})}),a.one({pagehide:function(){a.remove()},pagebeforeshow:function(){"wunderground"!==curr_wa.weather_provider&&a.find("#wapikey").parent(".ui-input-text").css("border-style","none")}}),$("#weather_settings").remove(),a.appendTo("body")}function submit_weather_settings(){var a="/uwa?auto_delay="+($("#auto_delay").is(":checked")?"on":"off")+"&delay_duration="+parseInt($("#delay_duration").val()/3600)+"&weather_provider="+$("#weather_provider").val()+"&wapikey="+$("#wapikey").val();$.mobile.loading("show"),send_to_os(a).then(function(){$.mobile.document.one("pageshow",function(){showerror(_("Weather settings have been saved"))}),goBack(),checkWeatherPlugin()},function(){showerror(_("Weather settings were not saved. Please try again."))})}function convert_temp(a,b){return"United States"===b||"Bermuda"===b||"Palau"===b?a+="&#176;F":a=parseInt(Math.round((a-32)*(5/9)))+"&#176;C",a}function hide_weather(){$("#weather-list").animate({"margin-left":"-1000px"},1e3,function(){$(this).hide()})}function update_weather(){return"undefined"!=typeof controller.settings.wtkey&&""!==controller.settings.wtkey?void update_wunderground_weather(controller.settings.wtkey):void storage.get(["provider","wapikey"],function(a){return""===controller.settings.loc?void hide_weather():(showLoading("#weather"),void("wunderground"===a.provider&&a.wapikey?update_wunderground_weather(a.wapikey):update_yahoo_weather()))})}function weather_update_failed(a,b,c){return!c.url||-1===c.url.search("yahooapis.com")&&-1===c.url.search("api.wunderground.com")?void 0:void hide_weather()}function update_yahoo_weather(){$.ajax({url:"https://query.yahooapis.com/v1/public/yql?q=select%20woeid%20from%20geo.placefinder%20where%20text=%22"+encodeURIComponent(controller.settings.loc)+"%22&format=json",dataType:isChromeApp?"json":"jsonp",contentType:"application/json; charset=utf-8",success:function(a){if(null===a.query.results)return void hide_weather();var b;b="string"==typeof a.query.results.Result.woeid?a.query.results.Result.woeid:a.query.results.Result[0].woeid,$.ajax({url:"https://query.yahooapis.com/v1/public/yql?q=select%20item%2Ctitle%2Clocation%20from%20weather.forecast%20where%20woeid%3D%22"+b+"%22&format=json",dataType:isChromeApp?"json":"jsonp",contentType:"application/json; charset=utf-8",success:function(a){if("City not found"===a.query.results.channel.item.title)return void hide_weather();var b=a.query.results.channel.item.condition,c=a.query.results.channel.title,d=/Yahoo! Weather - (.*)/.exec(c),e=a.query.results.channel.location.country;$("#weather").html("<div title='"+b.text+"' class='wicon cond"+b.code+"'></div><span>"+convert_temp(b.temp,e)+"</span><br><span class='location'>"+d[1]+"</span>").on("click",show_forecast),$("#weather-list").animate({"margin-left":"0"},1e3).show(),update_yahoo_forecast(a.query.results.channel.item.forecast,d[1],e,b),$.mobile.document.trigger("weatherUpdateComplete")}}).retry({times:retryCount,statusCodes:[0]}).fail(weather_update_failed)}}).retry({times:retryCount,statusCodes:[0]}).fail(weather_update_failed)}function update_yahoo_forecast(a,b,c,d){var e,f="<li data-role='list-divider' data-theme='a' class='center'>"+b+"</li>";for(f+="<li data-icon='false' class='center'><div title='"+d.text+"' class='wicon cond"+d.code+"'></div><span data-translate='Now'>"+_("Now")+"</span><br><span>"+convert_temp(d.temp,c)+"</span></li>",e=0;e<a.length;e++)f+="<li data-icon='false' class='center'><span>"+a[e].date+"</span><br><div title='"+a[e].text+"' class='wicon cond"+a[e].code+"'></div><span data-translate='"+a[e].day+"'>"+_(a[e].day)+"</span><br><span data-translate='Low'>"+_("Low")+"</span><span>: "+convert_temp(a[e].low,c)+"  </span><span data-translate='High'>"+_("High")+"</span><span>: "+convert_temp(a[e].high,c)+"</span></li>";var g=$("#forecast_list");g.html(f).enhanceWithin(),g.hasClass("ui-listview")&&g.listview("refresh")}function update_wunderground_weather(a){$.ajax({url:"https://api.wunderground.com/api/"+a+"/conditions/forecast/lang:EN/q/"+encodeURIComponent(controller.settings.loc)+".json",dataType:isChromeApp?"json":"jsonp",contentType:"application/json; charset=utf-8",success:function(a){var b,c;if("object"==typeof a.response.error&&"keynotfound"===a.response.error.type)return weatherKeyFail=!0,void update_yahoo_weather();weatherKeyFail=!1,b=-1!==a.current_observation.icon_url.indexOf("nt_")?"nt_"+a.current_observation.icon:a.current_observation.icon;var d={condition:{text:a.current_observation.weather,code:b,temp_c:a.current_observation.temp_c,temp_f:a.current_observation.temp_f,date:a.current_observation.observation_time,precip_today_in:a.current_observation.precip_today_in,precip_today_metric:a.current_observation.precip_today_metric,type:"wunderground"},location:a.current_observation.display_location.full,region:a.current_observation.display_location.country_iso3166,simpleforecast:{}};$.each(a.forecast.simpleforecast.forecastday,function(a,b){d.simpleforecast[a]=b}),c="US"===d.region||"BM"===d.region||"PW"===d.region?Math.round(d.condition.temp_f)+"&#176;F":d.condition.temp_c+"&#176;C",$("#weather").html("<div title='"+d.condition.text+"' class='wicon cond"+b+"'></div><span>"+c+"</span><br><span class='location'>"+d.location+"</span>").on("click",show_forecast),$("#weather-list").animate({"margin-left":"0"},1e3).show(),update_wunderground_forecast(d),$.mobile.document.trigger("weatherUpdateComplete")}}).retry({times:retryCount,statusCodes:[0]}).fail(weather_update_failed)}function update_wunderground_forecast(a){var b,c;"US"===a.region||"BM"===a.region||"PW"===a.region?(b=a.condition.temp_f+"&#176;F",c=a.condition.precip_today_in+" in"):(b=a.condition.temp_c+"&#176;C",c=a.condition.precip_today_metric+" mm");var d="<li data-role='list-divider' data-theme='a' class='center'>"+a.location+"</li>";d+="<li data-icon='false' class='center'><div title='"+a.condition.text+"' class='wicon cond"+a.condition.code+"'></div><span data-translate='Now'>"+_("Now")+"</span><br><span>"+b+"</span><br><span data-translate='Precip'>"+_("Precip")+"</span><span>: "+c+"</span></li>",$.each(a.simpleforecast,function(b,c){var e;"US"===a.region||"BM"===a.region||"PW"===a.region?(e=c.qpf_allday["in"],null===e&&(e=0),d+="<li data-icon='false' class='center'><span>"+c.date.monthname_short+" "+c.date.day+"</span><br><div title='"+c.conditions+"' class='wicon cond"+c.icon+"'></div><span data-translate='"+c.date.weekday_short+"'>"+_(c.date.weekday_short)+"</span><br><span data-translate='Low'>"+_("Low")+"</span><span>: "+c.low.fahrenheit+"&#176;F  </span><span data-translate='High'>"+_("High")+"</span><span>: "+c.high.fahrenheit+"&#176;F</span><br><span data-translate='Precip'>"+_("Precip")+"</span><span>: "+e+" in</span></li>"):(e=c.qpf_allday.mm,null===e&&(e=0),d+="<li data-icon='false' class='center'><span>"+c.date.monthname_short+" "+c.date.day+"</span><br><div title='"+c.conditions+"' class='wicon cond"+c.icon+"'></div><span data-translate='"+c.date.weekday_short+"'>"+_(c.date.weekday_short)+"</span><br><span data-translate='Low'>"+_("Low")+"</span><span>: "+c.low.celsius+"&#176;C  </span><span data-translate='High'>"+_("High")+"</span><span>: "+c.high.celsius+"&#176;C</span><br><span data-translate='Precip'>"+_("Precip")+"</span><span>: "+e+" mm</span></li>")
});var e=$("#forecast_list");e.html(d).enhanceWithin(),e.hasClass("ui-listview")&&e.listview("refresh")}function show_forecast(){var a=$("#forecast");return a.find("div[data-role='header'] > .ui-btn-right").on("click",function(){$.mobile.loading("show"),$.mobile.document.one("weatherUpdateComplete",function(){$.mobile.loading("hide")}),update_weather()}),a.one("pagehide",function(){a.find("div[data-role='header'] > .ui-btn-right").off("click")}),changePage("#forecast"),!1}function resolveLocation(a,b){return $("#location-list").popup("destroy").remove(),b=b||function(){},a&&""!==a?void $.ajax({url:"https://autocomplete.wunderground.com/aq?format=json&h=0&query="+encodeURIComponent(a),dataType:isChromeApp?"json":"jsonp",jsonp:"cb"}).retry({times:retryCount,statusCodes:[0]}).done(function(a){if(a=a.RESULTS,0===a.length)return void b(!1);if(1===a.length)return void b(a[0].name);for(var c="",d=0;d<a.length;d++)"city"===a[d].type&&a[d].tz&&(c+="<li><a>"+a[d].name+"</a></li>");if(""===c)return void b(!1);var e=$("<div data-role='popup' id='location-list' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+_("Select City")+"</h1></div><div class='ui-content'><ul data-role='listview'>"+c+"</ul></div></div>"),f=!1;e.appendTo("body").on("click","a",function(){b(this.textContent),f=!0,e.popup("close")}).one("popupafterclose",function(){e.popup("destroy").remove(),f===!1&&b(!1)}).popup({history:!1,positionTo:"window"}).enhanceWithin().popup("open")}):void b(!1)}function nearbyPWS(a,b,c){return $("#location-list").popup("destroy").remove(),$.mobile.loading("show"),c=c||function(){},a&&b?void $.ajax({url:"http://api.wunderground.com/api/"+controller.settings.wtkey+"/geolookup/q/"+(-999===a||-999===b?"autoip":encodeURIComponent(a)+","+encodeURIComponent(b))+".json",dataType:isChromeApp?"json":"jsonp"}).retry({times:retryCount,statusCodes:[0]}).done(function(d){var e;a=d.location.lat,b=d.location.lon;try{e=d.location.nearby_weather_stations.airport.station,d=d.location.nearby_weather_stations.pws.station}catch(f){return void c(!1)}if(0===d.length)return void c(!1);if(1===d.length)return void c(d[0].id);var g="";d=encodeURIComponent(JSON.stringify(d)),curr_local&&(g=$.mobile.path.parseUrl($("head").find("script").eq(0).attr("src")).hrefNoHash.slice(0,-10));var h=$("<div data-role='popup' id='location-list' data-theme='a' style='background-color:rgb(229, 227, 223);' data-overlay-theme='b'><a href='#' data-rel='back' class='ui-btn ui-corner-all ui-shadow ui-btn-b ui-icon-delete ui-btn-icon-notext ui-btn-right'>"+_("Close")+"</a><iframe style='border:none' src='"+g+"map.htm' width='100%' height='100%' seamless=''></iframe></div>"),i=h.find("iframe"),j=!1;$(window).off("message onmessage").on("message onmessage",function(a){var b=a.originalEvent.data;"undefined"!=typeof b.WS?(c(b.WS),j=!0,h.popup("destroy").remove()):"undefined"!=typeof b.loaded&&b.loaded===!0&&$.mobile.loading("hide")}),i.one("load",function(){this.contentWindow.postMessage({type:"currentLocation",payload:{lat:a,lon:b}},"*"),this.contentWindow.postMessage({type:"pwsData",payload:d},"*"),e.length>0&&(e=encodeURIComponent(JSON.stringify(e)),this.contentWindow.postMessage({type:"airportData",payload:e},"*"))}),h.appendTo("body").one("popupafterclose",function(){h.popup("destroy").remove(),j===!1&&c(!1)}).popup({history:!1,beforeposition:function(){h.css({width:window.innerWidth-36,height:window.innerHeight-28})},x:0,y:0}).enhanceWithin().popup("open")}).fail(function(){c(!1)}):void c(!1)}function debugWU(){return"string"!=typeof controller.settings.wtkey||""===controller.settings.wtkey?void showerror(_("An API key must be provided for Weather Underground")):($.mobile.loading("show"),void $.ajax({url:"http://api.wunderground.com/api/"+controller.settings.wtkey+"/yesterday/conditions/q/"+controller.settings.loc+".json",dataType:isChromeApp?"json":"jsonp"}).retry({times:retryCount,statusCodes:[0]}).done(function(a){if($.mobile.loading("hide"),"object"==typeof a.response.error)return void showerror(_("An invalid API key has been detected"));if("object"!=typeof a.history)return void showerror(_("Weather data cannot be found for your location"));var b=a.history.dailysummary[0],c=a.current_observation,d=c.display_location.country_iso3166,e="US"===d||"BM"===d||"PW"===d?!1:!0,f=$("<div data-role='popup' class='ui-content' data-overlay-theme='b' data-theme='a'><table class='debugWU'><tr><td>"+_("Min Humidity")+"</td><td>"+b.minhumidity+"%</td></tr><tr><td>"+_("Max Humidity")+"</td><td>"+b.maxhumidity+"%</td></tr><tr><td>"+_("Mean Temp")+"</td><td>"+(e?b.meantempm+"&#176;C":b.meantempi+"&#176;F")+"</td></tr><tr><td>"+_("Precip Yesterday")+"</td><td>"+(e?b.precipm+"mm":b.precipi+'"')+"</td></tr><tr><td>"+_("Precip Today")+"</td><td>"+(e?c.precip_today_metric+"mm":c.precip_today_in+'"')+"</td></tr><tr><td>"+_("Current % Watering")+"</td><td>"+controller.options.wl+"%</td></tr></table></div>");f.appendTo("body").one("popupafterclose",function(){f.popup("destroy").remove()}).popup({history:!1,positionTo:"window"}).enhanceWithin().popup("open")}).fail(function(){$.mobile.loading("hide"),showerror(_("Connection timed-out. Please try again."))}))}function testAPIKey(a,b){$.ajax({url:"https://api.wunderground.com/api/"+a+"/conditions/forecast/lang:EN/q/75252.json",dataType:isChromeApp?"json":"jsonp"}).retry({times:retryCount,statusCodes:[0]}).done(function(a){return"object"==typeof a.response.error&&"keynotfound"===a.response.error.type?void b(!1):void b(!0)}).fail(function(){b(!1)})}function open_panel(){var a=$("#sprinklers-settings"),b=function(){return _(1===controller.settings.en?"Disable":"Enable")};a.panel("option","classes.modal","needsclick ui-panel-dismiss"),a.find("a[href='#site-control']").off("click").one("click",function(){return changeFromPanel("#site-control"),!1}),a.find("a[href='#about']").off("click").one("click",function(){return changeFromPanel("#about"),!1}),a.find(".export_config").off("click").on("click",function(){return getExportMethod(),!1}),a.find(".import_config").off("click").on("click",function(){return storage.get("backup",function(a){getImportMethod(a.backup)}),!1}),a.find(".toggleOperation").on("click",function(){var a=$(this),c=1-controller.settings.en;return areYouSure(_("Are you sure you want to")+" "+b().toLowerCase()+" "+_("operation?"),"",function(){send_to_os("/cv?pw=&en="+c).done(function(){$.when(update_controller_settings(),update_controller_status()).done(function(){check_status(),a.find("span:first").html(b()).attr("data-translate",b())})})}),!1}).find("span:first").html(b()).attr("data-translate",b()),a.find(".reboot-os").off("click").on("click",function(){return areYouSure(_("Are you sure you want to reboot OpenSprinkler?"),"",function(){$.mobile.loading("show"),send_to_os("/cv?pw=&rbt=1").done(function(){$.mobile.loading("hide"),showerror(_("OpenSprinkler is rebooting now"))})}),!1}),a.find(".clear-config").off("click").on("click",function(){return areYouSure(_("Are you sure you want to delete all settings and return to the default settings?"),"",function(){storage.remove(["sites","current_site","lang","provider","wapikey","runonce"],function(){update_lang(),changePage("#start",{showStart:!0})})}),!1}),a.find(".show-providers").off("click").on("click",function(){$("#providers").popup("destroy").remove(),storage.get(["provider","wapikey"],function(a){a.provider=a.provider||"yahoo";var b=$("<div data-role='popup' id='providers' data-theme='a' data-overlay-theme='b'><div class='ui-content'><form><label for='weather_provider'>"+_("Weather Provider")+"<select data-mini='true' id='weather_provider' class='needsclick'><option value='yahoo'>"+_("Yahoo!")+"</option><option "+("wunderground"===a.provider?"selected ":"")+"value='wunderground'>"+_("Wunderground")+"</option></select></label><label for='wapikey'>"+_("Wunderground API Key")+"<input data-mini='true' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' id='wapikey' value='"+(a.wapikey?a.wapikey:"")+"'></label><input type='submit' value='"+_("Submit")+"'></form></div></div>");return"yahoo"===a.provider&&b.find("#wapikey").closest("label").hide(),b.find("form").on("submit",function(a){a.preventDefault();var b=$("#wapikey").val(),c=$("#weather_provider").val();return"wunderground"===c&&""===b?void showerror(_("An API key must be provided for Weather Underground")):(storage.set({wapikey:b,provider:c}),update_weather(),$("#providers").popup("close"),!1)}),b.on("change","#weather_provider",function(){var a=$(this).val();"wunderground"===a?$("#wapikey").closest("label").show():$("#wapikey").closest("label").hide(),b.popup("reposition",{positionTo:"window"})}),b.one("popupafterclose",function(){document.activeElement.blur(),this.remove()}).popup().enhanceWithin().popup("open"),!1})}),a.find(".change_password > a").off("click").on("click",function(){var a=isOSPi(),b=$("<div data-role='popup' id='changePassword' data-theme='a' data-overlay-theme='b'><ul data-role='listview' data-inset='true'><li data-role='list-divider'>"+_("Change Password")+"</li><li><form method='post' novalidate><label for='npw'>"+_("New Password")+":</label><input type='password' name='npw' id='npw' value=''"+(a?"":" maxlength='32'")+"><label for='cpw'>"+_("Confirm New Password")+":</label><input type='password' name='cpw' id='cpw' value=''"+(a?"":" maxlength='32'")+"><input type='submit' value='"+_("Submit")+"'></form></li></ul></div>");b.find("form").on("submit",function(){var c=b.find("#npw").val(),d=b.find("#cpw").val();return c!==d?(showerror(_("The passwords don't match. Please try again.")),!1):""===c?(showerror(_("Password cannot be empty")),!1):(!a&&c.length>32&&showerror(_("Password cannot be longer than 32 characters")),$.mobile.loading("show"),send_to_os("/sp?pw=&npw="+encodeURIComponent(c)+"&cpw="+encodeURIComponent(d),"json").done(function(a){var d=a.result;!d||d>1?showerror(2===d?_("Please check the current device password is correct then try again"):_("Unable to change password. Please try again.")):(storage.get(["sites","current_site"],function(a){var b=JSON.parse(a.sites);b[a.current_site].os_pw=c,curr_pw=c,storage.set({sites:JSON.stringify(b)})}),$.mobile.loading("hide"),b.popup("close"),showerror(_("Password changed successfully")))}),!1)}),b.one("popupafterclose",function(){document.activeElement.blur(),b.remove()}).popup().enhanceWithin().popup("open")}),a.find("#downgradeui").off("click").on("click",function(){return areYouSure(_("Are you sure you want to downgrade the UI?"),"",function(){var a="http://rayshobby.net/scripts/java/svc"+getOSVersion();send_to_os("/cu?jsp="+encodeURIComponent(a)+"&pw=").done(function(){storage.remove(["sites","current_site","lang","provider","wapikey","runonce"]),location.reload()})}),!1}),a.find("#logout").off("click").on("click",function(){return areYouSure(_("Are you sure you want to logout?"),"",function(){storage.remove(["sites","current_site","lang","provider","wapikey","runonce"],function(){location.reload()})}),!1}),a.one("panelclose",function(){a.find(".export_config,.import_config").off("click"),$("#en").off("change"),a.find(".reboot-os,.clear-config,.show-providers").off("click")}),a.panel("open")}function show_options(){var a,b,c,d,e="",f=$("<div data-role='page' id='os-options'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false' data-hide-during-focus=''><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Edit Options")+"</h3><button disabled='disabled' data-icon='check' class='submit ui-btn-right'>"+_("Submit")+"</button></div><div class='ui-content' role='main'><div data-role='collapsibleset' id='os-options-list'></div></div></div>");if(f.find(".submit").on("click",submit_options),f.find(".ui-toolbar-back-btn").on("click",checkChangesBeforeBack),e="<fieldset data-role='collapsible' data-collapsed='false'><legend>"+_("System")+"</legend>","undefined"!=typeof controller.options.ntp&&(e+="<div class='ui-field-contain datetime-input'><label for='datetime'>"+_("Device Time")+"</label><button "+(controller.options.ntp?"disabled ":"")+"data-mini='true' id='datetime' value='"+(controller.settings.devt+60*new Date(1e3*controller.settings.devt).getTimezoneOffset())+"'>"+dateToString(new Date(1e3*controller.settings.devt)).slice(0,-3)+"</button></div>"),!isOSPi()&&"undefined"!=typeof controller.options.tz){for(a=["-12:00","-11:30","-11:00","-10:00","-09:30","-09:00","-08:30","-08:00","-07:00","-06:00","-05:00","-04:30","-04:00","-03:30","-03:00","-02:30","-02:00","+00:00","+01:00","+02:00","+03:00","+03:30","+04:00","+04:30","+05:00","+05:30","+05:45","+06:00","+06:30","+07:00","+08:00","+08:45","+09:00","+09:30","+10:00","+10:30","+11:00","+11:30","+12:00","+12:45","+13:00","+13:45","+14:00"],c=controller.options.tz-48,c=(c>=0?"+":"-")+pad(Math.abs(c)/4>>0)+":"+(Math.abs(c)%4*15/10>>0)+Math.abs(c)%4*15%10,e+="<div class='ui-field-contain'><label for='o1' class='select'>"+_("Timezone")+"</label><select "+(checkOSVersion(210)?"disabled='disabled' ":"")+"data-mini='true' id='o1'>",d=0;d<a.length;d++)e+="<option "+(a[d]===c?"selected":"")+" value='"+a[d]+"'>"+a[d]+"</option>";e+="</select></div>"}if(e+="<div class='ui-field-contain'><label for='loc'>"+_("Location")+"<button data-helptext='"+_("Location can be a zip code, city/state or a weatherunderground personal weather station using the format: pws:ID.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><table><tr style='width:100%;vertical-align: top;'><td style='width:100%'><input data-wrapper-class='"+($("#weather-list").is(":visible")?"green ":"")+"controlgroup-textinput ui-btn' data-mini='true' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' id='loc' value='"+controller.settings.loc+"'></td><td "+(checkOSVersion(210)&&""!==controller.settings.wtkey&&weatherKeyFail===!1?"":"class='hidden' ")+"id='nearbyPWS'><button class='noselect' data-icon='location' data-iconpos='notext' data-mini='true'></button></td><td "+(checkOSVersion(210)&&""!==controller.settings.wtkey&&weatherKeyFail===!1?"class='hidden' ":"")+"id='lookup-loc'><button class='noselect' data-corners='false' data-mini='true'>"+_("Lookup")+"</button></td></tr></table></div>","undefined"!=typeof controller.options.lg&&(e+="<label for='o36'><input data-mini='true' id='o36' type='checkbox' "+(1===controller.options.lg?"checked='checked'":"")+">"+_("Enable Logging")+"</label>"),e+="</fieldset><fieldset data-role='collapsible'><legend>"+_("Configure Master")+"</legend>","undefined"!=typeof controller.options.mas){for(e+="<div class='ui-field-contain'><label for='o18' class='select'>"+_("Master Station")+"</label><select data-mini='true' id='o18'><option value='0'>"+_("None")+"</option>",d=0;d<controller.stations.snames.length&&(e+="<option "+(d+1===controller.options.mas?"selected":"")+" value='"+(d+1)+"'>"+controller.stations.snames[d]+"</option>",7!==d);d++);e+="</select></div>"}if("undefined"!=typeof controller.options.mton&&(e+="<div class='ui-field-contain duration-field'><label for='o19'>"+_("Master On Delay")+"</label><button data-mini='true' id='o19' value='"+controller.options.mton+"'>"+controller.options.mton+"s</button></div>"),"undefined"!=typeof controller.options.mtof&&(e+="<div class='ui-field-contain duration-field'><label for='o20'>"+_("Master Off Delay")+"</label><button data-mini='true' id='o20' value='"+controller.options.mtof+"'>"+controller.options.mtof+"s</button></div>"),e+="</fieldset><fieldset data-role='collapsible'><legend>"+_("Station Handling")+"</legend>","undefined"!=typeof controller.options.ext&&(e+="<div class='ui-field-contain duration-field'><label for='o15'>"+_("Expansion Boards")+(controller.options.dexp&&controller.options.dexp<255?" ("+controller.options.dexp+" "+_("detected")+")":"")+"</label><button data-mini='true' id='o15' value='"+controller.options.ext+"'>"+controller.options.ext+" "+_("board(s)")+"</button></div>"),"undefined"!=typeof controller.options.sdt&&(e+="<div class='ui-field-contain duration-field'><label for='o17'>"+_("Station Delay")+"</label><button data-mini='true' id='o17' value='"+controller.options.sdt+"'>"+dhms2str(sec2dhms(controller.options.sdt))+"</button></div>"),"undefined"!=typeof controller.options.seq&&(e+="<label for='o16'><input data-mini='true' id='o16' type='checkbox' "+(1===controller.options.seq?"checked='checked'":"")+">"+_("Sequential")+"</label>"),e+="</fieldset><fieldset data-role='collapsible'><legend>"+_("Weather Control")+"</legend>","undefined"!=typeof controller.settings.wtkey&&(e+="<div class='ui-field-contain'><label for='wtkey'>"+_("Wunderground Key").replace("Wunderground","Wunder&shy;ground")+"<button data-helptext='"+_("Weather Underground requires an API Key which can be obtained from ")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><table><tr style='width:100%;vertical-align: top;'><td style='width:100%'><div class='"+(weatherKeyFail===!0?"red ":controller.settings.wtkey&&""!==controller.settings.wtkey?"green ":"")+"ui-input-text controlgroup-textinput ui-btn ui-body-inherit ui-corner-all ui-mini ui-shadow-inset ui-input-has-clear'><input data-role='none' data-mini='true' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' id='wtkey' value='"+controller.settings.wtkey+"'><a href='#' tabindex='-1' aria-hidden='true' data-helptext='"+_("An invalid API key has been detected.")+"' class='"+(weatherKeyFail===!0?"":"hidden ")+"help-icon ui-input-clear ui-btn ui-icon-alert ui-btn-icon-notext ui-corner-all'></a></div></td><td><button class='noselect' data-mini='true' id='verify-api'>"+_("Verify")+"</button></td></tr></table></div>"),"undefined"!=typeof controller.options.uwt){for(b=[_("Manual"),"Zimmerman"],e+="<div class='ui-field-contain'><label for='o31' class='select'>"+_("Weather Adjustment Method")+"<button data-helptext='"+_("Weather adjustment uses Weather Underground data in conjunction with the selected method to adjust the watering percentage.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><select "+(controller.settings.wtkey&&""!==controller.settings.wtkey?"":"disabled='disabled' ")+"data-mini='true' id='o31'>",d=0;d<b.length;d++)e+="<option "+(d===controller.options.uwt?"selected":"")+" value='"+d+"'>"+b[d]+"</option>";e+="</select></div>"}if("undefined"!=typeof controller.options.wl&&(e+="<div class='ui-field-contain duration-field'><label for='o23'>"+_("% Watering")+"<button data-helptext='"+_("The watering percentage scales station run times by the set value. When weather adjustment is used the watering percentage is automatically adjusted.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button "+(controller.options.uwt&&controller.options.uwt>0?"disabled='disabled' ":"")+"data-mini='true' id='o23' value='"+controller.options.wl+"'>"+controller.options.wl+"%</button></div>"),"undefined"!=typeof controller.options.urs&&(e+="<label for='o21'><input data-mini='true' id='o21' type='checkbox' "+(1===controller.options.urs?"checked='checked'":"")+">"+_("Use Rain Sensor")+"</label>"),"undefined"!=typeof controller.options.rso&&(e+="<label for='o22'><input "+(1===controller.options.urs?"":"data-wrapper-class='hidden' ")+"data-mini='true' id='o22' type='checkbox' "+(1===controller.options.rso?"checked='checked'":"")+">"+_("Normally Open (Rain Sensor)")+"</label>"),e+="</fieldset><fieldset data-role='collapsible' data-theme='b'><legend>"+_("Advanced")+"</legend>","undefined"!=typeof controller.options.hp0&&(e+="<div class='ui-field-contain'><label for='o12'>"+_("HTTP Port (restart required)")+"</label><input data-mini='true' type='number' pattern='[0-9]*' id='o12' value='"+(256*controller.options.hp1+controller.options.hp0)+"'></div>"),"undefined"!=typeof controller.options.devid&&(e+="<div class='ui-field-contain'><label for='o26'>"+_("Device ID (restart required)")+"<button data-helptext='"+_("Device ID modifies the last byte of the MAC address.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><input data-mini='true' type='number' pattern='[0-9]*' max='255' id='o26' value='"+controller.options.devid+"'></div>"),"undefined"!=typeof controller.options.rlp&&(e+="<div class='ui-field-contain duration-field'><label for='o30'>"+_("Relay Pulse")+"<button data-helptext='"+_("Relay pulsing is used for special situations where rapid pulsing is needed in the output with a range from 1 to 2000 milliseconds. A zero value disables the pulsing option.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='o30' value='"+controller.options.rlp+"'>"+controller.options.rlp+"ms</button></div>"),"undefined"!=typeof controller.options.ntp&&checkOSVersion(210)){var g=[controller.options.ntp1,controller.options.ntp2,controller.options.ntp3,controller.options.ntp4].join(".");e+="<div class='"+(1===controller.options.ntp?"":"hidden ")+"ui-field-contain duration-field'><label for='ntp_addr'>"+_("NTP IP Address")+"</label><button data-mini='true' id='ntp_addr' value='"+g+"'>"+g+"</button></div>"}if("undefined"!=typeof controller.options.dhcp&&checkOSVersion(210)){var h=[controller.options.ip1,controller.options.ip2,controller.options.ip3,controller.options.ip4].join("."),i=[controller.options.gw1,controller.options.gw2,controller.options.gw3,controller.options.gw4].join(".");e+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='ip_addr'>"+_("IP Address")+"</label><button data-mini='true' id='ip_addr' value='"+h+"'>"+h+"</button></div>",e+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='gateway'>"+_("Gateway Address")+"</label><button data-mini='true' id='gateway' value='"+i+"'>"+i+"</button></div>",e+="<label for='o3'><input data-mini='true' id='o3' type='checkbox' "+(1===controller.options.dhcp?"checked='checked'":"")+">"+_("Use DHCP (restart required)")+"</label>"}"undefined"!=typeof controller.options.ntp&&(e+="<label for='o2'><input data-mini='true' id='o2' type='checkbox' "+(1===controller.options.ntp?"checked='checked'":"")+">"+_("NTP Sync")+"</label>"),"undefined"!=typeof controller.options.ar&&(e+="<label for='o14'><input data-mini='true' id='o14' type='checkbox' "+(1===controller.options.ar?"checked='checked'":"")+">"+_("Auto Reconnect")+"</label>"),"undefined"!=typeof controller.options.ipas&&(e+="<label for='o25'><input data-mini='true' id='o25' type='checkbox' "+(1===controller.options.ipas?"checked='checked'":"")+">"+_("Ignore Password")+"</label>"),e+="</fieldset>",f.find("#os-options-list").html(e).one("change input",function(){f.find(".submit").prop("disabled",!1).addClass("hasChanges")}).find("fieldset").each(function(a,b){var c=$(b);1===c.children().length&&c.remove()}),f.find("#loc").on("change input",function(){var a=$(this);""===a.val()&&(a.parent().removeClass("green"),$("#o1").selectmenu("enable"))}),f.find("#o3").on("change",function(){var a=$(this),b=a.is(":checked"),c=f.find("#ip_addr,#gateway").parents(".ui-field-contain");b?c.addClass("hidden"):c.removeClass("hidden")}),f.find("#o21").on("change",function(){var a=$(this),b=a.is(":checked");b?f.find("#o22").parent().removeClass("hidden"):f.find("#o22").parent().addClass("hidden")}),f.find("#nearbyPWS > button").on("click",function(){var a,b=$("#loc"),c=$(this),d=function(b){return clearTimeout(a),$.mobile.loading("hide"),b!==!0?void nearbyPWS(-999,-999,e):void c.prop("disabled",!1)};""===controller.settings.wtkey&&(showerror(_("An API key must be provided for Weather Underground")),d()),$.mobile.loading("show"),c.prop("disabled",!0);var e=function(a){a===!1?""===f.find("#loc").val()&&f.find("#o1").selectmenu("enable"):(checkOSVersion(210)&&f.find("#o1").selectmenu("disable"),b.parent().addClass("green"),b.val(a),f.find(".submit").prop("disabled",!1).addClass("hasChanges")),d(!0)};try{a=setTimeout(function(){$.mobile.loading("show",{html:"<div class='logo'></div><h1 style='padding-top:5px'>"+_("Attempting to retrieve your current location")+"</h1></p>",textVisible:!0,theme:"b"})},100),navigator.geolocation.getCurrentPosition(function(b){clearTimeout(a),nearbyPWS(b.coords.latitude,b.coords.longitude,e)},d)}catch(g){d()}}),f.find("#lookup-loc > button").on("click",function(){var a=$("#loc"),b=a.val(),c=$(this);return/^pws:|^icao:/.test(b)?void showerror(_("When using a personal weather station the location lookup is unavailable.")):(c.prop("disabled",!0),void resolveLocation(b,function(d){d===!1?(""===f.find("#loc").val()&&f.find("#o1").selectmenu("enable"),showerror(_("Unable to locate using:")+" "+b+". "+_("Please use another value and try again."))):(checkOSVersion(210)&&f.find("#o1").selectmenu("disable"),d=d.replace(/^[0-9]{5}\s-\s/,""),a.parent().addClass("green"),a.val(d),f.find(".submit").prop("disabled",!1).addClass("hasChanges")),c.prop("disabled",!1)}))}),f.find("#verify-api").on("click",function(){var a=f.find("#wtkey"),b=$(this);b.prop("disabled",!0),testAPIKey(a.val(),function(c){c===!0?(a.parent().find(".ui-icon-alert").hide(),a.parent().removeClass("red").addClass("green"),checkOSVersion(210)&&(f.find("#lookup-loc").addClass("hidden"),f.find("#nearbyPWS").removeClass("hidden"))):(a.parent().find(".ui-icon-alert").removeClass("hidden").show(),a.parent().removeClass("green").addClass("red"),checkOSVersion(210)&&(f.find("#lookup-loc").removeClass("hidden"),f.find("#nearbyPWS").addClass("hidden"))),b.prop("disabled",!1)})}),f.find(".help-icon").on("click",function(a){a.stopImmediatePropagation();var b,c=$(this),d=c.data("helptext");return"wtkey"===c.parent().attr("for")&&(d+="<a class='iab' target='_blank' href='https://opensprinkler.freshdesk.com/support/solutions/articles/5000017485-getting-a-weather-api#article-show-5000017485'>here</a>."),b=$("<div data-role='popup'><p>"+d+"</p></div>"),b.one("popupafterclose",function(){b.popup("destroy").remove()}).enhanceWithin(),$(".ui-page-active").append(b),b.popup({history:!1,positionTo:c}).popup("open"),!1}),f.find(".duration-field button:not(.help-icon)").on("click",function(){var a=$(this),b=a.attr("id"),c=f.find("label[for='"+b+"']").text(),d=a.parent().find(".help-icon").data("helptext"),e=240;if(f.find(".submit").prop("disabled",!1).addClass("hasChanges"),"ip_addr"===b||"gateway"===b||"ntp_addr"===b)showIPRequest({title:c,ip:a.val().split("."),callback:function(b){a.val(b.join(".")).text(b.join("."))}});else if("o19"===b)showSingleDurationInput({data:a.val(),title:c,callback:function(b){a.val(b).text(b+"s")},label:_("Seconds"),maximum:60,helptext:d});else if("o30"===b)showSingleDurationInput({data:a.val(),title:c,callback:function(b){a.val(b).text(b+"ms")},label:_("Milliseconds"),maximum:2e3,helptext:d});else if("o20"===b)showSingleDurationInput({data:a.val(),title:c,callback:function(b){a.val(b).text(b+"s")},label:_("Seconds"),maximum:60,minimum:-60,helptext:d});else if("o15"===b)showSingleDurationInput({data:a.val(),title:c,callback:function(b){a.val(b).text(b+" board(s)")},label:_("Expansion Boards"),maximum:5,helptext:d});else if("o23"===b)showSingleDurationInput({data:a.val(),title:c,callback:function(b){a.val(b).text(b+"%")},label:_("% Watering"),maximum:250,helptext:d});else if("o17"===b){var g=0;checkOSVersion(210)&&(e=64800),checkOSVersion(211)&&(g=-3540,e=3540),showDurationBox({seconds:a.val(),title:c,callback:function(b){a.val(b),a.text(dhms2str(sec2dhms(b)))},maximum:e,minimum:g})}return!1}),f.find("#o2").on("change",function(){var a=$(this).is(":checked");f.find(".datetime-input button").prop("disabled",a),f.find("#ntp_addr").parents(".ui-field-contain").toggleClass("hidden",!a)}),f.find("#o31").on("change",function(){$("#o23").prop("disabled",0===parseInt(this.value)||""===f.find("#wtkey").val()?!1:!0)}),f.find("#wtkey").on("change input",function(){f.find("#wtkey").siblings(".help-icon").hide(),f.find("#wtkey").parent().removeClass("red green"),""===this.value?($("#o31").val("0").selectmenu("refresh").selectmenu("disable"),$("#o23").prop("disabled",!1)):$("#o31").selectmenu("enable")}),f.find(".datetime-input").on("click",function(){var a=$(this).find("button");if(!a.prop("disabled"))return f.find(".submit").prop("disabled",!1).addClass("hasChanges"),showDateTimeInput(a.val(),function(b){a.text(dateToString(b).slice(0,-3)).val(Math.round(b.getTime()/1e3))}),!1}),f.one("pagehide",function(){f.remove()}),$("#os-options").remove(),f.appendTo("body")}function submit_options(){var a,b={},c=!1,d=isOSPi(),e=$("#os-options").find(".submit"),f={1:"tz",2:"ntp",12:"htp",13:"htp2",14:"ar",15:"nbrd",16:"seq",17:"sdt",18:"mas",19:"mton",20:"mtoff",21:"urs",22:"rst",23:"wl",25:"ipas",30:"rlp",36:"lg",31:"uwt"};return e.prop("disabled",!0).removeClass("hasChanges"),$("#os-options-list").find(":input,button").filter(":not(.noselect)").each(function(e,g){var h,i=$(g),j=i.attr("id"),k=i.val();if(!j||!k&&""!==k)return!0;switch(j){case"o1":var l=k.split(":");l[0]=parseInt(l[0],10),l[1]=parseInt(l[1],10),l[1]=(l[1]/15>>0)/4,l[0]=l[0]+(l[0]>=0?l[1]:-l[1]),k=4*(l[0]+12)>>0;break;case"datetime":var m=new Date(1e3*k);return m.setMinutes(m.getMinutes()-m.getTimezoneOffset()),b.tyy=m.getFullYear(),b.tmm=m.getMonth(),b.tdd=m.getDate(),b.thh=m.getHours(),b.tmi=m.getMinutes(),b.ttt=Math.round(m.getTime()/1e3),!0;case"ip_addr":return"0.0.0.0"===h?(showerror(_("A valid IP address is required when DHCP is not used")),c=!0,!1):(h=k.split("."),b.o4=h[0],b.o5=h[1],b.o6=h[2],b.o7=h[3],!0);case"gateway":return"0.0.0.0"===h?(showerror(_("A valid gateway address is required when DHCP is not used")),c=!0,!1):(h=k.split("."),b.o8=h[0],b.o9=h[1],b.o10=h[2],b.o11=h[3],!0);case"ntp_addr":return h=k.split("."),b.o32=h[0],b.o33=h[1],b.o34=h[2],b.o35=h[3],!0;case"o12":return d||(b.o12=255&k,b.o13=k>>8&255),!0;case"o31":if(k>0&&""===$("#wtkey").val())return showerror(_("Weather Underground API key is required for weather-based control")),c=!0,!1;break;case"o2":case"o14":case"o16":case"o21":case"o22":case"o25":case"o30":case"o36":case"o3":if(k=i.is(":checked")?1:0,!k)return!0}d&&("loc"===j||"lg"===j?j="o"+j:(a=/\d+/.exec(j),j="o"+f[a])),checkOSVersion(208)===!0&&"loc"===j&&(k=k.replace(/\s/g,"_")),b[j]=k}),c?void e.prop("disabled",!1).addClass("hasChanges"):($.mobile.loading("show"),void send_to_os("/co?pw=&"+$.param(b)).done(function(){$.mobile.document.one("pageshow",function(){showerror(_("Settings have been saved"))}),goBack(),update_controller(update_weather)}).fail(function(){e.prop("disabled",!1).addClass("hasChanges")}))}function show_stations(){var a,b,c="",d=$("<div data-role='page' id='os-stations'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false' data-hide-during-focus=''><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Edit Stations")+"</h3><button data-icon='check' disabled='disabled' class='submit ui-btn-right'>"+_("Submit")+"</button></div><div class='ui-content' role='main'></div></div>"),e=[],f="<span style='padding-left:10px' class='btn-no-border ui-btn ui-icon-edit ui-btn-icon-notext'></span>",g=function(a){var b=controller.stations.snames[a],d=controller.status[a]>0||controller.settings.ps[a][0]>0;c+="<div class='ui-corner-all card'>",c+="<div class='ui-body ui-body-a center'>",c+="<p class='tight center inline-icon station-name' id='station_"+a+"'>"+b+f+"</p>",q>0&&controller.options.mas!==a+1&&(c+="<button data-mini='true' data-icon='gear' data-iconpos='notext' data-inline='true' data-station='"+a+"' id='attrib-"+a+"' class='attrib' "+(l?"data-um='"+(controller.stations.masop[parseInt(a/8)]&1<<a%8?1:0)+"' ":"")+(m?"data-ir='"+(controller.stations.ignore_rain[parseInt(a/8)]&1<<a%8?1:0)+"' ":"")+(n?"data-ar='"+(controller.stations.act_relay[parseInt(a/8)]&1<<a%8?1:0)+"' ":"")+(o?"data-sd='"+(controller.stations.stn_dis[parseInt(a/8)]&1<<a%8?1:0)+"' ":"")+(p?"data-us='"+(controller.stations.stn_seq[parseInt(a/8)]&1<<a%8?1:0)+"' ":"")+"></button>",c+=(l?"<span data-shortcode='um' class='stn-attrib-icon btn-no-border ui-btn ui-icon-master ui-btn-icon-notext"+(controller.stations.masop[parseInt(a/8)]&1<<a%8?"":" attrib-disabled")+"'></span>":"")+(m?"<span data-shortcode='ir' class='stn-attrib-icon btn-no-border ui-btn ui-icon-norain ui-btn-icon-notext"+(controller.stations.ignore_rain[parseInt(a/8)]&1<<a%8?"":" attrib-disabled")+"'></span>":"")+(n?"<span data-shortcode='ar' class='stn-attrib-icon btn-no-border ui-btn ui-icon-relay ui-btn-icon-notext"+(controller.stations.act_relay[parseInt(a/8)]&1<<a%8?"":" attrib-disabled")+"'></span>":"")+(o?"<span data-shortcode='sd' class='stn-attrib-icon btn-no-border ui-btn ui-icon-forbidden ui-btn-icon-notext"+(controller.stations.stn_dis[parseInt(a/8)]&1<<a%8?"":" attrib-disabled")+"'></span>":"")+(p?"<span data-shortcode='us' class='stn-attrib-icon btn-no-border ui-btn ui-icon-serial ui-btn-icon-notext"+(controller.stations.stn_seq[parseInt(a/8)]&1<<a%8?"":" attrib-disabled")+"'></span>":"")),r&&controller.options.mas!==a+1&&(c+="<fieldset data-role='controlgroup' data-type='horizontal' data-mini='true' class='center'>",c+="<legend>"+_("Test Station")+"</legend>",c+="<select><option value='60'>1 min</option><option value='300'>5 mins</option><option value='600'>10 mins</option><option value='900'>15 mins</option><option value='1200'>20 mins</option></select>",c+="<button class='"+(d?"red":"green")+"' id='run_station-"+a+"'>"+_(d?"Stop":"Start")+"</button>",c+="</fieldset>",e[a]=controller.settings.ps[a][1]),controller.options.mas===a+1&&(c+="<p class='tight center'>"+_("Master")+" "+_("Station")+"</p>"),c+="</div></div>"
},h=function(){$("#stn_attrib").popup("destroy").remove();var a=$(this),b=a.data("station"),c=d.find("#station_"+b),e="<div data-overlay-theme='b' data-role='popup' id='stn_attrib'><fieldset style='margin:0' data-corners='false' data-role='controlgroup'>";e+="<input class='bold center' data-wrapper-class='stn-name ui-btn' id='stn-name' type='text' value='"+c.text()+"'>",l&&(e+="<label for='um'><input class='needsclick' data-iconpos='right' id='um' type='checkbox' "+(1===a.data("um")?"checked='checked'":"")+">"+_("Use Master")+"</label>"),m&&(e+="<label for='ir'><input class='needsclick' data-iconpos='right' id='ir' type='checkbox' "+(1===a.data("ir")?"checked='checked'":"")+">"+_("Ignore Rain")+"</label>"),n&&(e+="<label for='ar'><input class='needsclick' data-iconpos='right' id='ar' type='checkbox' "+(1===a.data("ar")?"checked='checked'":"")+">"+_("Activate Relay")+"</label>"),o&&(e+="<label for='sd'><input class='needsclick' data-iconpos='right' id='sd' type='checkbox' "+(1===a.data("sd")?"checked='checked'":"")+">"+_("Disable")+"</label>"),p&&(e+="<label for='us'><input class='needsclick' data-iconpos='right' id='us' type='checkbox' "+(1===a.data("us")?"checked='checked'":"")+">"+_("Sequential")+"</label>"),e+="</fieldset></div>",e=$(e),e.one("popupafterclose",function(){a.data("um",e.find("#um").is(":checked")?1:0),a.data("ir",e.find("#ir").is(":checked")?1:0),a.data("ar",e.find("#ar").is(":checked")?1:0),a.data("sd",e.find("#sd").is(":checked")?1:0),a.data("us",e.find("#us").is(":checked")?1:0),c.html(e.find("#stn-name").val()+f),d.find(".submit").prop("disabled",!1),e.popup("destroy").remove()}).enhanceWithin(),$(".ui-page-active").append(e),e.popup({history:!1,positionTo:a.parent()}).popup("open")},i=function(){d.find(".submit").prop("disabled",!0);var a,b,c,e,f=checkOSVersion(208)===!0,g={},h={},i={},j={},k={},q={};for(b=0;b<controller.settings.nbrd;b++)for(l&&(g["m"+b]=0),p&&(h["q"+b]=0),m&&(i["i"+b]=0),n&&(j["a"+b]=0),o&&(k["d"+b]=0),e=0;8>e;e++)c=8*b+e,a=d.find("#attrib-"+c),l&&(g["m"+b]=g["m"+b]+(a.data("um")<<e)),p&&(h["q"+b]=h["q"+b]+(a.data("us")<<e)),m&&(i["i"+b]=i["i"+b]+(a.data("ir")<<e)),n&&(j["a"+b]=j["a"+b]+(a.data("ar")<<e)),o&&(k["d"+b]=k["d"+b]+(a.data("sd")<<e)),q["s"+c]=f?d.find("#station_"+c).text().replace(/\s/g,"_"):d.find("#station_"+c).text();$.mobile.loading("show"),send_to_os("/cs?pw=&"+$.param(q)+(l?"&"+$.param(g):"")+(p?"&"+$.param(h):"")+(m?"&"+$.param(i):"")+(n?"&"+$.param(j):"")+(o?"&"+$.param(k):"")).done(function(){$.mobile.document.one("pageshow",function(){showerror(_("Stations have been updated"))}),goBack(),update_controller()}).fail(function(){d.find(".submit").prop("disabled",!1)})},j=function(){var a=$(this),b=a.attr("id").split("-")[1],c=parseInt(a.prev().find("select").val()),d=function(){$.mobile.loading("show"),send_to_os("/cm?sid="+b+"&en=1&t="+c+"&pw=","json").done(function(){showerror(_("Station test activated")),controller.settings.ps[b][0]=99,controller.settings.ps[b][1]=c,e[b]=c,a.removeClass("green").addClass("red").text(_("Stop")).on("click",f),setTimeout(g,1e3*c)})},f=function(){return $.mobile.loading("show"),send_to_os("/cm?sid="+b+"&en=0&pw=","json").done(g),$.mobile.loading("hide"),controller.settings.ps[b][0]=0,controller.settings.ps[b][1]=0,controller.status[b]=0,e[b]=0,!1},g=function(){a.removeClass("red").addClass("green").text(_("Start")).off("click")};a.hasClass("green")?d():f()},k=function(){d.find("[id^='run_station-']").each(function(){var a=$(this),b=a.siblings(".ui-select"),c=parseInt(a.attr("id").split("-")[1]),d=function(){b.find(".ui-btn").addClass("ui-icon-carat-d ui-btn-icon-right"),b.find("select").prop("disabled",!1),b.find("span").text(b.find("select option:selected").text()),a.removeClass("red").addClass("green").text(_("Start")).off("click")};if(controller.status[c]>0||controller.settings.ps[c][0]>0){if(controller.status[c]>0&&e[c]--,e[c]<=0)return d(),!0;b.find(".ui-btn").removeClass("ui-icon-carat-d ui-btn-icon-right"),b.find("select").prop("disabled",!0),b.find("span").text(dhms2str(sec2dhms(e[c]))),a.removeClass("green").addClass("red").text(_("Stop")).off("click")}else d()})},l=controller.options.mas?!0:!1,m="object"==typeof controller.stations.ignore_rain?!0:!1,n="object"==typeof controller.stations.act_relay?!0:!1,o="object"==typeof controller.stations.stn_dis?!0:!1,p="object"==typeof controller.stations.stn_seq?!0:!1,q=m+l+n+o+p,r=checkOSVersion(210),s=(new Date).getTime();for(b=0;8>b;b++)g(b);d.find(".ui-content").html("<div id='os-stations-list' class='card-group center'>"+c+"</div><button class='submit'>"+_("Submit")+"</button><button data-theme='b' class='reset'>"+_("Reset")+"</button>"),d.find(".ui-toolbar-back-btn").on("click",checkChangesBeforeBack),d.find("#os-stations-list").one("change input",function(){d.find(".submit").prop("disabled",!1).addClass("hasChanges")}),d.on("datarefresh",function(){for(var a=controller.settings.ps.length-1;a>=0;a--)e[a]=controller.settings.ps[a][1];k()}),d.on("click","[id^='run_station-']",j),d.on("click",".attrib",h),d.on("click",".stn-attrib-icon",function(){var a=$(this),b=a.hasClass("attrib-disabled")?1:0,c=a.data("shortcode"),e=a.siblings(".attrib");e.data(c,b),b?a.removeClass("attrib-disabled"):a.addClass("attrib-disabled"),d.find(".submit").prop("disabled",!1).addClass("hasChanges")}),d.on("click","[id^='station_']",function(){var a=$(this),b=$("<input class='center station-input' data-mini='true' maxlength='"+controller.stations.maxlen+"' id='edit_"+a.attr("id")+"' type='text' value='"+a.text()+"'>");if(a.replaceWith(b),b.on("blur keyup",function(c){("keyup"!==c.type||13===c.keyCode)&&(a.html(b.val()+f),b.replaceWith(a),b.remove())}),b.get(0).setSelectionRange)b.focus(),b.get(0).setSelectionRange(0,a.text().length);else if(b.get(0).createTextRange){var c=b.get(0).createTextRange();c.collapse(!0),c.moveEnd("character",a.text().length),c.moveStart("character",0),c.select()}}),d.find(".submit").on("click",i),d.find(".reset").on("click",function(){d.find("[id^='station_']").each(function(a,b){$(b).html("S"+pad(a+1)+f)}),d.find(".attrib").each(function(a,b){$(b).data({um:0,us:0,ir:0,ar:0,sd:0})})}),d.one({pagehide:function(){d.remove()},pageshow:function(){for(c="",b;b<controller.stations.snames.length;b++)g(b);d.find("#os-stations-list").append(c).enhanceWithin()},pagebeforeshow:function(){k(),a=setInterval(function(){var b=(new Date).getTime(),c=$(".ui-page-active").attr("id"),d=b-s;d>3e3&&("os-stations"===c?refresh_status():clearInterval(a)),s=b,k()},1e3)}}),$("#os-stations").remove(),d.appendTo("body")}function isStationDisabled(a){return"object"==typeof controller.stations.stn_dis&&(controller.stations.stn_dis[parseInt(a/8)]&1<<a%8)>0}function isStationSequential(a){return"object"==typeof controller.stations.stn_seq&&(controller.stations.stn_seq[parseInt(a/8)]&1<<a%8)>0}function get_status(){var a,b=$("<div data-role='page' id='status'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false'><a role='button' href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Current Status")+"</h3></div><div class='ui-content' role='main'></div></div>"),c={},d=(new Date).getTime(),e=0,f=function(){var a=[],d="",f="",g="",h="<span id='clock-s' class='nobr'>"+dateToString(new Date(1e3*controller.settings.devt))+"</span>";"string"==typeof controller.settings.ct&&"0.0"!==controller.settings.ct&&"string"==typeof controller.settings.tu&&(h+=" <span>"+controller.settings.ct+"&deg;"+controller.settings.tu+"</span>"),c.c=controller.settings.devt;var i=controller.options.mas,j=0,k={},l=0,m=0;$.each(controller.status,function(a,b){b>0&&(k[a]=b)}),k=Object.keys(k).length,i&&controller.status[i-1]&&k--,$.each(controller.stations.snames,function(b,e){var f="";if(i===b+1)e+=" ("+_("Master")+")";else if(controller.settings.ps[b][0]){var h=controller.settings.ps[b][1];"object"==typeof controller.stations.stn_seq?isStationSequential(b)?(l++,m+=h):h>j&&(j=h):(l++,k>1?h>j&&(j=h):(99!==controller.settings.ps[b][0]||1!==h)&&(j+=h));var n=controller.settings.ps[b][0],o=pidname(n);controller.status[b]&&h>0&&(c[b]=h),a[b]=o,f="<p class='rem center'>"+(controller.status[b]>0?_("Running")+" "+o:_("Scheduled")+" "+(controller.settings.ps[b][2]?_("for")+" "+dateToString(new Date(1e3*controller.settings.ps[b][2])):o)),h>0&&(f+=" <span id='countdown-"+b+"' class='nobr'>("+sec2hms(h)+" "+_("remaining")+")</span>"),f+="</p>"}d=controller.status[b]>0?"green":"red",g+="<li class='"+d+(isStationDisabled(b)?" hidden":"")+"'><p class='sname center'>"+e+"</p>"+f+"</li>"});var n="",o=controller.settings.lrun[2];if(0!==o){var p=controller.settings.lrun[1],q=pidname(p);n=q+" "+_("last ran station")+" "+controller.stations.snames[controller.settings.lrun[0]]+" "+_("for")+" "+(o/60>>0)+"m "+o%60+"s "+_("on")+" "+dateToString(new Date(1e3*controller.settings.lrun[3]))}if(j>1||m>1){a=getUnique($.grep(a,function(a){return a}));var r=a.length;a=a.join(" "+_("and")+" ");var s=a+" "+_(r>1?"are":"is")+" "+_("running")+" ";"object"==typeof controller.stations.stn_seq?(m+=(l-1)*controller.options.sdt+e,j=Math.max(j,m)):1===controller.options.seq&&(j+=(l-1)*controller.options.sdt+e),k||l&&e>0?c.p=j:delete c.p,s+="<br><span id='countdown-p' class='nobr'>("+sec2hms(j)+" "+_("remaining")+")</span>",h+="<br>"+s}else controller.settings.rd?h+="<br>"+_("Rain delay until")+" "+dateToString(new Date(1e3*controller.settings.rdst)):1===controller.options.urs&&1===controller.settings.rs&&(h+="<br>"+_("Rain detected"));checkOSVersion(210)&&(f="<div class='ui-grid-b status-daily'>",f+="<div class='center ui-block-a'>"+pad(parseInt(controller.settings.sunrise/60)%24)+":"+pad(controller.settings.sunrise%60)+"<br>"+_("Sunrise")+"</div>",f+="<div class='center ui-block-b'>"+controller.options.wl+"%<br>"+_("Water Level")+"</div>",f+="<div class='center ui-block-c'>"+pad(parseInt(controller.settings.sunset/60)%24)+":"+pad(controller.settings.sunset%60)+"<br>"+_("Sunset")+"</div>",f+="</div>"),b.find(".ui-content").html("<p class='smaller center'>"+h+"</p>"+f+"<ul data-role='listview' data-inset='true' id='status_list'>"+g+"</ul><p class='smaller center'>"+n+"</p>").enhanceWithin()};b.on("datarefresh",f),f(),checkOSVersion(210)&&b.on("click",".ui-block-b",function(){var a=$("<div data-role='popup'><p>"+_("The watering percentage scales station run times by the set value. When weather adjustment is used the watering percentage is automatically adjusted.")+"</p></div>");return a.one("popupafterclose",function(){a.popup("destroy").remove()}).enhanceWithin(),$(".ui-page-active").append(a),a.popup({history:!1,positionTo:this}).popup("open"),!1}).on("click","li",function(){var a,b=$(this),c=b.index(),d=controller.status[c];if(d)a=_("Do you want to stop the selected station?");else{if(!b.find("span.nobr").length)return;a=_("Do you want to unschedule the selected station?")}areYouSure(a,controller.stations.snames[c],function(){send_to_os("/cm?sid="+c+"&en=0&pw=").done(function(){refresh_status(),showerror(_("Station has been stopped"))})})}),b.one({pagehide:function(){clearInterval(a),b.remove()},pageshow:function(){a=setInterval(function(){var b=(new Date).getTime(),f=$(".ui-page-active").attr("id"),g=b-d;g>3e3&&("status"===f?refresh_status():clearInterval(a)),0>=e?e=0:--e,d=b,$.each(c,function(b,d){if(0>=d)if(refresh_status(),delete c[b],"p"===b){if("status"!==f)return void clearInterval(a)}else e=controller.options.sdt-1,$("#countdown-"+b).parent("p").empty().parent("li").removeClass("green").addClass("red");else"c"===b?(++c[b],$("#clock-s").text(dateToString(new Date(1e3*c[b])))):(--c[b],$("#countdown-"+b).text("("+sec2hms(c[b])+" "+_("remaining")+")"))})},1e3)}}),b.appendTo("body")}function refresh_status(){var a=$(".ui-page-active");$.when(update_controller_status(),update_controller_settings(),update_controller_options()).then(function(){a.trigger("datarefresh")},network_fail)}function removeTimers(){void 0!==interval_id&&clearInterval(interval_id),void 0!==timeout_id&&clearTimeout(timeout_id)}function change_status(a,b,c,d){var e=$("#footer-running");d=d||function(){},removeTimers(),a>1&&update_timer(a,controller.options.sdt),e.removeClass().addClass(b).html(c).off("click").on("click",d).slideDown()}function check_status(){var a,b,c,d,e,f,g,h,i;if(!controller.settings.en)return void change_status(0,"red","<p class='running-text center'>"+_("System Disabled")+"</p>",function(){areYouSure(_("Do you want to re-enable system operation?"),"",function(){showLoading("#footer-running"),send_to_os("/cv?pw=&en=1").done(function(){update_controller(check_status)})})});for(a={},i=0;i<controller.status.length;i++)controller.status[i]&&(a[i]=controller.status[i]);if(controller.options.mas&&delete a[controller.options.mas-1],Object.keys(a).length>=2){b=0;for(i in a)a.hasOwnProperty(i)&&(h=controller.settings.ps[i][1],h>b&&(b=h));return c=Object.keys(a)[0],d=controller.settings.ps[c][0],e=pidname(d),f="<div><div class='running-icon'></div><div class='running-text'>",f+=e+" "+_("is running on")+" "+Object.keys(a).length+" "+_("stations")+" ",b>0&&(f+="<span id='countdown' class='nobr'>("+sec2hms(b)+" "+_("remaining")+")</span>"),f+="</div></div>",void change_status(b,"green",f,function(){changePage("#status")})}for(g=!1,i=0;i<controller.stations.snames.length;i++)if(controller.settings.ps[i]&&controller.settings.ps[i][0]&&controller.status[i]&&controller.options.mas!==i+1){g=!0,d=controller.settings.ps[i][0],e=pidname(d),f="<div><div class='running-icon'></div><div class='running-text'>",f+=e+" "+_("is running on station")+" <span class='nobr'>"+controller.stations.snames[i]+"</span> ",controller.settings.ps[i][1]>0&&(f+="<span id='countdown' class='nobr'>("+sec2hms(controller.settings.ps[i][1])+" "+_("remaining")+")</span>"),f+="</div></div>";break}return g?void change_status(controller.settings.ps[i][1],"green",f,function(){changePage("#status")}):controller.settings.rd?void change_status(0,"red","<p class='running-text center'>"+_("Rain delay until")+" "+dateToString(new Date(1e3*controller.settings.rdst))+"</p>",function(){areYouSure(_("Do you want to turn off rain delay?"),"",function(){showLoading("#footer-running"),send_to_os("/cv?pw=&rd=0").done(function(){update_controller(check_status)})})}):1===controller.options.urs&&1===controller.settings.rs?void change_status(0,"red","<p class='running-text center'>"+_("Rain detected")+"</p>"):1===controller.settings.mm?void change_status(0,"red","<p class='running-text center'>"+_("Manual mode enabled")+"</p>",function(){areYouSure(_("Do you want to turn off manual mode?"),"",function(){showLoading("#footer-running"),send_to_os("/cv?pw=&mm=0").done(function(){update_controller(check_status)})})}):void $("#footer-running").slideUp()}function update_timer(a,b){var c=(new Date).getTime();interval_id=setInterval(function(){var d=(new Date).getTime(),e=d-c;e>3e3&&(clearInterval(interval_id),showLoading("#footer-running"),update_controller(check_status)),c=d,0>=a?(clearInterval(interval_id),showLoading("#footer-running"),void 0!==timeout_id&&clearTimeout(timeout_id),timeout_id=setTimeout(function(){update_controller(check_status)},1e3*b)):--a,$("#countdown").text("("+sec2hms(a)+" "+_("remaining")+")")},1e3)}function get_manual(){var a,b,c,d="<li data-role='list-divider' data-theme='a'>"+_("Sprinkler Stations")+"</li>",e=$("<div data-role='page' id='manual'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false'><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Manual Control")+"</h3></div><div class='ui-content' role='main'><p class='center'>"+_("With manual mode turned on, tap a station to toggle it.")+"</p><fieldset data-role='collapsible' data-collapsed='false' data-mini='true'><legend>"+_("Options")+"</legend><div class='ui-field-contain'><label for='mmm'><b>"+_("Manual Mode")+"</b></label><input type='checkbox' data-on-text='On' data-off-text='Off' data-role='flipswitch' name='mmm' id='mmm'"+(controller.settings.mm?" checked":"")+"></div><p class='rain-desc smaller center' style='padding-top:5px'>"+_("Station timer prevents a station from running indefinitely and will automatically turn it off after the set duration (or when toggled off)")+"</p><div class='ui-field-contain duration-input'><label for='auto-off'><b>"+_("Station Timer")+"</b></label><button data-mini='true' name='auto-off' id='auto-off' value='3600'>1h</button></div></fieldset></div></div>"),f=function(a){update_controller_status().done(function(){var b=c.eq(a).find("a");controller.options.mas&&(controller.status[controller.options.mas-1]?c.eq(controller.options.mas-1).addClass("green"):c.eq(controller.options.mas-1).removeClass("green")),b.text(controller.stations.snames[a]),controller.status[a]?b.removeClass("yellow").addClass("green"):b.removeClass("green yellow")})},g=function(){if(!controller.settings.mm)return showerror(_("Manual mode is not enabled. Please enable manual mode then try again.")),!1;var b=$(this),d=b.closest("li"),e=c.index(d),g=e+1,i=h.val();return b.hasClass("yellow")?!1:(a=controller.status[e]?checkOSPiVersion("2.1")?"/sn?sid="+g+"&set_to=0&pw=":"/sn"+g+"=0":checkOSPiVersion("2.1")?"/sn?sid="+g+"&set_to=1&set_time="+i+"&pw=":"/sn"+g+"=1&t="+i,b.removeClass("green").addClass("yellow"),b.html("<p class='ui-icon ui-icon-loading mini-load'></p>"),send_to_os(a).always(function(){setTimeout(f,1e3,e)}),!1)},h=e.find("#auto-off");$.each(controller.stations.snames,function(a,b){d+=controller.options.mas===a+1?"<li data-icon='false' class='center"+(isStationDisabled(a)?" hidden":"")+(controller.status[a]?" green":"")+"'>"+b+" ("+_("Master")+")</li>":"<li data-icon='false'><a class='mm_station center"+(isStationDisabled(a)?" hidden":"")+(controller.status[a]?" green":"")+"'>"+b+"</a></li>"}),b=$("<ul data-role='listview' data-inset='true' id='mm_list'>"+d+"</ul>"),c=b.children("li").slice(1),b.find(".mm_station").on("vclick",g),e.find(".ui-content").append(b),h.on("click",function(){var a=$(this),b=e.find("label[for='"+a.attr("id")+"']").text();return showDurationBox({seconds:a.val(),title:b,callback:function(b){a.val(b),a.text(dhms2str(sec2dhms(b))),storage.set({autoOff:b})},maximum:32768}),!1}),e.find("#mmm").flipswitch().on("change",flipSwitched),storage.get("autoOff",function(a){a.autoOff&&(h.val(a.autoOff),h.text(dhms2str(sec2dhms(a.autoOff))))}),e.one("pagehide",function(){e.remove()}),$("#manual").remove(),e.appendTo("body")}function get_runonce(){var a,b,c,d,e,f,g,h="<p class='center'>"+_("Zero value excludes the station from the run-once program.")+"</p>",i=$("<div data-role='page' id='runonce'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false'><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Run-Once")+"</h3><button data-icon='check' class='ui-btn-right'>"+_("Submit")+"</button></div><div class='ui-content' role='main' id='runonce_list'></div></div>"),j=function(a){d.l=a,$("<option value='l' selected='selected'>"+_("Last Used Program")+"</option>").insertAfter(i.find("#rprog").find("option[value='t']")),l(a)},k=function(){return i.find("[id^='zone-']").val(0).text("0s").removeClass("green"),!1},l=function(a){i.find("[id^='zone-']").each(function(b,c){if(controller.options.mas!==b+1){var d=$(c);d.val(a[b]).text(dhms2str(sec2dhms(a[b]))),a[b]>0?d.addClass("green"):d.removeClass("green")}})};if(i.find("div[data-role='header'] > .ui-btn-right").on("click",submit_runonce),c=[],controller.programs.pd.length)for(e=0;e<controller.programs.pd.length;e++){f=read_program(controller.programs.pd[e]);var m=[];if(checkOSVersion(210))m=f.stations;else{var n=f.stations.split("");for(a=0;a<controller.stations.snames.length;a++)m.push(parseInt(n[a])?f.duration:0)}c.push(m)}for(d=c,b="<select data-mini='true' name='rprog' id='rprog'><option value='t'>"+_("Test All Stations")+"</option><option value='s' selected='selected'>"+_("Quick Programs")+"</option>",a=0;a<c.length;a++)g=checkOSVersion(210)?controller.programs.pd[a][5]:_("Program")+" "+(a+1),b+="<option value='"+a+"'>"+g+"</option>";if(b+="</select>",h+=b+"<form>",$.each(controller.stations.snames,function(a,b){h+=controller.options.mas===a+1?"<div class='ui-field-contain duration-input"+(isStationDisabled(a)?" hidden":"")+"'><label for='zone-"+a+"'>"+b+":</label><button disabled='true' data-mini='true' name='zone-"+a+"' id='zone-"+a+"' value='0'>Master</button></div>":"<div class='ui-field-contain duration-input"+(isStationDisabled(a)?" hidden":"")+"'><label for='zone-"+a+"'>"+b+":</label><button data-mini='true' name='zone-"+a+"' id='zone-"+a+"' value='0'>0s</button></div>"}),h+="</form><a class='ui-btn ui-corner-all ui-shadow rsubmit' href='#'>"+_("Submit")+"</a><a class='ui-btn ui-btn-b ui-corner-all ui-shadow rreset' href='#'>"+_("Reset")+"</a>",i.find(".ui-content").html(h),"object"==typeof controller.settings.rodur){var o=0;for(a=0;a<controller.settings.rodur.length;a++)o+=controller.settings.rodur[a];0!==o&&j(controller.settings.rodur)}else storage.get("runonce",function(a){a=a.runonce,a&&(a=JSON.parse(a),j(a))});i.find("#rprog").on("change",function(){var a=$(this).val();return"s"===a?void k():"t"===a?void l(Array.apply(null,Array(controller.stations.snames.length)).map(function(){return 60})):void("undefined"!=typeof d[a]&&l(d[a]))}),i.on("click",".rsubmit",submit_runonce).on("click",".rreset",k),i.find("[id^='zone-']").on("click",function(){var a=$(this),b=i.find("label[for='"+a.attr("id")+"']").text().slice(0,-1);return showDurationBox({seconds:a.val(),title:b,callback:function(b){a.val(b),a.text(dhms2str(sec2dhms(b))),b>0?a.addClass("green"):a.removeClass("green")},maximum:65535}),!1}),i.one("pagehide",function(){i.remove()}),$("#runonce").remove(),i.appendTo("body")}function submit_runonce(a){a instanceof Array||(a=[],$("#runonce").find("[id^='zone-']").each(function(b,c){a.push(parseInt($(c).val())||0)}),a.push(0));var b=function(){$.mobile.loading("show"),storage.set({runonce:JSON.stringify(a)}),send_to_os("/cr?pw=&t="+JSON.stringify(a)).done(function(){$.mobile.loading("hide"),$.mobile.document.one("pageshow",function(){showerror(_("Run-once program has been scheduled"))}),update_controller_status(),update_controller_settings(),goBack()})},c=isRunning();-1!==c?areYouSure(_("Do you want to stop the currently running program?"),pidname(controller.settings.ps[c][0]),function(){$.mobile.loading("show"),stopStations(b)}):b()}function get_preview(){var a,b,c,d,e,f,g,h,i,j,k=new Date(1e3*controller.settings.devt),l=k.toISOString().slice(0,10),m=$("<div data-role='page' id='preview'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false'><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Program Preview")+"</h3></div><div class='ui-content' role='main'><div id='preview_header' class='input_with_buttons'><button class='preview-minus ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input class='center' type='date' name='preview_date' id='preview_date' value='"+l+"'><button class='preview-plus ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div><div id='timeline'></div><div data-role='controlgroup' data-type='horizontal' id='timeline-navigation'><a class='ui-btn ui-corner-all ui-icon-plus ui-btn-icon-notext btn-no-border' title='"+_("Zoom in")+"'></a><a class='ui-btn ui-corner-all ui-icon-minus ui-btn-icon-notext btn-no-border' title='"+_("Zoom out")+"'></a><a class='ui-btn ui-corner-all ui-icon-carat-l ui-btn-icon-notext btn-no-border' title='"+_("Move left")+"'></a><a class='ui-btn ui-corner-all ui-icon-carat-r ui-btn-icon-notext btn-no-border' title='"+_("Move right")+"'></a></div></div></div>"),n=m.find("#timeline"),o=m.find("#timeline-navigation"),p=checkOSVersion(210),q=checkOSVersion(211);l=l.split("-"),j=new Date(l[0],l[1]-1,l[2]),b=function(b,d,e){a=[];for(var g,h,i,j=Math.floor(controller.settings.devt/86400),k=0,l=Date.UTC(e,b-1,d,0,0,0,0),m=l/1e3/3600/24>>0,n=new Array(8*controller.settings.nbrd),o=new Array(8*controller.settings.nbrd),r=new Array(8*controller.settings.nbrd),s=0,t=0,u=0;u<controller.settings.nbrd;u++)n[u]=0,o[u]=0,r[u]=0;do{g=0,h=0;for(var v=0;v<controller.programs.pd.length;v++)if(i=controller.programs.pd[v],c(i,k,l,m,j))for(u=0;u<8*controller.settings.nbrd;u++){var w=u>>3,x=u%8;if(controller.options.mas!==u+1)if(p){if(controller.stations.stn_dis[w]&1<<x)continue;i[4][u]&&!r[u]&&(r[u]=2&i[0]&&(controller.options.uwt>0&&m===j||0===controller.options.uwt)?i[4][u]*controller.options.wl/100>>0:i[4][u],r[u]&&(o[u]=v+1,h=1))}else i[7+w]&1<<x&&(r[u]=i[6]*controller.options.wl/100>>0,o[u]=v+1,h=1)}if(h){var y=60*k,z=y;if(q){t>y&&(z=t+controller.options.sdt);var A,B;for(u=0;u<8*controller.settings.nbrd;u++)A=u>>3,B=7&u,r[u]&&!n[u]&&(controller.stations.stn_seq[A]&1<<B?(n[u]=z,z+=r[u],r[u]=z,z+=controller.options.sdt):(n[u]=y,r[u]=y+r[u]),g=1)}else if(p&&controller.options.seq&&s>y&&(y=s+controller.options.sdt),controller.options.seq)for(u=0;u<8*controller.settings.nbrd;u++)r[u]&&!n[u]&&(n[u]=y,y+=r[u],r[u]=y,y+=controller.options.sdt,g=1);else for(u=0;u<8*controller.settings.nbrd;u++)r[u]&&!n[u]&&(n[u]=y,r[u]=y+r[u],g=1)}if(g)if(q)for(t=f(60*k,n,o,r,l),k++,u=0;u<8*controller.settings.nbrd;u++)n[u]=0,o[u]=0,r[u]=0;else if(p)for(s=f(60*k,n,o,r,l),k++,u=0;u<8*controller.settings.nbrd;u++)n[u]=0,o[u]=0,r[u]=0;else{var C=f(60*k,n,o,r,l)/60>>0;for(controller.options.seq&&k!==C?k=C:k++,u=0;u<8*controller.settings.nbrd;u++)n[u]=0,o[u]=0,r[u]=0}else k++}while(1440>k)},f=function(b,c,d,e,f){for(var h=b,i=0;i<8*controller.settings.nbrd;i++)d[i]&&(q?(controller.options.mas>0&&controller.options.mas!==i+1&&controller.stations.masop[i>>3]&1<<i%8&&a.push({start:c[i]+controller.options.mton,end:e[i]+controller.options.mtof,content:"",className:"master",shortname:"M",group:"Master"}),g(i,c[i],d[i],e[i],f)):1===controller.options.seq?(controller.options.mas>0&&controller.options.mas!==i+1&&controller.stations.masop[i>>3]&1<<i%8&&a.push({start:c[i]+controller.options.mton,end:e[i]+controller.options.mtof,content:"",className:"master",shortname:"M",group:"Master"}),g(i,c[i],d[i],e[i],f),h=e[i]):(g(i,b,d[i],e[i],f),controller.options.mas>0&&controller.options.mas!==i+1&&controller.stations.masop[i>>3]&1<<i%8&&(h=h>e[i]?h:e[i])));return q||0===controller.options.seq&&controller.options.mas>0&&a.push({start:b,end:h,content:"",className:"master",shortname:"M",group:"Master"}),h},g=function(b,c,d,e,f){var g="program-"+(d+3)%4,h="P"+d;(0!==controller.settings.rd&&f+c+900*(controller.options.tz-48)<=1e3*controller.settings.rdst||1===controller.options.urs&&1===controller.settings.rs)&&"object"==typeof controller.stations.ignore_rain&&0===(controller.stations.ignore_rain[parseInt(b/8)]&1<<b%8)&&(g="delayed"),checkOSVersion(210)&&(h=controller.programs.pd[d-1][5]),a.push({start:c,end:e,className:g,content:h,pid:d-1,shortname:"S"+(b+1),group:controller.stations.snames[b]})},c=function(a,b,c,f,g){return p?e(a,b,c,f,g):d(a,b,c,f,g)},d=function(a,b,c,d,e){if(0===a[0])return 0;if(128&a[1]&&a[2]>1){var f=a[2],g=127&a[1];if(d%f!==(e+g)%f)return 0}else{var h=new Date(c),i=(h.getUTCDay()+6)%7;if(0===(a[1]&1<<i))return 0;var j=h.getUTCDate();if(128&a[1]&&0===a[2]&&j%2!==0)return 0;if(128&a[1]&&1===a[2]&&(31===j||29===j&&1===h.getUTCMonth()||j%2!==1))return 0}return b<a[3]||b>a[4]||isOSPi()&&b>=a[4]?0:0===a[5]?0:((b-a[3])/a[5]>>0)*a[5]===b-a[3]?1:0},e=function(a,b,c,d,e){var f,g=1&a[0],h=a[0]>>2&3,i=a[0]>>4&3,j=a[0]>>6&1,k=new Date(c);if(!g)return 0;if(3===i){var l=a[2],m=a[1];if(d%l!==(e+m)%l)return 0}else{if(0!==i)return 0;var n=(k.getUTCDay()+6)%7;if(0===(a[1]&1<<n))return 0}if(h){var o=k.getUTCDate();if(2===h&&o%2!==0)return 0;if(1===h&&(31===o||29===o&&1===k.getUTCMonth()||o%2!==1))return 0}if(0===j){var p=a[3][0],q=a[3][1],r=a[3][2];if(p>b)return 0;if(!q)return b===p?1:0;if(!r)return 0;var s=(b-p)/r>>0;if(s*r===b-p&&q>=s)return 1}else{var t=a[3];for(f=0;4>f;f++)if(b===t[f])return 1}return 0},h=function(a){j.setDate(j.getDate()+a);var b=pad(j.getMonth()+1),c=pad(j.getDate()),d=j.getFullYear();l=[d,b,c],m.find("#preview_date").val(l.join("-")),i()},i=function(){if(b(l[1],l[2],l[0]),o.hide(),!a.length)return void m.find("#timeline").html("<p align='center'>"+_("No stations set to run on this day.")+"</p>");var c=[];$.each(a,function(){this.start=new Date(l[0],l[1]-1,l[2],0,0,this.start),this.end=new Date(l[0],l[1]-1,l[2],0,0,this.end),c[this.group]=this.shortname});var d={width:"100%",editable:!1,axisOnTop:!0,eventMargin:10,eventMarginAxis:0,min:new Date(l[0],l[1]-1,l[2],0),max:new Date(l[0],l[1]-1,l[2],24),selectable:!0,showMajorLabels:!1,zoomMax:864e5,zoomMin:36e5,groupsChangeable:!1,showNavigation:!1,groupsOrder:"none",groupMinHeight:20},e=new links.Timeline(n[0],d),f=new Date(k);if(f.setMinutes(f.getMinutes()+f.getTimezoneOffset()),e.setCurrentTime(f),links.events.addListener(e,"select",function(){var a=e.getSelection();a.length&&"undefined"!=typeof a[0].row&&changePage("#programs",{programToExpand:parseInt(e.getItem(a[0].row).pid)})}),$.mobile.window.off("resize").on("resize",function(){e.redraw()}),e.draw(a),$.mobile.window.width()<=480){var g=e.getVisibleChartRange();g.end.getTime()-g.start.getTime()>6e6&&e.setVisibleChartRange(g.start,new Date(g.start.getTime()+6e6))}m.find(".timeline-groups-text").each(function(a,b){var d=$(b),e=c[d.text()];d.attr("data-shortname",e)}),m.find(".timeline-groups-axis").children().first().html("<div class='timeline-axis-text center dayofweek' data-shortname='"+getDayName(j,"short")+"'>"+getDayName(j)+"</div>"),isAndroid&&(o.find(".ui-icon-plus").off("click").on("click",function(){return e.zoom(.4),!1}),o.find(".ui-icon-minus").off("click").on("click",function(){return e.zoom(-.4),!1}),o.find(".ui-icon-carat-l").off("click").on("click",function(){return e.move(-.2),!1}),o.find(".ui-icon-carat-r").off("click").on("click",function(){return e.move(.2),!1}),o.show())},n.on("swiperight",function(a){a.stopImmediatePropagation()}),m.find("#preview_date").on("change",function(){l=this.value.split("-"),j=new Date(l[0],l[1]-1,l[2]),i()}),holdButton(m.find(".preview-plus"),function(){h(1)}),holdButton(m.find(".preview-minus"),function(){h(-1)}),m.one({pagehide:function(){$.mobile.window.off("resize"),m.remove()},pageshow:i}),$("#preview").remove(),m.appendTo("body")}function get_logs(){var a,b,c,d=new Date(1e3*controller.settings.devt),e=$.mobile.window.width()<640?!0:!1,f=$("<div data-role='page' id='logs'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false' data-hide-during-focus=''><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Logs")+"</h3><a href='#' data-icon='refresh' class='ui-btn-right'>"+_("Refresh")+"</a></div><div class='ui-content' role='main'><fieldset data-role='controlgroup' data-type='horizontal' data-mini='true' class='log_type'><input data-mini='true' type='radio' name='log_type' id='log_graph' value='graph' "+(e?"":"checked='checked'")+"><label for='log_graph'>"+_("Graph")+"</label><input data-mini='true' type='radio' name='log_type' id='log_table' value='table' "+(e?"checked='checked'":"")+"><label for='log_table'>"+_("Table")+"</label></fieldset><div id='placeholder'></div><div id='zones'></div><fieldset data-role='collapsible' data-mini='true' id='log_options' class='center'><legend>"+_("Options")+"</legend><fieldset data-role='controlgroup' data-type='horizontal' id='graph_sort'><p class='tight'>"+_("Grouping:")+"</p><input data-mini='true' type='radio' name='g' id='radio-choice-d' value='n' checked='checked'><label for='radio-choice-d'>"+_("None")+"</label><input data-mini='true' type='radio' name='g' id='radio-choice-a' value='h'><label for='radio-choice-a'>"+_("Hour")+"</label><input data-mini='true' type='radio' name='g' id='radio-choice-b' value='d'><label for='radio-choice-b'>"+_("DOW")+"</label><input data-mini='true' type='radio' name='g' id='radio-choice-c' value='m'><label for='radio-choice-c'>"+_("Month")+"</label></fieldset><fieldset data-role='controlgroup' data-type='horizontal' id='table_sort'><p class='tight'>"+_("Grouping:")+"</p><input data-mini='true' type='radio' name='table-group' id='table-sort-day' value='day' checked='checked'><label for='table-sort-day'>"+_("Day")+"</label><input data-mini='true' type='radio' name='table-group' id='table-sort-station' value='station'><label for='table-sort-station'>"+_("Station")+"</label></fieldset><div class='ui-field-contain'><label for='log_start'>"+_("Start:")+"</label><input data-mini='true' type='date' id='log_start' value='"+new Date(d.getTime()-6048e5).toISOString().slice(0,10)+"'><label for='log_end'>"+_("End:")+"</label><input data-mini='true' type='date' id='log_end' value='"+d.toISOString().slice(0,10)+"'></div><a data-role='button' data-icon='action' class='export_logs' href='#' data-mini='true'>"+_("Export")+"</a>"+(isOSPi()||checkOSVersion(210)?"<a data-role='button' class='red clear_logs' href='#' data-mini='true' data-icon='alert'>"+_("Clear Logs")+"</a>":"")+"</fieldset><div id='logs_list' class='center'></div></div></div>"),g=f.find("#placeholder"),h=f.find("#logs_list"),i=f.find("#zones"),j=f.find("#graph_sort"),k=f.find("#table_sort"),l=f.find("#log_options"),m=[],n=[],o=$.merge($.merge([],controller.stations.snames),[_("Rain Sensor"),_("Rain Delay")]),p=function(){var a,b,c,d=f.find("input:radio[name='g']:checked").val(),e=[];
if(g.empty(),a=q("graph",d),i.find("td[zone_num]:not('.unchecked')").each(function(){var b=$(this).attr("zone_num");a[b].length||(a[b]=[[0,0]]),b&&a[b]&&e.push({data:a[b],label:$(this).attr("name"),color:parseInt(b),bars:{order:b,show:!0,barWidth:"h"===d||"m"===d||"d"===d?.1:36e5}})}),"n"===d&&!$.isEmptyObject(n)){var h=[];$.each(n,function(a,b){h.push([1e3*b[3],b[2]])}),e.push({data:h,label:_("Water Level"),yaxis:2,lines:{show:!0,fill:!1},points:{show:!0,fillColor:"rgb(51,136,204)"},color:"rgb(51,136,204)"})}"h"===d?b={grid:{hoverable:!0},yaxis:{min:0,tickFormatter:function(a,b){return a<b.max?Math.round(100*a)/100:"min"}},xaxis:{min:0,max:23,tickDecimals:0,tickSize:1}}:"d"===d?b={grid:{hoverable:!0},yaxis:{min:0,tickFormatter:function(a,b){return a<b.max?Math.round(100*a)/100:"min"}},xaxis:{tickDecimals:0,min:0,max:6,tickFormatter:function(a){var b=[_("Sun"),_("Mon"),_("Tue"),_("Wed"),_("Thr"),_("Fri"),_("Sat")];return b[a]}}}:"m"===d?b={grid:{hoverable:!0},yaxis:{min:0,tickFormatter:function(a,b){return a<b.max?Math.round(100*a)/100:"min"}},xaxis:{tickDecimals:0,min:0,max:11,tickSize:1,tickFormatter:function(a){var b=[_("Jan"),_("Feb"),_("Mar"),_("Apr"),_("May"),_("Jun"),_("Jul"),_("Aug"),_("Sep"),_("Oct"),_("Nov"),_("Dec")];return b[a]}}}:"n"===d&&(b={grid:{hoverable:!0},yaxes:[{min:0,tickFormatter:function(a,b){return a<b.max?Math.round(100*a)/100:"min"}},{min:0,position:1,tickFormatter:function(a){return Math.round(100*a)/100+"%"},alignTicksWithAxis:1}],xaxis:{tickLength:0,mode:"time",timeformat:"%b %d %H:%M",min:a.min.getTime()-432e5,max:a.max.getTime()+432e5}}),c=$.plot(g,e,b)},q=function(a,b){var d,e,f=[];if("graph"===a)switch(b){case"h":for(c=0;c<o.length;c++)f[c]=[[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,0],[10,0],[11,0],[12,0],[13,0],[14,0],[15,0],[16,0],[17,0],[18,0],[19,0],[20,0],[21,0],[22,0],[23,0]];break;case"m":for(c=0;c<o.length;c++)f[c]=[[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[9,0],[10,0],[11,0]];break;case"d":for(c=0;c<o.length;c++)f[c]=[[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0]];break;case"n":for(c=0;c<o.length;c++)f[c]=[]}else if("station"===b)for(c=0;c<o.length;c++)f[c]=[];return $.each(m,function(c,g){var h,i=parseInt(1e3*g[3]),j=g[1],k=new Date(i),l=new Date(k.getUTCFullYear(),k.getUTCMonth(),k.getUTCDate(),k.getUTCHours(),k.getUTCMinutes(),k.getUTCSeconds()),m=parseInt(g[2]/60);if("string"==typeof j)"rs"===j?j=o.length-2:"rd"===j&&(j=o.length-1);else if("number"==typeof j&&j>o.length-2)return;if("graph"===a){switch(b){case"h":h=k.getUTCHours();break;case"m":h=k.getUTCMonth()+1;break;case"d":h=k.getUTCDay();break;case"n":f[j].push([i,m])}"n"!==b&&m>0&&(f[j][h][1]+=m),(void 0===e||e>k)&&(e=k),(void 0===d||k>d)&&(d=new Date(k.getTime()+100*m*1e3+1))}else switch(b){case"station":f[j].push([l.getTime(),dhms2str(sec2dhms(parseInt(g[2])))]);break;case"day":var n=Math.floor(k.getTime()/1e3/60/60/24),p=[l.getTime(),dhms2str(sec2dhms(parseInt(g[2]))),j];"object"!=typeof f[n]?f[n]=[p]:f[n].push(p)}}),"graph"===a&&(f.min=e,f.max=d),f},r=function(){var a=$(this);a.hasClass("legendColorBox")?(a.find("div div").toggleClass("hideZone"),a.next().toggleClass("unchecked")):a.hasClass("legendLabel")&&(a.prev().find("div div").toggleClass("hideZone"),a.toggleClass("unchecked")),p()},s=function(){var a=i.height(),b=i.scrollLeft(),c=$("#graphScrollRight"),d=$("#graphScrollLeft");b>13?d.show().css("margin-top",a/2-12.5):d.hide();var e=i.find("table").width(),g=i.width();e-g>0&&e-g-13>b?c.show().css({"margin-top":a/2-12.5,left:g+(f.width()-g)/2-18}):c.hide()},t=function(a,b){return"object"!=typeof a||a.length<1||a.result&&32===a.result?($.mobile.loading("hide"),void x()):(m=a,n=$.isEmptyObject(b)?[]:b,u(),exportObj(".export_logs",m),void $.mobile.loading("hide"))},u=function(){$("#tooltip").remove(),$("#log_graph").prop("checked")?v():w()},v=function(){if(m.length<1)return void x();h.empty().hide();var a=$.mobile.window.height()>680?"expand":"collapse";setTimeout(function(){l.collapsible(a)},100),g.empty(),g.show();var b=i.find("table").length;if(i.show(),j.show(),k.hide(),!b){var d="<div class='ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border' id='graphScrollLeft'></div><div class='ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border' id='graphScrollRight'></div><table class='smaller'><tbody><tr>";for(c=0;c<o.length;c++)d+="<td class='legendColorBox'><div><div></div></div></td><td id='z"+c+"' zone_num="+c+" name='"+o[c]+"' class='legendLabel'>"+o[c]+"</td>";d+="</tr></tbody></table>",i.empty().append(d).enhanceWithin(),i.find("td").on("click",r),i.find("#graphScrollLeft,#graphScrollRight").on("click",function(){var a="graphScrollRight"===$(this).attr("id")?"+=":"-=",b=i.width();i.animate({scrollLeft:a+b})})}p(),c=0,b||(i.find("td.legendColorBox div div").each(function(a,b){var d=$(g.find(".legendColorBox div div").get(c)).css("border");""===d&&(d=$(g.find(".legendColorBox div div").get(c)).attr("style").split(";"),$.each(d,function(a,b){var c=b.split(":");return"border"===c[0]?(d=c[1],!1):void 0})),$(b).css("border",d),c++}),s())},w=function(){if(m.length<1)return void x();g.empty().hide(),i.hide(),j.hide(),k.show(),h.show();var a,b,c,d=f.find("input:radio[name='table-group']:checked").val(),e="<table><thead><tr><th data-priority='1'>"+_("Runtime")+"</th><th data-priority='2'>"+("station"===d?_("Date/Time"):_("Time")+"</th><th>"+_("Station"))+"</th></tr></thead><tbody>",p="<div data-role='collapsible-set' data-inset='true' data-theme='b' data-collapsed-icon='arrow-d' data-expanded-icon='arrow-u'>",r=q("table",d),s=[],t=[],u=0;$.isEmptyObject(n)||$.each(n,function(a,b){t[Math.floor(b[3]/60/60/24)]=b[2]});for(a in r)if(r.hasOwnProperty(a)){if(b=r[a].length,0===b)continue;for(s[u]="<div data-role='collapsible' data-collapsed='true'><h2><div class='ui-btn-up-c ui-btn-corner-all custom-count-pos'>"+b+" "+_(1===b?"run":"runs")+"</div>"+("station"===d?o[a]:dateToString(new Date(1e3*a*60*60*24)).slice(0,-9))+"</h2>",t[a]&&(s[u]+="<span style='border:none' class='"+(100!==t[a]?t[a]<100?"green ":"red ":"")+"ui-body ui-body-a ui-corner-all'>"+_("Average")+" "+_("Water Level")+": "+t[a]+"%</span>"),s[u]+=e,c=0;c<r[a].length;c++){var v=new Date(r[a][c][0]);s[u]+="<tr><td>"+r[a][c][1]+"</td><td>"+("station"===d?dateToString(v,!1):pad(v.getHours())+":"+pad(v.getMinutes())+":"+pad(v.getSeconds())+"</td><td>"+o[r[a][c][2]])+"</td></tr>"}s[u]+="</tbody></table></div>",u++}"day"===d&&s.reverse(),l.collapsible("collapse"),h.html(p+s.join("")+"</div>").enhanceWithin(),fixInputClick(h)},x=function(){g.empty().hide(),l.collapsible("expand"),i.empty().hide(),j.hide(),k.hide(),h.show().html(_("No entries found in the selected date range"))},y=function(){$.mobile.loading("hide"),x()},z=function(){var a=$("#log_start").val().split("-"),b=$("#log_end").val().split("-");return{start:new Date(a[0],a[1]-1,a[2]),end:new Date(b[0],b[1]-1,b[2])}},A=function(){return"start="+z().start.getTime()/1e3+"&end="+(z().end.getTime()/1e3+86340)},B=function(){var a=z().end.getTime()/1e3,b=z().start.getTime()/1e3;if(b>a)return y(),void showerror(_("Start time cannot be greater than end time"));var c=0;if($.mobile.loading("show"),a-b>3154e4){showerror(_("The requested time span exceeds the maxiumum of 1 year and has been adjusted"),3500);var d=z().start;d.setFullYear(d.getFullYear()+1),$("#log_end").val(d.getFullYear()+"-"+pad(d.getMonth()+1)+"-"+pad(d.getDate())),c=500}var e=$.Deferred().resolve();checkOSVersion(211)&&(e=send_to_os("/jl?pw=&type=wl&"+A(),"json")),setTimeout(function(){$.when(send_to_os("/jl?pw=&"+A(),"json"),e).then(t,y)},c)};f.find("input").blur(),i.scroll(s),$.mobile.window.resize(function(){f.find("#log_graph").is(":checked")&&g.is(":visible")&&(s(),p())}),f.find(".clear_logs").on("click",function(){return areYouSure(_("Are you sure you want to clear ALL your log data?"),"",function(){var a=isOSPi()?"/cl?pw=":"/dl?pw=&day=all";$.mobile.loading("show"),send_to_os(a).done(function(){B(),showerror(_("Logs have been cleared"))})}),!1}),isiOS?f.find("#log_start,#log_end").on("blur",B):f.find("#log_start,#log_end").change(function(){clearTimeout(a),a=setTimeout(B,1e3)}),j.find("input[name='g']").change(function(){p()}),k.find("input[name='table-group']").change(function(){w()}),f.find("div[data-role='header'] > .ui-btn-right").on("click",B),f.find("input:radio[name='log_type']").change(u),g.on("plothover",function(a,c,d){$("#tooltip").remove(),clearTimeout(b),d&&(b=setTimeout(function(){showTooltip(d.pageX,d.pageY,d.series.label,d.series.color)},100))}),f.one({pagehide:function(){$("#tooltip").remove(),$.mobile.window.off("resize"),f.remove()},pageshow:B}),$("#logs").remove(),f.appendTo("body")}function get_programs(a){var b=$("<div data-role='page' id='programs'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false' data-hide-during-focus=''><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("Programs")+"</h3><a href='#addprogram' data-icon='plus' class='ui-btn-right'>"+_("Add")+"</a></div><div class='ui-content' role='main' id='programs_list'>"+make_all_programs()+"</div></div>");b.find(".ui-toolbar-back-btn").on("click",checkChangesBeforeBack),b.find("[id^=program-]").on({collapsiblecollapse:function(){$(this).find(".ui-collapsible-content").empty()},collapsiblebeforecollapse:function(a){var b=$(this),c=b.find(".hasChanges");c.length&&(areYouSure(_("Do you want to save your changes?"),"",function(){c.removeClass("hasChanges").click(),b.collapsible("collapse")},function(){c.removeClass("hasChanges"),b.collapsible("collapse")}),a.preventDefault())},collapsibleexpand:function(){expandProgram($(this))}}),checkOSVersion(210)&&b.find(".move-up").removeClass("hidden").on("click",function(){var a=$(this).parents("fieldset"),b=parseInt(a.attr("id").split("-")[1]);return $.mobile.loading("show"),send_to_os("/up?pw=&pid="+b).done(function(){update_controller_programs(function(){$.mobile.loading("hide"),changePage("#programs",{updatePrograms:!0,showLoadMsg:!1})})}),!1}),b.find(".program-copy").on("click",function(){var a=parseInt($(this).parents("fieldset").attr("id").split("-")[1]);return changePage("#addprogram",{copyID:a}),!1}),b.one("pagehide",function(){b.remove()}).one("pagebeforeshow",function(){update_program_header(),"number"!=typeof a&&1===controller.programs.pd.length&&(a=0),"number"==typeof a&&(b.find("fieldset[data-collapsed='false']").collapsible("collapse"),$("#program-"+a).collapsible("expand"))}),$("#programs").remove(),b.appendTo("body")}function expandProgram(a){var b=parseInt(a.attr("id").split("-")[1]);a.find(".ui-collapsible-content").html(make_program(b)).enhanceWithin().on("change input click",function(b){("click"!==b.type||"BUTTON"===b.target.tagName)&&($(this).off("change input click"),a.find("[id^='submit-']").addClass("hasChanges"))}),a.find("[id^='submit-']").on("click",function(){return submit_program(b),!1}),a.find("[id^='delete-']").on("click",function(){return delete_program(b),!1}),a.find("[id^='run-']").on("click",function(){var a=[];if(checkOSVersion(210))a=controller.programs.pd[b][4];else{var c=parseInt($("#duration-"+b).val()),d=$("[id^='station_'][id$='-"+b+"']");$.each(d,function(b,d){a.push($(d).is(":checked")?c:0)})}return a.push(0),submit_runonce(a),!1})}function read_program(a){return checkOSVersion(210)?read_program21(a):read_program183(a)}function read_program183(a){var b=a[1],c=a[2],d=!1,e=!1,f=!1,g="",h="",i={};i.en=a[0];for(var j=0;j<controller.programs.nboards;j++)for(var k=a[7+j],l=0;8>l;l++)h+=k&1<<l?"1":"0";if(i.stations=h,i.duration=a[6],i.start=a[3],i.end=a[4],i.interval=a[5],128&b&&c>1)g=[c,127&b],f=!0;else{for(var m=0;7>m;m++)g+=b&1<<m?"1":"0";128&b&&0===c&&(d=!0),128&b&&1===c&&(e=!0)}return i.days=g,i.is_even=d,i.is_odd=e,i.is_interval=f,i}function read_program21(a){var b=a[1],c=a[2],d=a[0]>>2&3,e=a[0]>>4&3,f=a[0]>>6&1,g="",h={repeat:0,interval:0};if(h.en=a[0]>>0&1,h.weather=a[0]>>1&1,h.is_even=2===d?!0:!1,h.is_odd=1===d?!0:!1,h.is_interval=3===e?!0:!1,h.stations=a[4],h.name=a[5],0===f?(h.start=a[3][0],h.repeat=a[3][1],h.interval=a[3][2]):1===f&&(h.start=a[3]),3===e)g=[c,b];else if(0===e)for(var i=0;7>i;i++)g+=b&1<<i?"1":"0";return h.days=g,h}function pidname(a){var b=_("Program")+" "+a;return 255===a||99===a?b=_("Manual program"):254===a||98===a?b=_("Run-once program"):checkOSVersion(210)&&a<=controller.programs.pd.length&&(b=controller.programs.pd[a-1][5]),b}function update_program_header(){$("#programs_list").find("[id^=program-]").each(function(a,b){var c=$(b),d=c.find(".ui-collapsible-heading-toggle"),e=checkOSVersion(210)?1&controller.programs.pd[a][0]:controller.programs.pd[a][0];e?d.removeClass("red"):d.addClass("red")})}function make_all_programs(){if(0===controller.programs.pd.length)return"<p class='center'>"+_("You have no programs currently added. Tap the Add button on the top right corner to get started.")+"</p>";for(var a,b="<p class='center'>"+_("Click any program below to expand/edit. Be sure to save changes.")+"</p><div data-role='collapsible-set'>",c=0;c<controller.programs.pd.length;c++)a=_("Program")+" "+(c+1),checkOSVersion(210)&&(a=controller.programs.pd[c][5]),b+="<fieldset id='program-"+c+"' data-role='collapsible'><h3><a "+(c>0?"":"style='visibility:hidden' ")+"class='hidden ui-btn ui-btn-icon-notext ui-icon-arrow-u ui-btn-corner-all move-up'></a><a class='ui-btn ui-btn-corner-all program-copy'>"+_("copy")+"</a><span class='program-name'>"+a+"</span></h3>",b+="</fieldset>";return b+"</div>"}function make_program(a,b){return checkOSVersion(210)?make_program21(a,b):make_program183(a,b)}function make_program183(a,b){var c,d,e,f,g,h,i=[_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday"),_("Sunday")],j="",k=b?"new":a;if(g="new"===a?{en:0,weather:0,is_interval:0,is_even:0,is_odd:0,duration:0,interval:0,start:0,end:0,days:[0,0]}:read_program(controller.programs.pd[a]),"string"==typeof g.days)for(c=g.days.split(""),d=c.length;d--;)c[d]=0|c[d];else c=[0,0,0,0,0,0,0];if("undefined"!=typeof g.stations)for(f=g.stations.split(""),d=f.length-1;d>=0;d--)f[d]=0|f[d];for(j+="<label for='en-"+k+"'><input data-mini='true' type='checkbox' "+(g.en||"new"===a?"checked='checked'":"")+" name='en-"+k+"' id='en-"+k+"'>"+_("Enabled")+"</label>",j+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",j+="<input data-mini='true' type='radio' name='rad_days-"+k+"' id='days_week-"+k+"' value='days_week-"+k+"' "+(g.is_interval?"":"checked='checked'")+"><label for='days_week-"+k+"'>"+_("Weekly")+"</label>",j+="<input data-mini='true' type='radio' name='rad_days-"+k+"' id='days_n-"+k+"' value='days_n-"+k+"' "+(g.is_interval?"checked='checked'":"")+"><label for='days_n-"+k+"'>"+_("Interval")+"</label>",j+="</fieldset><div id='input_days_week-"+k+"' "+(g.is_interval?"style='display:none'":"")+">",j+="<div class='center'><p class='tight'>"+_("Restrictions")+"</p><select data-inline='true' data-iconpos='left' data-mini='true' id='days_rst-"+k+"'>",j+="<option value='none' "+(g.is_even||g.is_odd?"":"selected='selected'")+">"+_("None")+"</option>",j+="<option value='odd' "+(!g.is_even&&g.is_odd?"selected='selected'":"")+">"+_("Odd Days")+"</option>",j+="<option value='even' "+(!g.is_odd&&g.is_even?"selected='selected'":"")+">"+_("Even Days")+"</option>",j+="</select></div>",j+="<div class='center'><p class='tight'>"+_("Days of the Week")+"</p><select "+($.mobile.window.width()>560?"data-inline='true' ":"")+"data-iconpos='left' data-mini='true' multiple='multiple' data-native-menu='false' id='d-"+k+"'><option>"+_("Choose day(s)")+"</option>",e=0;e<i.length;e++)j+="<option "+(!g.is_interval&&c[e]?"selected='selected'":"")+" value='"+e+"'>"+i[e]+"</option>";for(j+="</select></div></div>",j+="<div "+(g.is_interval?"":"style='display:none'")+" id='input_days_n-"+k+"' class='ui-grid-a'>",j+="<div class='ui-block-a'><label class='center' for='every-"+k+"'>"+_("Interval (Days)")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='every-"+k+"' pattern='[0-9]*' id='every-"+k+"' value='"+g.days[0]+"'></div>",j+="<div class='ui-block-b'><label class='center' for='starting-"+k+"'>"+_("Starting In")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='starting-"+k+"' pattern='[0-9]*' id='starting-"+k+"' value='"+g.days[1]+"'></div>",j+="</div>",j+="<fieldset data-role='controlgroup'><legend>"+_("Stations:")+"</legend>",e=0;e<controller.stations.snames.length;e++)j+="<label for='station_"+e+"-"+k+"'><input "+(isStationDisabled(e)?"data-wrapper-class='hidden' ":"")+"data-mini='true' type='checkbox' "+("undefined"!=typeof f&&f[e]?"checked='checked'":"")+" name='station_"+e+"-"+k+"' id='station_"+e+"-"+k+"'>"+controller.stations.snames[e]+"</label>";return j+="</fieldset>",j+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",j+="<button class='ui-btn ui-mini' name='s_checkall-"+k+"' id='s_checkall-"+k+"'>"+_("Check All")+"</button>",j+="<button class='ui-btn ui-mini' name='s_uncheckall-"+k+"' id='s_uncheckall-"+k+"'>"+_("Uncheck All")+"</button>",j+="</fieldset>",j+="<div class='ui-grid-a'>",j+="<div class='ui-block-a'><label class='center' for='start-"+k+"'>"+_("Start Time")+"</label><button class='timefield pad_buttons' data-mini='true' id='start-"+k+"' value='"+g.start+"'>"+minutesToTime(g.start)+"</button></div>",j+="<div class='ui-block-b'><label class='center' for='end-"+k+"'>"+_("End Time")+"</label><button class='timefield pad_buttons' data-mini='true' id='end-"+k+"' value='"+g.end+"'>"+minutesToTime(g.end)+"</button></div>",j+="</div>",j+="<div class='ui-grid-a'>",j+="<div class='ui-block-a'><label class='pad_buttons center' for='duration-"+k+"'>"+_("Station Duration")+"</label><button class='pad_buttons' data-mini='true' name='duration-"+k+"' id='duration-"+k+"' value='"+g.duration+"'>"+dhms2str(sec2dhms(g.duration))+"</button></div>",j+="<div class='ui-block-b'><label class='pad_buttons center' for='interval-"+k+"'>"+_("Program Interval")+"</label><button class='pad_buttons' data-mini='true' name='interval-"+k+"' id='interval-"+k+"' value='"+60*g.interval+"'>"+dhms2str(sec2dhms(60*g.interval))+"</button></div>",j+="</div>",b===!0||"new"===a?j+="<input data-mini='true' data-icon='check' type='submit' data-theme='b' name='submit-"+k+"' id='submit-"+k+"' value='"+_("Save New Program")+"'>":(j+="<button data-mini='true' data-icon='check' data-theme='b' name='submit-"+k+"' id='submit-"+k+"'>"+_("Save Changes to Program")+" "+(a+1)+"</button>",j+="<button data-mini='true' data-icon='arrow-r' name='run-"+k+"' id='run-"+k+"'>"+_("Run Program")+" "+(a+1)+"</button>",j+="<button data-mini='true' data-icon='delete' class='red bold' data-theme='b' name='delete-"+k+"' id='delete-"+k+"'>"+_("Delete Program")+" "+(a+1)+"</button>"),h=$(j),h.find("input[name^='rad_days']").on("change",function(){var a,b=$(this).val().split("-")[0];b=b.split("_")[1],a="n"===b?"week":"n",$("#input_days_"+b+"-"+k).show(),$("#input_days_"+a+"-"+k).hide()}),h.find("[id^='duration-'],[id^='interval-']").on("click",function(){var a=$(this),b=a.attr("id").match("interval")?1:0,c=h.find("label[for='"+a.attr("id")+"']").text();showDurationBox({seconds:a.val(),title:c,callback:function(b){a.val(b),a.text(dhms2str(sec2dhms(b)))},maximum:b?86340:65535,granularity:b})}),h.find(".timefield").on("click",function(){var a=$(this),b=h.find("label[for='"+a.attr("id")+"']").text();showTimeInput({minutes:a.val(),title:b,callback:function(b){a.val(b),a.text(minutesToTime(b))}})}),h.find("[id^='s_checkall-']").on("click",function(){return h.find("[id^='station_'][id$='-"+k+"']").prop("checked",!0).checkboxradio("refresh"),!1}),h.find("[id^='s_uncheckall-']").on("click",function(){return h.find("[id^='station_'][id$='-"+k+"']").prop("checked",!1).checkboxradio("refresh"),!1}),fixInputClick(h),h}function make_program21(a,b){var c,d,e,f,g,h,i,j,k=[_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday"),_("Sunday")],l="",m=b?"new":a;if(f="new"===a?{name:"",en:0,weather:0,is_interval:0,is_even:0,is_odd:0,interval:0,start:0,days:[0,0],repeat:0,stations:[]}:read_program(controller.programs.pd[a]),"string"==typeof f.days)for(c=f.days.split(""),d=c.length;d--;)c[d]=0|c[d];else c=[0,0,0,0,0,0,0];for(h="object"==typeof f.start?f.start:[f.start,-1,-1,-1],l+="<div style='margin-top:5px' class='ui-corner-all'>",l+="<div class='ui-bar ui-bar-a'><h3>"+_("Basic Settings")+"</h3></div>",l+="<div class='ui-body ui-body-a center'>",l+="<label for='name-"+m+"'>"+_("Program Name")+"</label><input data-mini='true' type='text' name='name-"+m+"' id='name-"+m+"' maxlength='"+controller.programs.pnsize+"' placeholder='"+_("Program")+" "+(controller.programs.pd.length+1)+"' value='"+f.name+"'>",l+="<label for='en-"+m+"'><input data-mini='true' type='checkbox' "+(f.en||"new"===a?"checked='checked'":"")+" name='en-"+m+"' id='en-"+m+"'>"+_("Enabled")+"</label>",l+="<label for='uwt-"+m+"'><input data-mini='true' type='checkbox' "+(f.weather?"checked='checked'":"")+" name='uwt-"+m+"' id='uwt-"+m+"'>"+_("Use Weather Adjustment")+"</label>",l+="<label class='center' for='start_1-"+m+"'>"+_("Start Time")+"</label><button class='timefield' data-mini='true' id='start_1-"+m+"' value='"+h[0]+"'>"+minutesToTime(h[0])+"</button>",l+="</div></div></div></div>",l+="<div style='margin-top:10px' class='ui-corner-all'>",l+="<div class='ui-bar ui-bar-a'><h3>"+_("Program Type")+"</h3></div>",l+="<div class='ui-body ui-body-a'>",l+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",l+="<input data-mini='true' type='radio' name='rad_days-"+m+"' id='days_week-"+m+"' value='days_week-"+m+"' "+(f.is_interval?"":"checked='checked'")+"><label for='days_week-"+m+"'>"+_("Weekly")+"</label>",l+="<input data-mini='true' type='radio' name='rad_days-"+m+"' id='days_n-"+m+"' value='days_n-"+m+"' "+(f.is_interval?"checked='checked'":"")+"><label for='days_n-"+m+"'>"+_("Interval")+"</label>",l+="</fieldset>",l+="<div id='input_days_week-"+m+"' "+(f.is_interval?"style='display:none'":"")+">",l+="<div class='center'><p class='tight'>"+_("Days of the Week")+"</p><select "+($.mobile.window.width()>560?"data-inline='true' ":"")+"data-iconpos='left' data-mini='true' multiple='multiple' data-native-menu='false' id='d-"+m+"'><option>"+_("Choose day(s)")+"</option>",e=0;e<k.length;e++)l+="<option "+(!f.is_interval&&c[e]?"selected='selected'":"")+" value='"+e+"'>"+k[e]+"</option>";for(l+="</select></div></div>",l+="<div "+(f.is_interval?"":"style='display:none'")+" id='input_days_n-"+m+"' class='ui-grid-a'>",l+="<div class='ui-block-a'><label class='center' for='every-"+m+"'>"+_("Interval (Days)")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='every-"+m+"' pattern='[0-9]*' id='every-"+m+"' value='"+f.days[0]+"'></div>",l+="<div class='ui-block-b'><label class='center' for='starting-"+m+"'>"+_("Starting In")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='starting-"+m+"' pattern='[0-9]*' id='starting-"+m+"' value='"+f.days[1]+"'></div>",l+="</div>",l+="<div class='center'><p class='tight'>"+_("Restrictions")+"</p><select data-inline='true' data-iconpos='left' data-mini='true' id='days_rst-"+m+"'>",l+="<option value='none' "+(f.is_even||f.is_odd?"":"selected='selected'")+">"+_("None")+"</option>",l+="<option value='odd' "+(!f.is_even&&f.is_odd?"selected='selected'":"")+">"+_("Odd Days")+"</option>",l+="<option value='even' "+(!f.is_odd&&f.is_even?"selected='selected'":"")+">"+_("Even Days")+"</option>",l+="</select></div>",l+="</div></div>",l+="<div style='margin-top:10px' class='ui-corner-all'>",l+="<div class='ui-bar ui-bar-a'><h3>"+_("Stations")+"</h3></div>",l+="<div class='ui-body ui-body-a'>",e=0;e<controller.stations.snames.length;e++)controller.options.mas===e+1?l+="<div class='ui-field-contain duration-input"+(isStationDisabled(e)?" hidden":"")+"'><label for='station_"+e+"-"+m+"'>"+controller.stations.snames[e]+":</label><button disabled='true' data-mini='true' name='station_"+e+"-"+m+"' id='station_"+e+"-"+m+"' value='0'>Master</button></div>":(i=f.stations[e]||0,l+="<div class='ui-field-contain duration-input"+(isStationDisabled(e)?" hidden":"")+"'><label for='station_"+e+"-"+m+"'>"+controller.stations.snames[e]+":</label><button "+(i>0?"class='green' ":"")+"data-mini='true' name='station_"+e+"-"+m+"' id='station_"+e+"-"+m+"' value='"+i+"'>"+dhms2str(sec2dhms(i))+"</button></div>");for(l+="</div></div>",l+="<div style='margin-top:10px' class='ui-corner-all'>",l+="<div class='ui-bar ui-bar-a'><h3>"+_("Additional Start Times")+"</h3></div>",l+="<div class='ui-body ui-body-a'>",l+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",l+="<input data-mini='true' type='radio' name='stype-"+m+"' id='stype_repeat-"+m+"' value='stype_repeat-"+m+"' "+("object"==typeof f.start?"":"checked='checked'")+"><label for='stype_repeat-"+m+"'>"+_("Repeating")+"</label>",l+="<input data-mini='true' type='radio' name='stype-"+m+"' id='stype_set-"+m+"' value='stype_set-"+m+"' "+("object"==typeof f.start?"checked='checked'":"")+"><label for='stype_set-"+m+"'>"+_("Fixed")+"</label>",l+="</fieldset>",l+="<div "+("object"==typeof f.start?"style='display:none'":"")+" id='input_stype_repeat-"+m+"'>",l+="<div class='ui-grid-a'>",l+="<div class='ui-block-a'><label class='pad_buttons center' for='interval-"+m+"'>"+_("Repeat Every")+"</label><button class='pad_buttons' data-mini='true' name='interval-"+m+"' id='interval-"+m+"' value='"+60*f.interval+"'>"+dhms2str(sec2dhms(60*f.interval))+"</button></div>",l+="<div class='ui-block-b'><label class='pad_buttons center' for='repeat-"+m+"'>"+_("Repeat Count")+"</label><button class='pad_buttons' data-mini='true' name='repeat-"+m+"' id='repeat-"+m+"' value='"+f.repeat+"'>"+f.repeat+"</button></div>",l+="</div></div>",l+="<table style='width:100%;"+("object"==typeof f.start?"":"display:none")+"' id='input_stype_set-"+m+"'><tr><th class='center'>"+_("Enable")+"</th><th>"+_("Start Time")+"</th></tr>",e=1;4>e;e++)j=-1===h[e],l+="<tr><td data-role='controlgroup' data-type='horizontal' class='use_master center'><label for='ust_"+(e+1)+"'><input id='ust_"+(e+1)+"' type='checkbox' "+(j?"":"checked='checked'")+"></label></td>",l+="<td><button class='timefield' data-mini='true' type='time' id='start_"+(e+1)+"-"+m+"' value='"+(j?0:h[e])+"'>"+minutesToTime(j?0:h[e])+"</button></td></tr>";return l+="</table>",l+="</div></div>",b===!0||"new"===a?l+="<button data-mini='true' data-icon='check' data-theme='b' id='submit-"+m+"'>"+_("Save New Program")+"</button>":(l+="<button data-mini='true' data-icon='check' data-theme='b' id='submit-"+m+"'>"+_("Save Changes to")+" <span class='program-name'>"+f.name+"</span></button>",l+="<button data-mini='true' data-icon='arrow-r' id='run-"+m+"'>"+_("Run")+" <span class='program-name'>"+f.name+"</span></button>",l+="<button data-mini='true' data-icon='delete' class='bold red' data-theme='b' id='delete-"+m+"'>"+_("Delete")+" <span class='program-name'>"+f.name+"</span></button>"),g=$(l),g.find("input[name^='rad_days'],input[name^='stype']").on("change",function(){var a=$(this).val().split("-")[0].split("_");$("[id^='input_"+a[0]+"_']").hide(),$("#input_"+a[0]+"_"+a[1]+"-"+m).show()}),g.find("[id^='interval-']").on("click",function(){var a=$(this),b=g.find("label[for='"+a.attr("id")+"']").text();showDurationBox({seconds:a.val(),title:b,callback:function(b){a.val(b),a.text(dhms2str(sec2dhms(b)))},maximum:86340,granularity:1,preventCompression:!0})}),g.find(".timefield").on("click",function(){var a=$(this);showTimeInput({minutes:a.val(),title:_("Start Time"),callback:function(b){a.val(b),a.text(minutesToTime(b))}})}),g.find("[id^='repeat-']").on("click",function(){var a=$(this),b=g.find("label[for='"+a.attr("id")+"']").text();showSingleDurationInput({data:a.val(),title:b,label:_("Repeat Count"),callback:function(b){a.val(b).text(b)},maximum:1440})}),g.find("[id^=station_]").on("click",function(){var a=$(this),b=controller.stations.snames[a.attr("id").split("_")[1].split("-")[0]];showDurationBox({seconds:a.val(),title:b,callback:function(b){a.val(b),a.text(dhms2str(sec2dhms(b))),b>0?a.addClass("green"):a.removeClass("green")},maximum:65535})}),fixInputClick(g),g}function add_program(a){a=a>=0?a:"new";var b=$("<div data-role='page' id='addprogram'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false' data-hide-during-focus=''><h3>"+_("Add Program")+"</h3><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><button data-icon='check' disabled='disabled' class='submit ui-btn-right'>"+_("Submit")+"</button></div><div class='ui-content' role='main' id='newprogram'><fieldset id='program-new'></fieldset></div></div>"),c=function(){return submit_program("new"),!1};b.find("#program-new").html(make_program(a,!0)).one("change input",function(){b.find(".submit").prop("disabled",!1).addClass("hasChanges")}),b.find(".submit, [id^='submit-']").on("click",c),b.find(".ui-toolbar-back-btn").on("click",checkChangesBeforeBack),b.one("pagehide",function(){b.remove()}),$("#addprogram").remove(),b.appendTo("body")}function delete_program(a){areYouSure(_("Are you sure you want to delete program")+" "+(parseInt(a)+1)+"?","",function(){$.mobile.loading("show"),send_to_os("/dp?pw=&pid="+a).done(function(){$.mobile.loading("hide"),update_controller_programs(function(){changePage("#programs",{updatePrograms:!0,showLoadMsg:!1}),showerror(_("Program")+" "+(parseInt(a)+1)+" "+_("deleted"))})})})}function submit_program(a){$("#program-"+a).find(".hasChanges").removeClass("hasChanges"),checkOSVersion(210)?submit_program21(a):submit_program183(a)}function submit_program183(a){var b,c,d,e=[],f=[0,0],g=0,h=$("#en-"+a).is(":checked")?1:0;if(e[0]=h,$("#days_week-"+a).is(":checked")){for(b=$("#d-"+a).val(),b=null===b?[]:parseIntArray(b),c=0;7>c;c++)-1!==$.inArray(c,b)&&(f[0]|=1<<c);if(0===f[0])return void showerror(_("Error: You have not selected any days of the week."));"odd"===$("#days_rst-"+a).val()?(f[0]|=128,f[1]=1):"even"===$("#days_rst-"+a).val()&&(f[0]|=128,f[1]=0)}else if($("#days_n-"+a).is(":checked")){if(f[1]=parseInt($("#every-"+a).val(),10),!(f[1]>=2&&f[1]<=128))return void showerror(_("Error: Interval days must be between 2 and 128."));if(f[0]=parseInt($("#starting-"+a).val(),10),!(f[0]>=0&&f[0]<f[1]))return void showerror(_("Error: Starting in days wrong."));f[0]|=128}if(e[1]=f[0],e[2]=f[1],e[3]=parseInt($("#start-"+a).val()),e[4]=parseInt($("#end-"+a).val()),e[3]>e[4])return void showerror(_("Error: Start time must be prior to end time."));e[5]=parseInt($("#interval-"+a).val()/60);var i=$("[id^=station_][id$=-"+a+"]"),j=i.length,k=j/8;e[6]=parseInt($("#duration-"+a).val());var l,m,n=[0];for(l=0;k>l;l++)for(n[l]=0,d=0;8>d;d++)m=8*l+d,$("#station_"+m+"-"+a).is(":checked")&&(n[l]|=1<<d,g=1);return e=JSON.stringify(e.concat(n)),0===g?void showerror(_("Error: You have not selected any stations.")):($.mobile.loading("show"),void("new"===a?send_to_os("/cp?pw=&pid=-1&v="+e).done(function(){$.mobile.loading("hide"),update_controller_programs(function(){$.mobile.document.one("pageshow",function(){showerror(_("Program added successfully"))}),goBack()})}):send_to_os("/cp?pw=&pid="+a+"&v="+e).done(function(){$.mobile.loading("hide"),update_controller_programs(function(){update_program_header()}),showerror(_("Program has been updated"))})))}function submit_program21(a){var b,c,d,e,f=[],g=[0,0],h=[0,0,0,0],i=0,j=$("#en-"+a).is(":checked")?1:0,k=$("#uwt-"+a).is(":checked")?1:0,l=0;if(l|=j<<0,l|=k<<1,"odd"===$("#days_rst-"+a).val()?l|=4:"even"===$("#days_rst-"+a).val()&&(l|=8),$("#days_n-"+a).is(":checked")){if(l|=48,g[1]=parseInt($("#every-"+a).val(),10),!(g[1]>=2&&g[1]<=128))return void showerror(_("Error: Interval days must be between 2 and 128."));
if(g[0]=parseInt($("#starting-"+a).val(),10),!(g[0]>=0&&g[0]<g[1]))return void showerror(_("Error: Starting in days wrong."))}else if($("#days_week-"+a).is(":checked")){for(l|=0,b=$("#d-"+a).val(),b=null===b?[]:parseIntArray(b),c=0;7>c;c++)-1!==$.inArray(c,b)&&(g[0]|=1<<c);if(0===g[0])return void showerror(_("Error: You have not selected any days of the week."))}if($("#stype_repeat-"+a).is(":checked"))l|=0,h[0]=parseInt($("#start_1-"+a).val()),h[1]=parseInt($("#repeat-"+a).val()),h[2]=parseInt($("#interval-"+a).val()/60);else if($("#stype_set-"+a).is(":checked")){l|=64;var m=$("[id^='start_'][id$='-"+a+"']");m.each(function(a,b){var c=parseInt(b.value);(!c||a>0&&!$("#ust_"+(a+1)).is(":checked"))&&(c=-1),h[a]=c})}var n=$("[id^=station_][id$=-"+a+"]"),o=[];return n.each(function(a,b){var c=parseInt(b.value);parseInt(c)>0&&(i=1),o.push(c)}),f[0]=l,f[1]=g[0],f[2]=g[1],f[3]=h,f[4]=o,d=$("#name-"+a).val(),e="&v="+JSON.stringify(f)+"&name="+encodeURIComponent(d),0===i?void showerror(_("Error: You have not selected any stations.")):($.mobile.loading("show"),void("new"===a?send_to_os("/cp?pw=&pid=-1"+e).done(function(){$.mobile.loading("hide"),update_controller_programs(function(){$.mobile.document.one("pageshow",function(){showerror(_("Program added successfully"))}),goBack()})}):send_to_os("/cp?pw=&pid="+a+e).done(function(){$.mobile.loading("hide"),update_controller_programs(function(){update_program_header(),$("#program-"+a).find(".program-name").text(d)}),showerror(_("Program has been updated"))})))}function raindelay(a){return $.mobile.loading("show"),send_to_os("/cv?pw=&rd="+a/3600).done(function(){$.mobile.loading("hide"),showLoading("#footer-running"),$.when(update_controller_settings(),update_controller_status()).then(check_status),showerror(_("Rain delay has been successfully set"))}),!1}function getExportMethod(){var a=$("<div data-role='popup'><div class='ui-bar ui-bar-a'>"+_("Select Export Method")+"</div><div data-role='controlgroup' class='tight'><a class='ui-btn hidden fileMethod'>"+_("File")+"</a><a class='ui-btn pasteMethod'>"+_("Email")+"</a><a class='ui-btn localMethod'>"+_("Internal (within app)")+"</a></div></div>"),b=encodeURIComponent(JSON.stringify(controller)),c="Sprinklers Data Export on "+dateToString(new Date);isFileCapable&&a.find(".fileMethod").removeClass("hidden").attr({href:"data:text/json;charset=utf-8,"+b,download:"backup.json"}).on("click",function(){a.popup("close")});var d="mailto:?subject="+encodeURIComponent(c)+"&body="+b;a.find(".pasteMethod").attr("href",d).on("click",function(){window.open(d),a.popup("close")}),a.find(".localMethod").on("click",function(){a.popup("close"),storage.set({backup:JSON.stringify(controller)},function(){showerror(_("Backup saved on this device"))})}),a.one("popupafterclose",function(){a.popup("destroy").remove()}).enhanceWithin(),$(".ui-page-active").append(a),a.popup({history:!1,positionTo:$("#sprinklers-settings").find(".export_config")}).popup("open")}function getImportMethod(a){var b=function(){var a=$("<div data-role='popup' data-overlay-theme='b' id='paste_config'><p class='ui-bar'><textarea class='textarea' rows='10' placeholder='"+_("Paste your backup here")+"'></textarea><button data-mini='true' data-theme='b'>"+_("Import")+"</button></p></div>"),b=$.mobile.window.width();return a.find("button").on("click",function(){var b=a.find("textarea").val();if(""!==b)try{b=JSON.parse($.trim(b)),a.popup("close"),import_config(b)}catch(c){a.find("textarea").val(""),showerror(_("Unable to read the configuration file. Please check the file and try again."))}}),a.css("width",b>600?.4*b+"px":"100%").one("popupafterclose",function(){a.popup("destroy").remove()}).enhanceWithin(),$(".ui-page-active").append(a),a.popup({history:!1,positionTo:"window"}).popup("open"),!1},c=$("<div data-role='popup'><div class='ui-bar ui-bar-a'>"+_("Select Import Method")+"</div><div data-role='controlgroup' class='tight'><button class='hidden fileMethod'>"+_("File")+"</button><button class='pasteMethod'>"+_("Email (copy/paste)")+"</button><button class='hidden localMethod'>"+_("Internal (within app)")+"</button></div></div>");if(isFileCapable)c.find(".fileMethod").removeClass("hidden").on("click",function(){c.popup("close");var a=$("<input type='file' id='configInput' data-role='none' style='visibility:hidden;position:absolute;top:-50px;left:-50px'/>").on("change",function(){var a=this.files[0],b=new FileReader;"object"==typeof a&&(b.onload=function(a){try{var b=JSON.parse($.trim(a.target.result));import_config(b)}catch(c){showerror(_("Unable to read the configuration file. Please check the file and try again."))}},b.readAsText(a))});return a.appendTo("#sprinklers-settings"),a.click(),!1});else if(!a)return void b();c.find(".pasteMethod").on("click",function(){return c.popup("close"),b(),!1}),a&&c.find(".localMethod").removeClass("hidden").on("click",function(){return c.popup("close"),import_config(JSON.parse(a)),!1}),c.one("popupafterclose",function(){c.popup("destroy").remove()}).enhanceWithin(),$(".ui-page-active").append(c),c.popup({history:!1,positionTo:$("#sprinklers-settings").find(".import_config")}).popup("open")}function import_config(a){var b={1:"tz",2:"ntp",12:"htp",13:"htp2",14:"ar",15:"nbrd",16:"seq",17:"sdt",18:"mas",19:"mton",20:"mtoff",21:"urs",22:"rst",23:"wl",25:"ipas",30:"rlp",36:"lg",31:"uwt"},c={tz:1,ntp:2,dhcp:3,hp0:12,hp1:13,ar:14,ext:15,seq:16,sdt:17,mas:18,mton:19,mtof:20,urs:21,rso:22,wl:23,ipas:25,devid:26,rlp:30,lg:36,uwt:31,ntp1:32,ntp2:33,ntp3:34,ntp4:35};return"object"==typeof a&&a.settings?void areYouSure(_("Are you sure you want to restore the configuration?"),"",function(){$.mobile.loading("show");var d,e,f,g,h="/cs?pw=",i="/co?pw=",j="/cp?pw=",k=isOSPi();for(d in a.options)if(a.options.hasOwnProperty(d)&&c.hasOwnProperty(d)){if(e=c[d],-1!==$.inArray(e,[2,14,16,21,22,25,36])&&0===a.options[d])continue;if(3===e){checkOSVersion(210)&&1===controller.options.dhcp&&(i+="&o3=1");continue}if(k){if(e=b[e],void 0===e)continue}else e=e;f=checkOSVersion(208)===!0&&"string"==typeof a.options[d]?a.options[d].replace(/\s/g,"_"):a.options[d],i+="&o"+e+"="+f}for(!k&&"number"==typeof a.options.fwv&&a.options.fwv<211&&checkOSVersion(211)&&(i+="&o36=1"),i+="&"+(k?"o":"")+"loc="+a.settings.loc,d=0;d<a.stations.snames.length;d++)g=checkOSVersion(208)===!0?a.stations.snames[d].replace(/\s/g,"_"):a.stations.snames[d],h+="&s"+d+"="+g;for(d=0;d<a.stations.masop.length;d++)h+="&m"+d+"="+a.stations.masop[d];if("object"==typeof a.stations.ignore_rain)for(d=0;d<a.stations.ignore_rain.length;d++)h+="&i"+d+"="+a.stations.ignore_rain[d];if("object"==typeof a.stations.stn_dis)for(d=0;d<a.stations.stn_dis.length;d++)h+="&d"+d+"="+a.stations.stn_dis[d];if("object"==typeof a.stations.stn_seq)for(d=0;d<a.stations.stn_seq.length;d++)h+="&q"+d+"="+a.stations.stn_seq[d];else if(!k&&"number"==typeof a.options.fwv&&a.options.fwv<211&&!checkOSVersion(211)){var l;for(l=0;l<a.settings.nbrd;l++)h+="&q"+l+"="+(1===a.options.seq?255:0)}if("object"==typeof a.stations.act_relay)for(d=0;d<a.stations.act_relay.length;d++)h+="&a"+d+"="+a.stations.act_relay[d];$.when(send_to_os(i),send_to_os(h),send_to_os("/dp?pw=&pid=-1"),$.each(a.programs.pd,function(b,c){var d="";if(k&&"number"==typeof a.options.fwv&&a.options.fwv>=210)return showerror(_("Program data is newer than the device firmware and cannot be imported")),!1;if(!k&&"number"==typeof a.options.fwv&&a.options.fwv>=210&&!checkOSVersion(210))return showerror(_("Program data is newer than the device firmware and cannot be imported")),!1;if(!k&&"number"==typeof a.options.fwv&&a.options.fwv>=210&&checkOSVersion(210)&&(d="&name="+c[5],c=c.slice(0,5)),!k&&"number"==typeof a.options.fwv&&a.options.fwv<210&&checkOSVersion(210)){var e,f,g,h=read_program183(c),i=c.length-7,l=[],m=0;for(m|=h.en<<0,m|=h.is_even?8:h.is_odd?4:0,m|=h.is_interval?48:0,m|=0,c[0]=m,f=0;i>f;f++)for(e=c[7+f],g=0;8>g;g++)l.push(e&1<<g?h.duration:0);c[3]=[h.start,parseInt((h.end-h.start)/h.interval),h.interval,0],c[4]=l,c=c.slice(0,5),d="&name="+_("Program")+" "+(b+1)}send_to_os(j+"&pid=-1&v="+JSON.stringify(c)+d)})).then(function(){update_controller(function(){$.mobile.loading("hide"),showerror(_("Backup restored to your device")),update_weather(),goHome()},function(){$.mobile.loading("hide"),network_fail()})},function(){$.mobile.loading("hide"),showerror(_("Unable to import configuration."))})}):void showerror(_("Invalid configuration"))}function show_about(){var a=$("<div data-role='page' id='about'><div data-theme='b' data-role='header' data-position='fixed' data-tap-toggle='false'><a href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left ui-btn-b ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-rel='back'>"+_("Back")+"</a><h3>"+_("About")+"</h3></div><div class='ui-content' role='main'><ul data-role='listview' data-inset='true'><li><p>"+_("User manual for OpenSprinkler is available at")+" <a class='iab' target='_blank' href='https://opensprinkler.freshdesk.com/support/solutions/folders/5000147083'>https://support.opensprinkler.com</a></p></li></ul><ul data-role='listview' data-inset='true'><li><p>"+_("This is open source software: source code and changelog for this application can be found at")+" <a class='iab squeeze' target='_blank' href='https://github.com/salbahra/Sprinklers/'>https://github.com/salbahra/Sprinklers/</a></p><p>"+_("Language localization is crowdsourced using Get Localization available at")+" <a class='iab squeeze' target='_blank' href='http://www.getlocalization.com/Sprinklers/'>http://www.getlocalization.com/Sprinklers/</a></p></li></ul><p class='smaller'>"+_("App Version")+": 1.2.6"+("undefined"!=typeof controller.options.hwv?"<br>"+_("Hardware Version")+": v"+getHWVersion():"")+"<br>"+_("Firmware")+": "+getOSVersion()+"</p></div></div>");a.one("pagehide",function(){a.remove()}),$("#about").remove(),a.appendTo("body")}function isRunning(){for(var a=0;a<controller.status.length;a++)if(controller.status[a]>0)return a;return-1}function stopStations(a){$.mobile.loading("show"),send_to_os("/cv?pw=&rsn=1").done(function(){setTimeout(function(){$.mobile.loading("hide"),a()},1e3)})}function isOSPi(){return controller&&"string"==typeof controller.options.fwv&&-1!==controller.options.fwv.search(/ospi/i)?!0:!1}function checkWeatherPlugin(){var a=$(".weather_settings"),b=$(".show-providers");curr_wa=[],a.hide(),isOSPi()?storage.get("provider",function(c){send_to_os("/wj?pw=","json").done(function(d){var e=d.weather_provider;"string"!=typeof e||"yahoo"!==e&&"wunderground"!==e||(c.provider!==e&&(storage.set({provider:e,wapikey:d.wapikey}),update_weather()),b.hide()),"string"==typeof d.auto_delay&&(curr_wa=d,a.css("display",""))})}):checkOSVersion(210)?b.hide():b.css("display","")}function checkOSPiVersion(a){var b;return isOSPi()?(b=controller.options.fwv.split("-")[0],b!==a?(b=b.split("."),a=a.split("."),versionCompare(b,a)):!0):!1}function checkOSVersion(a){return isOSPi()?!1:a===controller.options.fwv?!0:versionCompare(controller.options.fwv.toString().split(""),a.toString().split(""))}function versionCompare(a,b){for(var c,d=Math.max(a.length,b.length);a.length<d;)a.push(0);for(;b.length<d;)b.push(0);for(var e=0;d>e&&(c=Math.max(-1,Math.min(1,a[e]-b[e])),0===c);e++);return-1===c&&(c=!1),c}function getOSVersion(a){return a||"object"!=typeof controller.options||(a=controller.options.fwv),"string"==typeof a&&-1!==a.search(/ospi/i)?a:(a/100>>0)+"."+(a/10>>0)%10+"."+a%10}function getHWVersion(a){if(!a){if("object"!=typeof controller.options||"undefined"==typeof controller.options.hwv)return!1;a=controller.options.hwv}return"string"==typeof a?a:(a/10>>0)%10+"."+a%10}function areYouSure(a,b,c,d){$("#sure").popup("destroy").remove(),c=c||function(){},d=d||function(){};var e=$("<div data-role='popup' data-overlay-theme='b' id='sure'><h3 class='sure-1 center'>"+a+"</h3><p class='sure-2 center'>"+b+"</p><a class='sure-do ui-btn ui-btn-b ui-corner-all ui-shadow' href='#'>"+_("Yes")+"</a><a class='sure-dont ui-btn ui-corner-all ui-shadow' href='#'>"+_("No")+"</a></div>");e.find(".sure-do").one("click.sure",function(){return $("#sure").popup("close"),c(),!1}),e.find(".sure-dont").one("click.sure",function(){return $("#sure").popup("close"),d(),!1}),e.one("popupafterclose",function(){$(this).popup("destroy").remove()}).enhanceWithin(),$(".ui-page-active").append(e),$("#sure").popup({history:!1,positionTo:"window"}).popup("open")}function showIPRequest(a){var b={title:_("Enter IP Address"),ip:[0,0,0,0],showBack:!0,callback:function(){}};a=$.extend({},b,a),$("#ipInput").popup("destroy").remove();var c=$("<div data-role='popup' id='ipInput' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+a.title+"</h1></div><div class='ui-content'><span><fieldset class='ui-grid-c incr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-d'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div></fieldset><div class='ui-grid-c inputs'><div class='ui-block-a'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+a.ip[0]+"'></div><div class='ui-block-b'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+a.ip[1]+"'></div><div class='ui-block-c'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+a.ip[2]+"'></div><div class='ui-block-d'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+a.ip[3]+"'></div></div><fieldset class='ui-grid-c decr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-d'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div></fieldset></span>"+(a.showBack?"<button class='submit' data-theme='b'>"+_("Submit")+"</button>":"")+"</div></div>"),d=function(b,d){var f=c.find(".inputs input").eq(b),g=parseInt(f.val());-1===d&&0===g||1===d&&g>=255||(f.val(g+d),a.callback(e()))},e=function(){return $.makeArray(c.find(".ip_addr").map(function(){return parseInt($(this).val())}))};c.find("button.submit").on("click",function(){a.callback(e()),c.popup("destroy").remove()}),c.on("focus","input[type='number']",function(){this.value=""}).on("blur","input[type='number']",function(){""===this.value&&(this.value="0")}),holdButton(c.find(".incr").children(),function(a){var b=$(a.currentTarget).index();return d(b,1),!1}),holdButton(c.find(".decr").children(),function(a){var b=$(a.currentTarget).index();return d(b,-1),!1}),$(".ui-page-active").append(c),c.css("max-width","350px").popup({history:!1,positionTo:"window"}).one("popupafterclose",function(){a.callback(e()),$(this).popup("destroy").remove()}).enhanceWithin().popup("open")}function showDurationBox(a){var b={seconds:0,title:_("Duration"),granularity:0,preventCompression:!1,incrementalUpdate:!0,showBack:!0,minimum:0,callback:function(){}};a=$.extend({},b,a),$("#durationBox").popup("destroy").remove();var c,d=["days","hours","minutes","seconds"],e=[_("Days"),_("Hours"),_("Minutes"),_("Seconds")],f=[86400,3600,60,1],g=[0,23,59,59],h=4-a.granularity,i=0,j=sec2dhms(a.seconds);if(a.seconds=parseInt(a.seconds),!a.preventCompression&&checkOSVersion(210)&&a.maximum>64800&&(a.maximum=64800),a.maximum)for(c=f.length-1;c>=0;c--)if(a.maximum<f[c]){i=c+1,h=f.length-i-a.granularity;break}var k="<fieldset class='ui-grid-"+String.fromCharCode(95+h)+" incr'>",l="<div class='ui-grid-"+String.fromCharCode(95+h)+" inputs'>",m="<fieldset class='ui-grid-"+String.fromCharCode(95+h)+" decr'>",n=$("<div data-role='popup' id='durationBox' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+a.title+"</h1></div><div class='ui-content'>"+(a.helptext?"<p class='pad-top rain-desc center smaller'>"+a.helptext+"</p>":"")+"<span></span>"+(a.showBack?"<button class='submit' data-theme='b'>"+_("Submit")+"</button>":"")+"</div></div>"),o=function(b,c){var d=n.find(".inputs input").eq(b),e=b+i,h=parseInt(d.val());if(!(d.prop("disabled")||-1===c&&p()<=a.minimum||1===c&&p()+f[e]>a.maximum||(0!==g[e]&&0!==b&&Math.abs(h)>=g[e]&&(d.val(0),d=n.find(".inputs input").eq(b-1),h=parseInt(d.val())),d.val(h+c),a.incrementalUpdate&&a.callback(p()),a.preventCompression||!checkOSVersion(210)))){var j=1===c?!0:!1;1===c?(p()>=60&&q("seconds",j),p()>=10800&&q("minutes",j)):-1===c&&(p()<=-60?q("seconds",!j):p()<=-10800?q("minutes",!j):p()<60?q("seconds",j):p()<10800&&q("minutes",j))}},p=function(){return dhms2sec({days:parseInt(n.find(".days").val())||0,hours:parseInt(n.find(".hours").val())||0,minutes:parseInt(n.find(".minutes").val())||0,seconds:parseInt(n.find(".seconds").val())||0})},q=function(a,b){n.find("."+a).toggleClass("ui-state-disabled",b).prop("disabled",b).val(function(){return b?0:this.value}).parent(".ui-input-text").toggleClass("ui-state-disabled",b)};for(c=i;c<f.length-a.granularity;c++)k+="<div "+(h>1?"class='ui-block-"+String.fromCharCode(97+c-i)+"'":"")+"><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>",l+="<div "+(h>1?"class='ui-block-"+String.fromCharCode(97+c-i)+"'":"")+"><label class='center'>"+_(e[c])+"</label><input data-wrapper-class='pad_buttons' class='"+d[c]+"' type='number' pattern='[0-9]*' value='"+j[d[c]]+"'></div>",m+="<div "+(h>1?"class='ui-block-"+String.fromCharCode(97+c-i)+"'":"")+"><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>";k+="</fieldset>",l+="</div>",m+="</fieldset>",n.find("span").prepend(k+l+m),n.find("button.submit").on("click",function(){a.callback(p()),n.popup("destroy").remove()}),!a.preventCompression&&checkOSVersion(210)&&(a.seconds<=-60&&q("seconds",!0),a.seconds<=-10800&&q("minutes",!0),a.seconds>=60&&q("seconds",!0),a.seconds>=10800&&q("minutes",!0)),n.on("focus","input[type='number']",function(){this.value=""}).on("blur","input[type='number']",function(){""===this.value&&(this.value="0")}),holdButton(n.find(".incr").children(),function(a){var b=$(a.currentTarget).index();return o(b,1),!1}),holdButton(n.find(".decr").children(),function(a){var b=$(a.currentTarget).index();return o(b,-1),!1}),$(".ui-page-active").append(n),n.css("max-width","350px").popup({history:!1,positionTo:"window"}).one("popupafterclose",function(){a.incrementalUpdate&&a.callback(p()),$(this).popup("destroy").remove()}).enhanceWithin().popup("open")}function showSingleDurationInput(a){$("#singleDuration").popup("destroy").remove();var b={data:0,title:_("Duration"),minimum:0,label:"",updateOnChange:!0,showBack:!0,callback:function(){}};a=$.extend({},b,a);var c=$("<div data-role='popup' id='singleDuration' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+a.title+"</h1></div><div class='ui-content'>"+(a.helptext?"<p class='pad-top rain-desc center smaller'>"+a.helptext+"</p>":"")+"<label class='center'>"+a.label+"</label><div class='input_with_buttons'><button class='decr ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input type='number' pattern='[0-9]*' value='"+a.data+"'><button class='incr ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div>"+(a.updateOnChange&&!a.showBack?"":"<input type='submit' data-theme='b' value='"+_("Submit")+"'>")+"</div></div>"),d=c.find("input"),e=function(b){var c=parseInt(d.val());-1===b&&c===a.minimum||1===b&&c===a.maximum||(d.val(c+b),a.updateOnChange&&a.callback(c+b))};holdButton(c.find(".incr"),function(){return e(1),!1}),holdButton(c.find(".decr"),function(){return e(-1),!1}),c.find("input[type='number']").on("focus",function(){this.value=""}).on("blur",function(){""===this.value&&(this.value="0")}),c.find("input[type='submit']").on("click",function(){a.callback(d.val()),c.popup("destroy").remove()}),$(".ui-page-active").append(c),c.popup({history:!1,positionTo:"window"}).one("popupafterclose",function(){a.updateOnChange&&a.callback(d.val()),c.popup("destroy").remove()}).enhanceWithin().popup("open")}function showDateTimeInput(a,b){$("#datetimeInput").popup("destroy").remove(),a instanceof Date||(a=new Date(1e3*a),a.setMinutes(a.getMinutes()-a.getTimezoneOffset())),b=b||function(){};var c=["Month","Date","FullYear","Hours","Minutes"],d=[_("Jan"),_("Feb"),_("Mar"),_("Apr"),_("May"),_("Jun"),_("Jul"),_("Aug"),_("Sep"),_("Oct"),_("Nov"),_("Dec")],e=$("<div data-role='popup' id='datetimeInput' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+_("Enter Date/Time")+"</h1></div><div class='ui-content'></div></div>"),f=function(c,d){a["setUTC"+c](a["getUTC"+c]()+d),b(new Date(a.getTime())),g()},g=function(){var b,g,h,i="<fieldset class='ui-grid-d incr'>",j="<div class='ui-grid-d inputs'>",k="<fieldset class='ui-grid-d decr'>";for(h=0;5>h;h++)b=a["getUTC"+c[h]](),g="",b="Month"===c[h]?"<p class='center'>"+d[b]+"</p>":"Date"===c[h]?"<p class='center'>"+b+",</p>":"Hours"===c[h]?"<p style='width:90%;display:inline-block' class='center'>"+b+"</p><p style='display:inline-block'>:</p>":"<p class='center'>"+b+"</p>",i+="<div class='ui-block-"+String.fromCharCode(97+h)+"'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>",j+="<div id='"+c[h]+"' class='ui-block-"+String.fromCharCode(97+h)+"'>"+b+"</div>",k+="<div class='ui-block-"+String.fromCharCode(97+h)+"'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>";i+="</fieldset>",j+="</div>",k+="</fieldset>",e.find(".ui-content").html("<span>"+i+j+k+"</span>").enhanceWithin(),e.find(".incr").children().on("vclick",function(){var a=$(this).index();return f(e.find(".inputs").children().eq(a).attr("id"),1),!1}),e.find(".decr").children().on("vclick",function(){var a=$(this).index();return f(e.find(".inputs").children().eq(a).attr("id"),-1),!1})};g(),$(".ui-page-active").append(e),e.css("width","280px").popup({history:!1,positionTo:"window"}).one("popupafterclose",function(){b(a),e.popup("destroy").remove()}).enhanceWithin().popup("open")}function showTimeInput(a){var b={minutes:0,title:_("Time"),incrementalUpdate:!0,showBack:!0,callback:function(){}};a=$.extend({},b,a),$("#timeInput").popup("destroy").remove();var c=a.minutes>719?!0:!1,d=function(){return _(c?"PM":"AM")},e=$("<div data-role='popup' id='timeInput' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+a.title+"</h1></div><div class='ui-content'>"+(a.helptext?"<p class='pad-top rain-desc center smaller'>"+a.helptext+"</p>":"")+"<span><fieldset class='ui-grid-b incr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div></fieldset><div class='ui-grid-b inputs'><div class='ui-block-a'><input data-wrapper-class='pad_buttons' class='hour' type='number' pattern='[0-9]*' value='"+(parseInt(a.minutes/60)%12===0?12:parseInt(a.minutes/60)%12)+"'></div><div class='ui-block-b'><input data-wrapper-class='pad_buttons' class='minute' type='number' pattern='[0-9]*' value='"+pad(a.minutes%60)+"'></div><div class='ui-block-c'><p class='center period'>"+d()+"</p></div></div><fieldset class='ui-grid-b decr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div></fieldset></span>"+(a.showBack?"<button class='submit' data-theme='b'>"+_("Submit")+"</button>":"")+"</div></div>"),f=function(b,f){if(0===b||1===b){var h=g(),i=h+f*(0===b?60:1),j=e.find(".inputs input").eq(b),k=j.hasClass("hour"),l=parseInt(j.val());if(1===f){if(k&&l>=12&&(l=0),!k&&l>=59){l=-1;var m=e.find(".hour"),n=parseInt(m.val());12===n&&(n=0),m.val(n+1)}}else if(k&&1>=l)l=13;else if(!k&&0>=l)return;(!c&&i>719||c&&721>i||c&&i>1439||!c&&-1===f&&0>i)&&(c=!c,e.find(".period").text(d())),l=k?l+f:pad(l+f),j.val(l)}else 2===b&&(c=!c,e.find(".period").text(d()));a.incrementalUpdate&&a.callback(g())},g=function(){var a=parseInt(e.find(".hour").val());return c&&12!==a&&(a+=12),c||12!==a||(a=0),60*a+parseInt(e.find(".minute").val())};e.find("button.submit").on("click",function(){a.callback(g()),e.popup("destroy").remove()}),e.on("focus","input[type='number']",function(){this.value=""}).on("blur","input[type='number']",function(){var a=parseInt(this.value)||0;this.value=$(this).hasClass("hour")?a:pad(a)}),holdButton(e.find(".incr").children(),function(a){var b=$(a.currentTarget).index();return f(b,1),!1}),holdButton(e.find(".decr").children(),function(a){var b=$(a.currentTarget).index();return f(b,-1),!1}),$(".ui-page-active").append(e),e.css("max-width","350px").popup({history:!1,positionTo:"window"}).one("popupafterclose",function(){a.incrementalUpdate&&a.callback(g()),$(this).popup("destroy").remove()}).enhanceWithin().popup("open")}function changePage(a,b){b=b||{},0!==a.indexOf("#")&&(a="#"+a),$.mobile.pageContainer.pagecontainer("change",a,b)}function changeFromPanel(a,b){b=b||{};var c=$("#sprinklers-settings");c.one("panelclose",function(){changePage(a,b)}),c.panel("close")}function showTooltip(a,b,c,d){$("#tooltip").remove(),$("<div id='tooltip'>"+c+"</div>").css({position:"absolute",display:"none",top:b+5,left:a+5,padding:"2px","text-shadow":"none","background-color":d,color:colorContrast(d),opacity:.8}).appendTo("body").fadeIn(200)}function colorContrast(a){var b=a.match(/rgb\((\d+),(\d+),(\d+)\)/),c=Math.round((299*parseInt(b[1])+587*parseInt(b[2])+114*parseInt(b[3]))/1e3);return c>125?"black":"white"}function showLoading(a){a="string"==typeof a?$(a):a,a.off("click").html("<p class='ui-icon ui-icon-loading mini-load'></p>")}function goHome(){if("sprinklers"!==$.mobile.pageContainer.pagecontainer("getActivePage").attr("id")){$.mobile.document.one("pageshow",function(){delete $.mobile.navigate.history.getActive().transition});var a={firstLoad:!0,showLoading:!1,transition:"none"};$("#sprinklers-settings").hasClass("ui-panel-open")?changeFromPanel("#sprinklers",a):changePage("#sprinklers",a)}}function goBack(){var a=$(".ui-page-active").attr("id"),b="site-control"===a&&$.isEmptyObject(controller),c=$(".ui-popup-active");if(c.length)return void c.find("[data-role='popup']").popup("close");if("sprinklers"===a||"start"===a||b)try{navigator.app.exitApp()}catch(d){}else if(isChromeApp){var e=$.mobile.navigate.history.getPrev().url;if("#"!==e.slice(0,1))return;changePage(e),$.mobile.document.one("pagehide",function(){$.mobile.navigate.history.activeIndex-=2})}else $.mobile.back()}function checkChangesBeforeBack(){var a=$(".ui-page-active"),b=a.find(".hasChanges");return 0!==b.length?(areYouSure(_("Do you want to save your changes?"),"",function(){b.click(),goBack()},goBack),!1):void goBack()}function showerror(a,b){b=b||2500,clearTimeout(errorTimeout),$.mobile.loading("show",{text:a,textVisible:!0,textonly:!0,theme:"b"}),errorTimeout=setTimeout(function(){$.mobile.loading("hide")},b)}function fixInputClick(a){FastClick.notNeeded(document.body)||(a.find("input[type='checkbox']:not([data-role='flipswitch']),.ui-select > .ui-btn").addClass("needsclick"),a.find(".ui-collapsible-heading-toggle").on("click",function(){var a=$(this);setTimeout(function(){a.removeClass("ui-btn-active")},100)}))}function holdButton(a,b){var c;a.on("tap",b).on("taphold",function(a){c=setInterval(function(){b(a)},100)}).on("vmouseup vmouseout vmousecancel touchend",function(){clearInterval(c)}).on("touchmove",function(a){a.preventDefault()})}function insertStyle(a){var b=document.createElement("style");b.innerHTML=a,document.head.appendChild(b)}function parseIntArray(a){for(var b=0;b<a.length;b++)a[b]=+a[b];return a}function sec2hms(a){var b="",c=Math.max(0,parseInt(a/3600)%24),d=Math.max(0,parseInt(a/60)%60),e=a%60;return c&&(b+=pad(c)+":"),b+pad(d)+":"+pad(e)}function sec2dhms(a){var b=0>a?-1:1;return a=Math.abs(a),{days:Math.max(0,parseInt(a/86400))*b,hours:Math.max(0,parseInt(a%86400/3600))*b,minutes:Math.max(0,parseInt(a%86400%3600/60))*b,seconds:Math.max(0,parseInt(a%86400%3600%60))*b}}function dhms2str(a){var b="";return a.days&&(b+=a.days+_("d")+" "),a.hours&&(b+=a.hours+_("h")+" "),a.minutes&&(b+=a.minutes+_("m")+" "),a.seconds&&(b+=a.seconds+_("s")+" "),""===b&&(b="0"+_("s")),b.trim()}function dhms2sec(a){return parseInt(86400*a.days+3600*a.hours+60*a.minutes+a.seconds)}function exportObj(a,b,c){if(b=encodeURIComponent(JSON.stringify(b)),isFileCapable)$(a).attr({href:"data:text/json;charset=utf-8,"+b,download:"backup.json"});else{c=c||"Sprinklers Data Export on "+dateToString(new Date);var d="mailto:?subject="+encodeURIComponent(c)+"&body="+b;$(a).attr("href",d).on("click",function(){return window.open(d),!1})}}function getDayName(a,b){var c=[_("Sunday"),_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday")],d=[_("Sun"),_("Mon"),_("Tue"),_("Wed"),_("Thu"),_("Fri"),_("Sat")];return"short"===b?d[a.getDay()]:c[a.getDay()]}function getUnique(a){for(var b=[],c=0;c<a.length;c++)-1===$.inArray(a[c],b)&&b.push(a[c]);return b}function pad(a){var b=String(a);return 1===b.length&&(b="0"+b),b}function htmlEscape(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function _(a){if("object"==typeof language&&language.hasOwnProperty(a)){var b=language[a];return b?b:a}return a}function set_lang(){$("[data-translate]").text(function(){var a=$(this),b=a.data("translate");return a.is("input[type='submit']")?(a.val(_(b)),void(a.parent("div.ui-btn").length>0&&a.button("refresh"))):_(b)}),$(".ui-toolbar-back-btn").text(_("Back")),check_curr_lang()}function update_lang(a){var b="";return language={},"undefined"==typeof a?void storage.get("lang",function(a){var b=a.lang||navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||"en";update_lang(b.substring(0,2))}):(storage.set({lang:a}),"en"===a?void set_lang():(curr_local&&(b=$.mobile.path.parseUrl($("head").find("script").eq(0).attr("src")).hrefNoHash.slice(0,-10)),void $.getJSON(b+"locale/"+a+".js",function(a){language=a.messages,set_lang()}).fail(set_lang)))}function languageSelect(){$("#localization").popup("destroy").remove();var a="<div data-role='popup' data-overlay-theme='b' id='localization' data-corners='false'><ul data-inset='true' data-role='listview' id='lang' data-corners='false'><li data-role='list-divider' data-theme='b' class='center' data-translate='Localization'>"+_("Localization")+"</li>",b={af:"Afrikaans",am:"Amharic",zh:"Chinese",cs:"Czech",nl:"Dutch",en:"English",fr:"French",de:"German",he:"Hebrew",hu:"Hungarian",it:"Italian",mn:"Mongolian",no:"Norwegian",pl:"Polish",pt:"Portuguese",sk:"Slovak",sl:"Slovenian",es:"Spanish"};
$.each(b,function(b,c){a+="<li><a href='#' data-translate='"+c+"' data-lang-code='"+b+"'>"+_(c)+"</a></li>"}),a+="</ul></div>",a=$(a),a.find("a").on("click",function(){var a=$(this),b=a.data("lang-code");update_lang(b)}),$(".ui-page-active").append(a),a.popup({history:!1,positionTo:"window"}).one("popupafterclose",function(){a.popup("destroy").remove()}).enhanceWithin().popup("open")}function check_curr_lang(){storage.get("lang",function(a){var b=$("#localization");b.find("a").each(function(b,c){var d=$(c);d.data("lang-code")===a.lang?d.removeClass("ui-icon-carat-r").addClass("ui-icon-check"):d.removeClass("ui-icon-check").addClass("ui-icon-carat-r")}),b.find("li.ui-last-child").removeClass("ui-last-child")})}function minutesToTime(a){var b=a>719?"PM":"AM",c=parseInt(a/60)%12;return 0===c&&(c=12),c+":"+pad(a%60)+" "+b}function dateToString(a,b){var c=$("#localization").find(".ui-icon-check").data("langCode"),d=[_("Sun"),_("Mon"),_("Tue"),_("Wed"),_("Thr"),_("Fri"),_("Sat")],e=[_("Jan"),_("Feb"),_("Mar"),_("Apr"),_("May"),_("Jun"),_("Jul"),_("Aug"),_("Sep"),_("Oct"),_("Nov"),_("Dec")];return b!==!1&&a.setMinutes(a.getMinutes()+a.getTimezoneOffset()),"de"===c?pad(a.getDate())+"."+pad(a.getMonth())+"."+a.getFullYear()+" "+pad(a.getHours())+":"+pad(a.getMinutes())+":"+pad(a.getSeconds()):d[a.getDay()]+", "+pad(a.getDate())+" "+e[a.getMonth()]+" "+a.getFullYear()+" "+pad(a.getHours())+":"+pad(a.getMinutes())+":"+pad(a.getSeconds())}!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b=a.length,c=_.type(a);return"function"===c||_.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a,b,c){if(_.isFunction(b))return _.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return _.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(hb.test(b))return _.filter(b,a,c);b=_.filter(b,a)}return _.grep(a,function(a){return U.call(b,a)>=0!==c})}function e(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function f(a){var b=ob[a]={};return _.each(a.match(nb)||[],function(a,c){b[c]=!0}),b}function g(){Z.removeEventListener("DOMContentLoaded",g,!1),a.removeEventListener("load",g,!1),_.ready()}function h(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=_.expando+Math.random()}function i(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(ub,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:tb.test(c)?_.parseJSON(c):c}catch(e){}sb.set(a,b,c)}else c=void 0;return c}function j(){return!0}function k(){return!1}function l(){try{return Z.activeElement}catch(a){}}function m(a,b){return _.nodeName(a,"table")&&_.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function n(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function o(a){var b=Kb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function p(a,b){for(var c=0,d=a.length;d>c;c++)rb.set(a[c],"globalEval",!b||rb.get(b[c],"globalEval"))}function q(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(rb.hasData(a)&&(f=rb.access(a),g=rb.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)_.event.add(b,e,j[e][c])}sb.hasData(a)&&(h=sb.access(a),i=_.extend({},h),sb.set(b,i))}}function r(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&_.nodeName(a,b)?_.merge([a],c):c}function s(a,b){var c=b.nodeName.toLowerCase();"input"===c&&yb.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}function t(b,c){var d,e=_(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:_.css(e[0],"display");return e.detach(),f}function u(a){var b=Z,c=Ob[a];return c||(c=t(a,b),"none"!==c&&c||(Nb=(Nb||_("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Nb[0].contentDocument,b.write(),b.close(),c=t(a,b),Nb.detach()),Ob[a]=c),c}function v(a,b,c){var d,e,f,g,h=a.style;return c=c||Rb(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||_.contains(a.ownerDocument,a)||(g=_.style(a,b)),Qb.test(g)&&Pb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function w(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function x(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=Xb.length;e--;)if(b=Xb[e]+c,b in a)return b;return d}function y(a,b,c){var d=Tb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function z(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=_.css(a,c+wb[f],!0,e)),d?("content"===c&&(g-=_.css(a,"padding"+wb[f],!0,e)),"margin"!==c&&(g-=_.css(a,"border"+wb[f]+"Width",!0,e))):(g+=_.css(a,"padding"+wb[f],!0,e),"padding"!==c&&(g+=_.css(a,"border"+wb[f]+"Width",!0,e)));return g}function A(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Rb(a),g="border-box"===_.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=v(a,b,f),(0>e||null==e)&&(e=a.style[b]),Qb.test(e))return e;d=g&&(Y.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+z(a,b,c||(g?"border":"content"),d,f)+"px"}function B(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=rb.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&xb(d)&&(f[g]=rb.access(d,"olddisplay",u(d.nodeName)))):(e=xb(d),"none"===c&&e||rb.set(d,"olddisplay",e?c:_.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function C(a,b,c,d,e){return new C.prototype.init(a,b,c,d,e)}function D(){return setTimeout(function(){Yb=void 0}),Yb=_.now()}function E(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=wb[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function F(a,b,c){for(var d,e=(cc[b]||[]).concat(cc["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function G(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},n=a.style,o=a.nodeType&&xb(a),p=rb.get(a,"fxshow");c.queue||(h=_._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,_.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],j=_.css(a,"display"),k="none"===j?rb.get(a,"olddisplay")||u(a.nodeName):j,"inline"===k&&"none"===_.css(a,"float")&&(n.display="inline-block")),c.overflow&&(n.overflow="hidden",l.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],$b.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(o?"hide":"show")){if("show"!==e||!p||void 0===p[d])continue;o=!0}m[d]=p&&p[d]||_.style(a,d)}else j=void 0;if(_.isEmptyObject(m))"inline"===("none"===j?u(a.nodeName):j)&&(n.display=j);else{p?"hidden"in p&&(o=p.hidden):p=rb.access(a,"fxshow",{}),f&&(p.hidden=!o),o?_(a).show():l.done(function(){_(a).hide()}),l.done(function(){var b;rb.remove(a,"fxshow");for(b in m)_.style(a,b,m[b])});for(d in m)g=F(o?p[d]:0,d,l),d in p||(p[d]=g.start,o&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function H(a,b){var c,d,e,f,g;for(c in a)if(d=_.camelCase(c),e=b[d],f=a[c],_.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=_.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function I(a,b,c){var d,e,f=0,g=bc.length,h=_.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Yb||D(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:_.extend({},b),opts:_.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Yb||D(),duration:c.duration,tweens:[],createTween:function(b,c){var d=_.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(H(k,j.opts.specialEasing);g>f;f++)if(d=bc[f].call(j,a,k,j.opts))return d;return _.map(k,F,j),_.isFunction(j.opts.start)&&j.opts.start.call(a,j),_.fx.timer(_.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function J(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(nb)||[];if(_.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function K(a,b,c,d){function e(h){var i;return f[h]=!0,_.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===vc;return e(b.dataTypes[0])||!f["*"]&&e("*")}function L(a,b){var c,d,e=_.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&_.extend(!0,a,d),a}function M(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function N(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function O(a,b,c,d){var e;if(_.isArray(b))_.each(b,function(b,e){c||zc.test(a)?d(a,e):O(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==_.type(b))d(a,b);else for(e in b)O(a+"["+e+"]",b[e],c,d)}function P(a){return _.isWindow(a)?a:9===a.nodeType&&a.defaultView}var Q=[],R=Q.slice,S=Q.concat,T=Q.push,U=Q.indexOf,V={},W=V.toString,X=V.hasOwnProperty,Y={},Z=a.document,$="2.1.1",_=function(a,b){return new _.fn.init(a,b)},ab=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,bb=/^-ms-/,cb=/-([\da-z])/gi,db=function(a,b){return b.toUpperCase()};_.fn=_.prototype={jquery:$,constructor:_,selector:"",length:0,toArray:function(){return R.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:R.call(this)},pushStack:function(a){var b=_.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return _.each(this,a,b)},map:function(a){return this.pushStack(_.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(R.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:T,sort:Q.sort,splice:Q.splice},_.extend=_.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||_.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(_.isPlainObject(d)||(e=_.isArray(d)))?(e?(e=!1,f=c&&_.isArray(c)?c:[]):f=c&&_.isPlainObject(c)?c:{},g[b]=_.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},_.extend({expando:"jQuery"+($+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===_.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!_.isArray(a)&&a-parseFloat(a)>=0},isPlainObject:function(a){return"object"!==_.type(a)||a.nodeType||_.isWindow(a)?!1:a.constructor&&!X.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?V[W.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=_.trim(a),a&&(1===a.indexOf("use strict")?(b=Z.createElement("script"),b.text=a,Z.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(bb,"ms-").replace(cb,db)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(ab,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?_.merge(d,"string"==typeof a?[a]:a):T.call(d,a)),d},inArray:function(a,b,c){return null==b?-1:U.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&i.push(e);else for(f in a)e=b(a[f],f,d),null!=e&&i.push(e);return S.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(c=a[b],b=a,a=c),_.isFunction(a)?(d=R.call(arguments,2),e=function(){return a.apply(b||this,d.concat(R.call(arguments)))},e.guid=a.guid=a.guid||_.guid++,e):void 0},now:Date.now,support:Y}),_.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){V["[object "+b+"]"]=b.toLowerCase()});var eb=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,n,o,p;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(I&&!d){if(e=sb.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return _.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&v.getElementsByClassName&&b.getElementsByClassName)return _.apply(c,b.getElementsByClassName(g)),c}if(v.qsa&&(!J||!J.test(a))){if(n=l=N,o=b,p=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=z(a),(l=b.getAttribute("id"))?n=l.replace(ub,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",i=j.length;i--;)j[i]=n+m(j[i]);o=tb.test(a)&&k(b.parentNode)||b,p=j.join(",")}if(p)try{return _.apply(c,o.querySelectorAll(p)),c}catch(q){}finally{l||b.removeAttribute("id")}}}return B(a.replace(ib,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>w.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)w.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||W)-(~a.sourceIndex||W);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&typeof a.getElementsByTagName!==V&&a}function l(){}function m(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function n(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[N]||(b[N]={}),(h=i[d])&&h[0]===P&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function o(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function p(a,c,d){for(var e=0,f=c.length;f>e;e++)b(a,c[e],d);return d}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,r=d||p(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:q(r,m,a,h,i),t=c?f||(d?a:o||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=q(t,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[n[k]]=!(s[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?bb.call(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=q(t===g?t.splice(o,t.length):t),f?f(null,g,t,i):_.apply(g,t)})}function s(a){for(var b,c,d,e=a.length,f=w.relative[a[0].type],g=f||w.relative[" "],h=f?1:0,i=n(function(a){return a===b},g,!0),j=n(function(a){return bb.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];e>h;h++)if(c=w.relative[a[h].type])k=[n(o(k),c)];else{if(c=w.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!w.relative[a[d].type];d++);return r(h>1&&o(k),h>1&&m(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ib,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&m(a))}k.push(c)}return o(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&w.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g!==G&&g);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Z.call(i));r=q(r)}_.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}var u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V="undefined",W=1<<31,X={}.hasOwnProperty,Y=[],Z=Y.pop,$=Y.push,_=Y.push,ab=Y.slice,bb=Y.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},cb="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",db="[\\x20\\t\\r\\n\\f]",eb="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",fb=eb.replace("w","w#"),gb="\\["+db+"*("+eb+")(?:"+db+"*([*^$|!~]?=)"+db+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+fb+"))|)"+db+"*\\]",hb=":("+eb+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+gb+")*)|.*)\\)|)",ib=new RegExp("^"+db+"+|((?:^|[^\\\\])(?:\\\\.)*)"+db+"+$","g"),jb=new RegExp("^"+db+"*,"+db+"*"),kb=new RegExp("^"+db+"*([>+~]|"+db+")"+db+"*"),lb=new RegExp("="+db+"*([^\\]'\"]*?)"+db+"*\\]","g"),mb=new RegExp(hb),nb=new RegExp("^"+fb+"$"),ob={ID:new RegExp("^#("+eb+")"),CLASS:new RegExp("^\\.("+eb+")"),TAG:new RegExp("^("+eb.replace("w","w*")+")"),ATTR:new RegExp("^"+gb),PSEUDO:new RegExp("^"+hb),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+db+"*(even|odd|(([+-]|)(\\d*)n|)"+db+"*(?:([+-]|)"+db+"*(\\d+)|))"+db+"*\\)|)","i"),bool:new RegExp("^(?:"+cb+")$","i"),needsContext:new RegExp("^"+db+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+db+"*((?:-\\d)?\\d*)"+db+"*\\)|)(?=[^-]|$)","i")},pb=/^(?:input|select|textarea|button)$/i,qb=/^h\d$/i,rb=/^[^{]+\{\s*\[native \w/,sb=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tb=/[+~]/,ub=/'|\\/g,vb=new RegExp("\\\\([\\da-f]{1,6}"+db+"?|("+db+")|.)","ig"),wb=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{_.apply(Y=ab.call(O.childNodes),O.childNodes),Y[O.childNodes.length].nodeType}catch(xb){_={apply:Y.length?function(a,b){$.apply(a,ab.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}v=b.support={},y=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},F=b.setDocument=function(a){var b,c=a?a.ownerDocument||a:O,d=c.defaultView;return c!==G&&9===c.nodeType&&c.documentElement?(G=c,H=c.documentElement,I=!y(c),d&&d!==d.top&&(d.addEventListener?d.addEventListener("unload",function(){F()},!1):d.attachEvent&&d.attachEvent("onunload",function(){F()})),v.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),v.getElementsByTagName=e(function(a){return a.appendChild(c.createComment("")),!a.getElementsByTagName("*").length}),v.getElementsByClassName=rb.test(c.getElementsByClassName)&&e(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),v.getById=e(function(a){return H.appendChild(a).id=N,!c.getElementsByName||!c.getElementsByName(N).length}),v.getById?(w.find.ID=function(a,b){if(typeof b.getElementById!==V&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},w.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){return a.getAttribute("id")===b}}):(delete w.find.ID,w.filter.ID=function(a){var b=a.replace(vb,wb);return function(a){var c=typeof a.getAttributeNode!==V&&a.getAttributeNode("id");return c&&c.value===b}}),w.find.TAG=v.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==V?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},w.find.CLASS=v.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==V&&I?b.getElementsByClassName(a):void 0},K=[],J=[],(v.qsa=rb.test(c.querySelectorAll))&&(e(function(a){a.innerHTML="<select msallowclip=''><option selected=''></option></select>",a.querySelectorAll("[msallowclip^='']").length&&J.push("[*^$]="+db+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+db+"*(?:value|"+cb+")"),a.querySelectorAll(":checked").length||J.push(":checked")}),e(function(a){var b=c.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+db+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(v.matchesSelector=rb.test(L=H.matches||H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){v.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",hb)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=rb.test(H.compareDocumentPosition),M=b||rb.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!v.sortDetached&&b.compareDocumentPosition(a)===d?a===c||a.ownerDocument===O&&M(O,a)?-1:b===c||b.ownerDocument===O&&M(O,b)?1:D?bb.call(D,a)-bb.call(D,b):0:4&d?-1:1)}:function(a,b){if(a===b)return E=!0,0;var d,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===c?-1:b===c?1:f?-1:h?1:D?bb.call(D,a)-bb.call(D,b):0;if(f===h)return g(a,b);for(d=a;d=d.parentNode;)i.unshift(d);for(d=b;d=d.parentNode;)j.unshift(d);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},c):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(lb,"='$1']"),!(!v.matchesSelector||!I||K&&K.test(c)||J&&J.test(c)))try{var d=L.call(a,c);if(d||v.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=w.attrHandle[b.toLowerCase()],d=c&&X.call(w.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:v.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!v.detectDuplicates,D=!v.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},x=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=x(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=x(b);return c},w=b.selectors={cacheLength:50,createPseudo:d,match:ob,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(vb,wb),a[3]=(a[3]||a[4]||a[5]||"").replace(vb,wb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return ob.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&mb.test(c)&&(b=z(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(vb,wb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+db+")"+a+"("+db+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==V&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:c?(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f+" ").indexOf(d)>-1:"|="===c?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=w.pseudos[a]||w.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],w.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=bb.call(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=A(a.replace(ib,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return function(b){return(b.textContent||b.innerText||x(b)).indexOf(a)>-1}}),lang:d(function(a){return nb.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(vb,wb).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!w.pseudos.empty(a)},header:function(a){return qb.test(a.nodeName)},input:function(a){return pb.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[0>c?c+b:c]}),even:j(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},w.pseudos.nth=w.pseudos.eq;for(u in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[u]=h(u);for(u in{submit:!0,reset:!0})w.pseudos[u]=i(u);return l.prototype=w.filters=w.pseudos,w.setFilters=new l,z=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=w.preFilter;h;){(!d||(e=jb.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=kb.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ib," ")}),h=h.slice(d.length));for(g in w.filter)!(e=ob[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)},A=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=z(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d)),f.selector=a}return f},B=b.select=function(a,b,c,d){var e,f,g,h,i,j="function"==typeof a&&a,l=!d&&z(a=j.selector||a);if(c=c||[],1===l.length){if(f=l[0]=l[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&v.getById&&9===b.nodeType&&I&&w.relative[f[1].type]){if(b=(w.find.ID(g.matches[0].replace(vb,wb),b)||[])[0],!b)return c;j&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=ob.needsContext.test(a)?0:f.length;e--&&(g=f[e],!w.relative[h=g.type]);)if((i=w.find[h])&&(d=i(g.matches[0].replace(vb,wb),tb.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&m(f),!a)return _.apply(c,d),c;
break}}return(j||A(a,l))(d,b,!I,c,tb.test(a)&&k(b.parentNode)||b),c},v.sortStable=N.split("").sort(U).join("")===N,v.detectDuplicates=!!E,F(),v.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),v.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(cb,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);_.find=eb,_.expr=eb.selectors,_.expr[":"]=_.expr.pseudos,_.unique=eb.uniqueSort,_.text=eb.getText,_.isXMLDoc=eb.isXML,_.contains=eb.contains;var fb=_.expr.match.needsContext,gb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,hb=/^.[^:#\[\.,]*$/;_.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?_.find.matchesSelector(d,a)?[d]:[]:_.find.matches(a,_.grep(b,function(a){return 1===a.nodeType}))},_.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(_(a).filter(function(){for(b=0;c>b;b++)if(_.contains(e[b],this))return!0}));for(b=0;c>b;b++)_.find(a,e[b],d);return d=this.pushStack(c>1?_.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"==typeof a&&fb.test(a)?_(a):a||[],!1).length}});var ib,jb=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,kb=_.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:jb.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||ib).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof _?b[0]:b,_.merge(this,_.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:Z,!0)),gb.test(c[1])&&_.isPlainObject(b))for(c in b)_.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=Z.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=Z,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):_.isFunction(a)?"undefined"!=typeof ib.ready?ib.ready(a):a(_):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),_.makeArray(a,this))};kb.prototype=_.fn,ib=_(Z);var lb=/^(?:parents|prev(?:Until|All))/,mb={children:!0,contents:!0,next:!0,prev:!0};_.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&_(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),_.fn.extend({has:function(a){var b=_(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(_.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=fb.test(a)||"string"!=typeof a?_(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&_.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?_.unique(f):f)},index:function(a){return a?"string"==typeof a?U.call(_(a),this[0]):U.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(_.unique(_.merge(this.get(),_(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),_.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return _.dir(a,"parentNode")},parentsUntil:function(a,b,c){return _.dir(a,"parentNode",c)},next:function(a){return e(a,"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return _.dir(a,"nextSibling")},prevAll:function(a){return _.dir(a,"previousSibling")},nextUntil:function(a,b,c){return _.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return _.dir(a,"previousSibling",c)},siblings:function(a){return _.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return _.sibling(a.firstChild)},contents:function(a){return a.contentDocument||_.merge([],a.childNodes)}},function(a,b){_.fn[a]=function(c,d){var e=_.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=_.filter(d,e)),this.length>1&&(mb[a]||_.unique(e),lb.test(a)&&e.reverse()),this.pushStack(e)}});var nb=/\S+/g,ob={};_.Callbacks=function(a){a="string"==typeof a?ob[a]||f(a):_.extend({},a);var b,c,d,e,g,h,i=[],j=!a.once&&[],k=function(f){for(b=a.memory&&f,c=!0,h=e||0,e=0,g=i.length,d=!0;i&&g>h;h++)if(i[h].apply(f[0],f[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,i&&(j?j.length&&k(j.shift()):b?i=[]:l.disable())},l={add:function(){if(i){var c=i.length;!function f(b){_.each(b,function(b,c){var d=_.type(c);"function"===d?a.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),d?g=i.length:b&&(e=c,k(b))}return this},remove:function(){return i&&_.each(arguments,function(a,b){for(var c;(c=_.inArray(b,i,c))>-1;)i.splice(c,1),d&&(g>=c&&g--,h>=c&&h--)}),this},has:function(a){return a?_.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],g=0,this},disable:function(){return i=j=b=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,b||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||c&&!j||(b=b||[],b=[a,b.slice?b.slice():b],d?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!c}};return l},_.extend({Deferred:function(a){var b=[["resolve","done",_.Callbacks("once memory"),"resolved"],["reject","fail",_.Callbacks("once memory"),"rejected"],["notify","progress",_.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return _.Deferred(function(c){_.each(b,function(b,f){var g=_.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&_.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?_.extend(a,d):d}},e={};return d.pipe=d.then,_.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=R.call(arguments),g=f.length,h=1!==g||a&&_.isFunction(a.promise)?g:0,i=1===h?a:_.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?R.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&_.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var pb;_.fn.ready=function(a){return _.ready.promise().done(a),this},_.extend({isReady:!1,readyWait:1,holdReady:function(a){a?_.readyWait++:_.ready(!0)},ready:function(a){(a===!0?--_.readyWait:_.isReady)||(_.isReady=!0,a!==!0&&--_.readyWait>0||(pb.resolveWith(Z,[_]),_.fn.triggerHandler&&(_(Z).triggerHandler("ready"),_(Z).off("ready"))))}}),_.ready.promise=function(b){return pb||(pb=_.Deferred(),"complete"===Z.readyState?setTimeout(_.ready):(Z.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1))),pb.promise(b)},_.ready.promise();var qb=_.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===_.type(c)){e=!0;for(h in c)_.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,_.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(_(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};_.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType},h.uid=1,h.accepts=_.acceptData,h.prototype={key:function(a){if(!h.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=h.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,_.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(_.isEmptyObject(f))_.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,_.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{_.isArray(b)?d=b.concat(b.map(_.camelCase)):(e=_.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(nb)||[])),c=d.length;for(;c--;)delete g[d[c]]}},hasData:function(a){return!_.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var rb=new h,sb=new h,tb=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ub=/([A-Z])/g;_.extend({hasData:function(a){return sb.hasData(a)||rb.hasData(a)},data:function(a,b,c){return sb.access(a,b,c)},removeData:function(a,b){sb.remove(a,b)},_data:function(a,b,c){return rb.access(a,b,c)},_removeData:function(a,b){rb.remove(a,b)}}),_.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=sb.get(f),1===f.nodeType&&!rb.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=_.camelCase(d.slice(5)),i(f,d,e[d])));rb.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){sb.set(this,a)}):qb(this,function(b){var c,d=_.camelCase(a);if(f&&void 0===b){if(c=sb.get(f,a),void 0!==c)return c;if(c=sb.get(f,d),void 0!==c)return c;if(c=i(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=sb.get(this,d);sb.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&sb.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){sb.remove(this,a)})}}),_.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=rb.get(a,b),c&&(!d||_.isArray(c)?d=rb.access(a,b,_.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=_.queue(a,b),d=c.length,e=c.shift(),f=_._queueHooks(a,b),g=function(){_.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return rb.get(a,c)||rb.access(a,c,{empty:_.Callbacks("once memory").add(function(){rb.remove(a,[b+"queue",c])})})}}),_.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?_.queue(this[0],a):void 0===b?this:this.each(function(){var c=_.queue(this,a,b);_._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&_.dequeue(this,a)})},dequeue:function(a){return this.each(function(){_.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=_.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=rb.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var vb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,wb=["Top","Right","Bottom","Left"],xb=function(a,b){return a=b||a,"none"===_.css(a,"display")||!_.contains(a.ownerDocument,a)},yb=/^(?:checkbox|radio)$/i;!function(){var a=Z.createDocumentFragment(),b=a.appendChild(Z.createElement("div")),c=Z.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),Y.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",Y.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var zb="undefined";Y.focusinBubbles="onfocusin"in a;var Ab=/^key/,Bb=/^(?:mouse|pointer|contextmenu)|click/,Cb=/^(?:focusinfocus|focusoutblur)$/,Db=/^([^.]*)(?:\.(.+)|)$/;_.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=rb.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=_.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return typeof _!==zb&&_.event.triggered!==b.type?_.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(nb)||[""],j=b.length;j--;)h=Db.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=_.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=_.event.special[n]||{},k=_.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&_.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),_.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=rb.hasData(a)&&rb.get(a);if(q&&(i=q.events)){for(b=(b||"").match(nb)||[""],j=b.length;j--;)if(h=Db.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=_.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||_.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)_.event.remove(a,n+b[j],c,d,!0);_.isEmptyObject(i)&&(delete q.handle,rb.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||Z],n=X.call(b,"type")?b.type:b,o=X.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||Z,3!==d.nodeType&&8!==d.nodeType&&!Cb.test(n+_.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,b=b[_.expando]?b:new _.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:_.makeArray(c,[b]),l=_.event.special[n]||{},e||!l.trigger||l.trigger.apply(d,c)!==!1)){if(!e&&!l.noBubble&&!_.isWindow(d)){for(i=l.delegateType||n,Cb.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||Z)&&m.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=m[f++])&&!b.isPropagationStopped();)b.type=f>1?i:l.bindType||n,k=(rb.get(g,"events")||{})[b.type]&&rb.get(g,"handle"),k&&k.apply(g,c),k=j&&g[j],k&&k.apply&&_.acceptData(g)&&(b.result=k.apply(g,c),b.result===!1&&b.preventDefault());return b.type=n,e||b.isDefaultPrevented()||l._default&&l._default.apply(m.pop(),c)!==!1||!_.acceptData(d)||j&&_.isFunction(d[n])&&!_.isWindow(d)&&(h=d[j],h&&(d[j]=null),_.event.triggered=n,d[n](),_.event.triggered=void 0,h&&(d[j]=h)),b.result}},dispatch:function(a){a=_.event.fix(a);var b,c,d,e,f,g=[],h=R.call(arguments),i=(rb.get(this,"events")||{})[a.type]||[],j=_.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=_.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(f.namespace))&&(a.handleObj=f,a.data=f.data,d=((_.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h),void 0!==d&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?_(e,this).index(i)>=0:_.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||Z,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[_.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Bb.test(e)?this.mouseHooks:Ab.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new _.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=Z),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&_.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return _.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=_.extend(new _.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?_.event.trigger(e,null,b):_.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},_.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},_.Event=function(a,b){return this instanceof _.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?j:k):this.type=a,b&&_.extend(this,b),this.timeStamp=a&&a.timeStamp||_.now(),void(this[_.expando]=!0)):new _.Event(a,b)},_.Event.prototype={isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=j,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=j,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=j,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},_.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){_.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!_.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),Y.focusinBubbles||_.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){_.event.simulate(b,a.target,_.event.fix(a),!0)};_.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=rb.access(d,b);e||d.addEventListener(a,c,!0),rb.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=rb.access(d,b)-1;e?rb.access(d,b,e):(d.removeEventListener(a,c,!0),rb.remove(d,b))}}}),_.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=k;else if(!d)return this;return 1===e&&(f=d,d=function(a){return _().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=_.guid++)),this.each(function(){_.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,_(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=k),this.each(function(){_.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){_.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?_.event.trigger(a,b,c,!0):void 0}});var Eb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Fb=/<([\w:]+)/,Gb=/<|&#?\w+;/,Hb=/<(?:script|style|link)/i,Ib=/checked\s*(?:[^=]|=\s*.checked.)/i,Jb=/^$|\/(?:java|ecma)script/i,Kb=/^true\/(.*)/,Lb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Mb={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Mb.optgroup=Mb.option,Mb.tbody=Mb.tfoot=Mb.colgroup=Mb.caption=Mb.thead,Mb.th=Mb.td,_.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=_.contains(a.ownerDocument,a);if(!(Y.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||_.isXMLDoc(a)))for(g=r(h),f=r(a),d=0,e=f.length;e>d;d++)s(f[d],g[d]);if(b)if(c)for(f=f||r(a),g=g||r(h),d=0,e=f.length;e>d;d++)q(f[d],g[d]);else q(a,h);return g=r(h,"script"),g.length>0&&p(g,!i&&r(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,n=a.length;n>m;m++)if(e=a[m],e||0===e)if("object"===_.type(e))_.merge(l,e.nodeType?[e]:e);else if(Gb.test(e)){for(f=f||k.appendChild(b.createElement("div")),g=(Fb.exec(e)||["",""])[1].toLowerCase(),h=Mb[g]||Mb._default,f.innerHTML=h[1]+e.replace(Eb,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;_.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));for(k.textContent="",m=0;e=l[m++];)if((!d||-1===_.inArray(e,d))&&(i=_.contains(e.ownerDocument,e),f=r(k.appendChild(e),"script"),i&&p(f),c))for(j=0;e=f[j++];)Jb.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,c,d,e,f=_.event.special,g=0;void 0!==(c=a[g]);g++){if(_.acceptData(c)&&(e=c[rb.expando],e&&(b=rb.cache[e]))){if(b.events)for(d in b.events)f[d]?_.event.remove(c,d):_.removeEvent(c,d,b.handle);rb.cache[e]&&delete rb.cache[e]}delete sb.cache[c[sb.expando]]}}}),_.fn.extend({text:function(a){return qb(this,function(a){return void 0===a?_.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?_.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||_.cleanData(r(c)),c.parentNode&&(b&&_.contains(c.ownerDocument,c)&&p(r(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(_.cleanData(r(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return _.clone(this,a,b)})},html:function(a){return qb(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Hb.test(a)&&!Mb[(Fb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Eb,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(_.cleanData(r(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,_.cleanData(r(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=S.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],p=_.isFunction(m);if(p||j>1&&"string"==typeof m&&!Y.checkClone&&Ib.test(m))return this.each(function(c){var d=k.eq(c);p&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(c=_.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(e=_.map(r(c,"script"),n),f=e.length;j>i;i++)g=c,i!==l&&(g=_.clone(g,!0,!0),f&&_.merge(e,r(g,"script"))),b.call(this[i],g,i);if(f)for(h=e[e.length-1].ownerDocument,_.map(e,o),i=0;f>i;i++)g=e[i],Jb.test(g.type||"")&&!rb.access(g,"globalEval")&&_.contains(h,g)&&(g.src?_._evalUrl&&_._evalUrl(g.src):_.globalEval(g.textContent.replace(Lb,"")))}return this}}),_.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){_.fn[a]=function(a){for(var c,d=[],e=_(a),f=e.length-1,g=0;f>=g;g++)c=g===f?this:this.clone(!0),_(e[g])[b](c),T.apply(d,c.get());return this.pushStack(d)}});var Nb,Ob={},Pb=/^margin/,Qb=new RegExp("^("+vb+")(?!px)[a-z%]+$","i"),Rb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)};!function(){function b(){g.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",g.innerHTML="",e.appendChild(f);var b=a.getComputedStyle(g,null);c="1%"!==b.top,d="4px"===b.width,e.removeChild(f)}var c,d,e=Z.documentElement,f=Z.createElement("div"),g=Z.createElement("div");g.style&&(g.style.backgroundClip="content-box",g.cloneNode(!0).style.backgroundClip="",Y.clearCloneStyle="content-box"===g.style.backgroundClip,f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",f.appendChild(g),a.getComputedStyle&&_.extend(Y,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return null==d&&b(),d},reliableMarginRight:function(){var b,c=g.appendChild(Z.createElement("div"));return c.style.cssText=g.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",g.style.width="1px",e.appendChild(f),b=!parseFloat(a.getComputedStyle(c,null).marginRight),e.removeChild(f),b}}))}(),_.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Sb=/^(none|table(?!-c[ea]).+)/,Tb=new RegExp("^("+vb+")(.*)$","i"),Ub=new RegExp("^([+-])=("+vb+")","i"),Vb={position:"absolute",visibility:"hidden",display:"block"},Wb={letterSpacing:"0",fontWeight:"400"},Xb=["Webkit","O","Moz","ms"];_.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=v(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=_.camelCase(b),i=a.style;return b=_.cssProps[h]||(_.cssProps[h]=x(i,h)),g=_.cssHooks[b]||_.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Ub.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(_.css(a,b)),f="number"),void(null!=c&&c===c&&("number"!==f||_.cssNumber[h]||(c+="px"),Y.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c))))}},css:function(a,b,c,d){var e,f,g,h=_.camelCase(b);return b=_.cssProps[h]||(_.cssProps[h]=x(a.style,h)),g=_.cssHooks[b]||_.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=v(a,b,d)),"normal"===e&&b in Wb&&(e=Wb[b]),""===c||c?(f=parseFloat(e),c===!0||_.isNumeric(f)?f||0:e):e}}),_.each(["height","width"],function(a,b){_.cssHooks[b]={get:function(a,c,d){return c?Sb.test(_.css(a,"display"))&&0===a.offsetWidth?_.swap(a,Vb,function(){return A(a,b,d)}):A(a,b,d):void 0},set:function(a,c,d){var e=d&&Rb(a);return y(a,c,d?z(a,b,d,"border-box"===_.css(a,"boxSizing",!1,e),e):0)}}}),_.cssHooks.marginRight=w(Y.reliableMarginRight,function(a,b){return b?_.swap(a,{display:"inline-block"},v,[a,"marginRight"]):void 0}),_.each({margin:"",padding:"",border:"Width"},function(a,b){_.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+wb[d]+b]=f[d]||f[d-2]||f[0];return e}},Pb.test(a)||(_.cssHooks[a+b].set=y)}),_.fn.extend({css:function(a,b){return qb(this,function(a,b,c){var d,e,f={},g=0;if(_.isArray(b)){for(d=Rb(a),e=b.length;e>g;g++)f[b[g]]=_.css(a,b[g],!1,d);return f}return void 0!==c?_.style(a,b,c):_.css(a,b)},a,b,arguments.length>1)},show:function(){return B(this,!0)},hide:function(){return B(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){xb(this)?_(this).show():_(this).hide()})}}),_.Tween=C,C.prototype={constructor:C,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(_.cssNumber[c]?"":"px")},cur:function(){var a=C.propHooks[this.prop];return a&&a.get?a.get(this):C.propHooks._default.get(this)},run:function(a){var b,c=C.propHooks[this.prop];return this.pos=b=this.options.duration?_.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):C.propHooks._default.set(this),this}},C.prototype.init.prototype=C.prototype,C.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=_.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){_.fx.step[a.prop]?_.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[_.cssProps[a.prop]]||_.cssHooks[a.prop])?_.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},C.propHooks.scrollTop=C.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},_.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},_.fx=C.prototype.init,_.fx.step={};var Yb,Zb,$b=/^(?:toggle|show|hide)$/,_b=new RegExp("^(?:([+-])=|)("+vb+")([a-z%]*)$","i"),ac=/queueHooks$/,bc=[G],cc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=_b.exec(b),f=e&&e[3]||(_.cssNumber[a]?"":"px"),g=(_.cssNumber[a]||"px"!==f&&+d)&&_b.exec(_.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,_.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};_.Animation=_.extend(I,{tweener:function(a,b){_.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],cc[c]=cc[c]||[],cc[c].unshift(b)},prefilter:function(a,b){b?bc.unshift(a):bc.push(a)}}),_.speed=function(a,b,c){var d=a&&"object"==typeof a?_.extend({},a):{complete:c||!c&&b||_.isFunction(a)&&a,duration:a,easing:c&&b||b&&!_.isFunction(b)&&b};return d.duration=_.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in _.fx.speeds?_.fx.speeds[d.duration]:_.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){_.isFunction(d.old)&&d.old.call(this),d.queue&&_.dequeue(this,d.queue)
},d},_.fn.extend({fadeTo:function(a,b,c,d){return this.filter(xb).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=_.isEmptyObject(a),f=_.speed(b,c,d),g=function(){var b=I(this,_.extend({},a),f);(e||rb.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=_.timers,g=rb.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&ac.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&_.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=rb.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=_.timers,g=d?d.length:0;for(c.finish=!0,_.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),_.each(["toggle","show","hide"],function(a,b){var c=_.fn[b];_.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(E(b,!0),a,d,e)}}),_.each({slideDown:E("show"),slideUp:E("hide"),slideToggle:E("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){_.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),_.timers=[],_.fx.tick=function(){var a,b=0,c=_.timers;for(Yb=_.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||_.fx.stop(),Yb=void 0},_.fx.timer=function(a){_.timers.push(a),a()?_.fx.start():_.timers.pop()},_.fx.interval=13,_.fx.start=function(){Zb||(Zb=setInterval(_.fx.tick,_.fx.interval))},_.fx.stop=function(){clearInterval(Zb),Zb=null},_.fx.speeds={slow:600,fast:200,_default:400},_.fn.delay=function(a,b){return a=_.fx?_.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=Z.createElement("input"),b=Z.createElement("select"),c=b.appendChild(Z.createElement("option"));a.type="checkbox",Y.checkOn=""!==a.value,Y.optSelected=c.selected,b.disabled=!0,Y.optDisabled=!c.disabled,a=Z.createElement("input"),a.value="t",a.type="radio",Y.radioValue="t"===a.value}();var dc,ec,fc=_.expr.attrHandle;_.fn.extend({attr:function(a,b){return qb(this,_.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){_.removeAttr(this,a)})}}),_.extend({attr:function(a,b,c){var d,e,f=a.nodeType;return a&&3!==f&&8!==f&&2!==f?typeof a.getAttribute===zb?_.prop(a,b,c):(1===f&&_.isXMLDoc(a)||(b=b.toLowerCase(),d=_.attrHooks[b]||(_.expr.match.bool.test(b)?ec:dc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=_.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void _.removeAttr(a,b)):void 0},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(nb);if(f&&1===a.nodeType)for(;c=f[e++];)d=_.propFix[c]||c,_.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!Y.radioValue&&"radio"===b&&_.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),ec={set:function(a,b,c){return b===!1?_.removeAttr(a,c):a.setAttribute(c,c),c}},_.each(_.expr.match.bool.source.match(/\w+/g),function(a,b){var c=fc[b]||_.find.attr;fc[b]=function(a,b,d){var e,f;return d||(f=fc[b],fc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,fc[b]=f),e}});var gc=/^(?:input|select|textarea|button)$/i;_.fn.extend({prop:function(a,b){return qb(this,_.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[_.propFix[a]||a]})}}),_.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;return a&&3!==g&&8!==g&&2!==g?(f=1!==g||!_.isXMLDoc(a),f&&(b=_.propFix[b]||b,e=_.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]):void 0},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||gc.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),Y.optSelected||(_.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),_.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){_.propFix[this.toLowerCase()]=this});var hc=/[\t\r\n\f]/g;_.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(_.isFunction(a))return this.each(function(b){_(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(nb)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hc," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=_.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(_.isFunction(a))return this.each(function(b){_(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(nb)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hc," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?_.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(_.isFunction(a)?function(c){_(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=_(this),f=a.match(nb)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===zb||"boolean"===c)&&(this.className&&rb.set(this,"__className__",this.className),this.className=this.className||a===!1?"":rb.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(hc," ").indexOf(b)>=0)return!0;return!1}});var ic=/\r/g;_.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=_.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,_(this).val()):a,null==e?e="":"number"==typeof e?e+="":_.isArray(e)&&(e=_.map(e,function(a){return null==a?"":a+""})),b=_.valHooks[this.type]||_.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))})):e?(b=_.valHooks[e.type]||_.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(ic,""):null==c?"":c)):void 0}}),_.extend({valHooks:{option:{get:function(a){var b=_.find.attr(a,"value");return null!=b?b:_.trim(_.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(Y.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&_.nodeName(c.parentNode,"optgroup"))){if(b=_(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=_.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=_.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),_.each(["radio","checkbox"],function(){_.valHooks[this]={set:function(a,b){return _.isArray(b)?a.checked=_.inArray(_(a).val(),b)>=0:void 0}},Y.checkOn||(_.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),_.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){_.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),_.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var jc=_.now(),kc=/\?/;_.parseJSON=function(a){return JSON.parse(a+"")},_.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&_.error("Invalid XML: "+a),b};var lc,mc,nc=/#.*$/,oc=/([?&])_=[^&]*/,pc=/^(.*?):[ \t]*([^\r\n]*)$/gm,qc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rc=/^(?:GET|HEAD)$/,sc=/^\/\//,tc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,uc={},vc={},wc="*/".concat("*");try{mc=location.href}catch(xc){mc=Z.createElement("a"),mc.href="",mc=mc.href}lc=tc.exec(mc.toLowerCase())||[],_.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:mc,type:"GET",isLocal:qc.test(lc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":_.parseJSON,"text xml":_.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?L(L(a,_.ajaxSettings),b):L(_.ajaxSettings,a)},ajaxPrefilter:J(uc),ajaxTransport:J(vc),ajax:function(a,b){function c(a,b,c,g){var i,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),d=void 0,f=g||"",v.readyState=a>0?4:0,i=a>=200&&300>a||304===a,c&&(s=M(l,v,c)),s=N(l,s,v,i),i?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(_.lastModified[e]=u),u=v.getResponseHeader("etag"),u&&(_.etag[e]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,i=!r)):(r=w,(a||!w)&&(w="error",0>a&&(a=0))),v.status=a,v.statusText=(b||w)+"",i?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,j&&n.trigger(i?"ajaxSuccess":"ajaxError",[v,l,i?k:r]),p.fireWith(m,[v,w]),j&&(n.trigger("ajaxComplete",[v,l]),--_.active||_.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=_.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?_(m):_.event,o=_.Deferred(),p=_.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!g)for(g={};b=pc.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return d&&d.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||mc)+"").replace(nc,"").replace(sc,lc[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=_.trim(l.dataType||"*").toLowerCase().match(nb)||[""],null==l.crossDomain&&(i=tc.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]===lc[1]&&i[2]===lc[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(lc[3]||("http:"===lc[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=_.param(l.data,l.traditional)),K(uc,l,b,v),2===t)return v;j=l.global,j&&0===_.active++&&_.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rc.test(l.type),e=l.url,l.hasContent||(l.data&&(e=l.url+=(kc.test(e)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=oc.test(e)?e.replace(oc,"$1_="+jc++):e+(kc.test(e)?"&":"?")+"_="+jc++)),l.ifModified&&(_.lastModified[e]&&v.setRequestHeader("If-Modified-Since",_.lastModified[e]),_.etag[e]&&v.setRequestHeader("If-None-Match",_.etag[e])),(l.data&&l.hasContent&&l.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+wc+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)v.setRequestHeader(k,l.headers[k]);if(l.beforeSend&&(l.beforeSend.call(m,v,l)===!1||2===t))return v.abort();u="abort";for(k in{success:1,error:1,complete:1})v[k](l[k]);if(d=K(vc,l,b,v)){v.readyState=1,j&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,d.send(r,c)}catch(w){if(!(2>t))throw w;c(-1,w)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return _.get(a,b,c,"json")},getScript:function(a,b){return _.get(a,void 0,b,"script")}}),_.each(["get","post"],function(a,b){_[b]=function(a,c,d,e){return _.isFunction(c)&&(e=e||d,d=c,c=void 0),_.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),_.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){_.fn[b]=function(a){return this.on(b,a)}}),_._evalUrl=function(a){return _.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},_.fn.extend({wrapAll:function(a){var b;return _.isFunction(a)?this.each(function(b){_(this).wrapAll(a.call(this,b))}):(this[0]&&(b=_(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return this.each(_.isFunction(a)?function(b){_(this).wrapInner(a.call(this,b))}:function(){var b=_(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=_.isFunction(a);return this.each(function(c){_(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){_.nodeName(this,"body")||_(this).replaceWith(this.childNodes)}).end()}}),_.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},_.expr.filters.visible=function(a){return!_.expr.filters.hidden(a)};var yc=/%20/g,zc=/\[\]$/,Ac=/\r?\n/g,Bc=/^(?:submit|button|image|reset|file)$/i,Cc=/^(?:input|select|textarea|keygen)/i;_.param=function(a,b){var c,d=[],e=function(a,b){b=_.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=_.ajaxSettings&&_.ajaxSettings.traditional),_.isArray(a)||a.jquery&&!_.isPlainObject(a))_.each(a,function(){e(this.name,this.value)});else for(c in a)O(c,a[c],b,e);return d.join("&").replace(yc,"+")},_.fn.extend({serialize:function(){return _.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=_.prop(this,"elements");return a?_.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!_(this).is(":disabled")&&Cc.test(this.nodeName)&&!Bc.test(a)&&(this.checked||!yb.test(a))}).map(function(a,b){var c=_(this).val();return null==c?null:_.isArray(c)?_.map(c,function(a){return{name:b.name,value:a.replace(Ac,"\r\n")}}):{name:b.name,value:c.replace(Ac,"\r\n")}}).get()}}),_.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Dc=0,Ec={},Fc={0:200,1223:204},Gc=_.ajaxSettings.xhr();a.ActiveXObject&&_(a).on("unload",function(){for(var a in Ec)Ec[a]()}),Y.cors=!!Gc&&"withCredentials"in Gc,Y.ajax=Gc=!!Gc,_.ajaxTransport(function(a){var b;return Y.cors||Gc&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Dc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Ec[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Fc[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Ec[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),_.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return _.globalEval(a),a}}}),_.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),_.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=_("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),Z.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Hc=[],Ic=/(=)\?(?=&|$)|\?\?/;_.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Hc.pop()||_.expando+"_"+jc++;return this[a]=!0,a}}),_.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Ic.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ic.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=_.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Ic,"$1"+e):b.jsonp!==!1&&(b.url+=(kc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||_.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Hc.push(e)),g&&_.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),_.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||Z;var d=gb.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=_.buildFragment([a],b,e),e&&e.length&&_(e).remove(),_.merge([],d.childNodes))};var Jc=_.fn.load;_.fn.load=function(a,b,c){if("string"!=typeof a&&Jc)return Jc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=_.trim(a.slice(h)),a=a.slice(0,h)),_.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&_.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?_("<div>").append(_.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},_.expr.filters.animated=function(a){return _.grep(_.timers,function(b){return a===b.elem}).length};var Kc=a.document.documentElement;_.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=_.css(a,"position"),l=_(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=_.css(a,"top"),i=_.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),_.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},_.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){_.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;return f?(b=f.documentElement,_.contains(b,d)?(typeof d.getBoundingClientRect!==zb&&(e=d.getBoundingClientRect()),c=P(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e):void 0},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===_.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),_.nodeName(a[0],"html")||(d=a.offset()),d.top+=_.css(a[0],"borderTopWidth",!0),d.left+=_.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-_.css(c,"marginTop",!0),left:b.left-d.left-_.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Kc;a&&!_.nodeName(a,"html")&&"static"===_.css(a,"position");)a=a.offsetParent;return a||Kc})}}),_.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;_.fn[b]=function(e){return qb(this,function(b,e,f){var g=P(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),_.each(["top","left"],function(a,b){_.cssHooks[b]=w(Y.pixelPosition,function(a,c){return c?(c=v(a,b),Qb.test(c)?_(a).position()[b]+"px":c):void 0})}),_.each({Height:"height",Width:"width"},function(a,b){_.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){_.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return qb(this,function(b,c,d){var e;return _.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?_.css(b,c,g):_.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),_.fn.size=function(){return this.length},_.fn.andSelf=_.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return _});var Lc=a.jQuery,Mc=a.$;return _.noConflict=function(b){return a.$===_&&(a.$=Mc),b&&a.jQuery===_&&(a.jQuery=Lc),_},typeof b===zb&&(a.jQuery=a.$=_),_});var isIEMobile=/IEMobile/.test(navigator.userAgent),isAndroid=/Android|\bSilk\b/.test(navigator.userAgent),isiOS=/iP(ad|hone|od)/.test(navigator.userAgent),isFireFoxOS=/^.*?\Mobile\b.*?\Firefox\b.*?$/m.test(navigator.userAgent),isWinApp=/MSAppHost/.test(navigator.userAgent),isBB10=/BB10/.test(navigator.userAgent),isIE=/MSIE (\d+)\.\d+;/.exec(navigator.userAgent)||!1,isOSXApp=isOSXApp||!1,isChromeApp="object"==typeof chrome&&"object"==typeof chrome.storage,isFileCapable=!(isiOS||isAndroid||isIEMobile||isOSXApp||isFireFoxOS||isWinApp||isBB10||!window.FileReader),storage={get:function(a,b){if(b=b||function(){},isChromeApp)chrome.storage.local.get(a,b);else{var c,d={};if("object"==typeof a)for(c in a)a.hasOwnProperty(c)&&(d[a[c]]=localStorage.getItem(a[c]));else"string"==typeof a&&(d[a]=localStorage.getItem(a));b(d)}},set:function(a,b){if(b=b||function(){},isChromeApp)chrome.storage.local.set(a,b);else{var c;if("object"==typeof a)for(c in a)a.hasOwnProperty(c)&&localStorage.setItem(c,a[c]);b(!0)}},remove:function(a,b){if(b=b||function(){},isChromeApp)chrome.storage.local.remove(a,b);else{var c;if("object"==typeof a)for(c in a)a.hasOwnProperty(c)&&localStorage.removeItem(a[c]);else"string"==typeof a&&localStorage.removeItem(a);b(!0)}}},retryCount=3,controller={},switching=!1,curr_183,curr_ip,curr_prefix,curr_auth,curr_pw,curr_wa,curr_auth_user,curr_auth_pw,curr_local,language,deviceip,interval_id,timeout_id,errorTimeout,weatherKeyFail;if(isWinApp){var settingsPane=Windows.UI.ApplicationSettings.SettingsPane.getForCurrentView();settingsPane.addEventListener("commandsrequested",function(a){var b=a.request.applicationCommands,c=new Windows.UI.ApplicationSettings.SettingsCommand("privacy","Privacy Policy",function(){window.open("https://albahra.com/journal/privacy-policy")});b.append(c)}),$.fn.oldDomManIp=$.fn.domManip,$.fn.domManip=function(a,b,c){var d=this;return MSApp.execUnsafeLocalFunction(function(){return d.oldDomManIp(a,b,c)})}}$(document).ready(initApp).one("deviceready",function(){try{StatusBar.overlaysWebView(!1),StatusBar.styleLightContent(),StatusBar.backgroundColorByHexString("#1D1D1D")}catch(a){}setTimeout(function(){try{navigator.splashscreen.hide()}catch(a){}},500),checkAutoScan(),$.mobile.document.on("backbutton",function(){return isIEMobile&&$.mobile.document.data("iabOpen")?!1:(checkChangesBeforeBack(),!1)})}).one("mobileinit",function(){$.mobile.defaultPageTransition="fade",$.mobile.hoverDelay=0,$.mobile.activeBtnClass="activeButton",isChromeApp&&($.mobile.hashListeningEnabled=!1,$.mobile.document.on("click",".ui-toolbar-back-btn",function(){return goBack(),!1})),isOSXApp||$.mobile.document.on("click",".iab",function(){var a=$(this),b=window.open(this.href,"_blank","location="+(isAndroid?"yes":"no")+",enableViewportScale="+(a.hasClass("iabNoScale")?"no":"yes")+",toolbarposition=top,closebuttoncaption="+_(a.hasClass("iabNoScale")?"Back":"Done"));return isIEMobile&&($.mobile.document.data("iabOpen",!0),b.addEventListener("exit",function(){$.mobile.document.removeData("iabOpen")})),setTimeout(function(){a.removeClass("ui-btn-active")},100),!1}),$.mobile.document.on("click",".ui-select .ui-btn",function(){var a=$(this),b=a.attr("id").replace("-button","-listbox"),c=$("#"+b),d=$("#"+b+"-screen");return c.popup({history:!1,positionTo:a}).popup("open"),a.off("click").on("click",function(){c.popup("open")}),d.off("click").on("click",function(){c.popup("close")}),!1}),$.mobile.document.on("swiperight",".ui-page",function(){"open"===$(".ui-page-active").jqmData("panel")||$(".ui-page-active .ui-popup-active").length||open_panel()}),$.widget("mobile.collapsible",$.mobile.collapsible,{_handleExpandCollapse:function(a){this._trigger("before"+(a?"collapse":"expand"))&&this._superApply(arguments)}})}).one("pagebeforechange",function(a){a.preventDefault(),$.mobile.document.on("pagebeforechange",function(a,b){var c,d=b.toPage,e=$(".ui-page-active");if("string"==typeof b.toPage){if(c=$.mobile.path.parseUrl(d).hash,c==="#"+e.attr("id"))return void(("#programs"===c||"#site-control"===c)&&(a.preventDefault(),$.mobile.navigate.history.activeIndex--,e.remove(),changePage(c,{transition:"none",showLoadMsg:!1,showBack:b.options.showBack})));if("popup"===b.options.role||$(".ui-popup-active").length||$.mobile.silentScroll(0),"#programs"===c)get_programs(b.options.programToExpand);else if("#addprogram"===c)add_program(b.options.copyID);else if("#status"===c)get_status(),$(c).one("pageshow",refresh_status);else if("#manual"===c)get_manual();else if("#about"===c)show_about();else if("#runonce"===c)get_runonce();else if("#os-options"===c)show_options();else if("#preview"===c)get_preview();else if("#logs"===c)get_logs();else if("#start"===c){if(checkAutoScan(),!b.options.showStart)return $.isEmptyObject(controller)&&changePage("#site-control",{showBack:!1}),!1}else if("#os-stations"===c)show_stations();else if("#site-control"===c)show_sites(b.options.showBack);else if("#weather_settings"===c)show_weather_settings();else{if("#addnew"===c)return show_addnew(),!1;if("#localization"===c)return languageSelect(),!1;if("#debugWU"===c)return debugWU(),!1;if("#raindelay"===c)return showDurationBox({data:0,title:_("Change Rain Delay"),callback:raindelay,label:_("Duration"),maximum:345600,granularity:2,preventCompression:!0,incrementalUpdate:!1,updateOnChange:!1,helptext:_("Enable manual rain delay by entering a value into the input below. To turn off a currently enabled rain delay use a value of 0.")}),!1;if("#site-select"===c)return show_site_select(),!1;"#sprinklers"===c&&$(c).one("pagebeforeshow",function(){b.options.firstLoad?check_status():(showLoading("#footer-running"),setTimeout(function(){refresh_status()},1e3))})}}}),check_configured(!0),FastClick.attach(document.body),$("#sprinklers-settings").enhanceWithin().panel().removeClass("hidden")}).on("resume",function(){var a=$(".ui-page-active").attr("id"),b=function(){};checkAutoScan(),void 0!==curr_ip&&(showLoading("#weather,#footer-running"),"status"===a?b=function(){a.trigger("datarefresh")}:"sprinklers"===a&&(b=check_status),update_controller(function(){b(),update_weather()},network_fail))}).on("pause",function(){removeTimers()}).on("pageshow",function(a){var b="#"+a.target.id,c=$(b);if(fixInputClick(c),"#sprinklers"===b||"#status"===b||"#os-stations"===b){var d=setInterval(refresh_status,5e3);c.one("pagehide",function(){clearInterval(d)})}}).on("popupafteropen",function(){if($(".ui-overlay-b:not(.ui-screen-hidden)").length)try{StatusBar.backgroundColorByHexString("#202020")}catch(a){}}).on("popupafterclose",function(){try{StatusBar.backgroundColorByHexString("#1D1D1D")}catch(a){}}).on("pagehide","#start",removeTimers).on("popupbeforeposition","#localization",check_curr_lang),curr_local||$.ajaxSetup({timeout:6e3}),!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(b,c){var d=c.times,e=b.timeout;return function(f){function g(){a.ajax(h).retry({times:d-1,timeout:c.timeout}).pipe(i.resolve,i.reject)}var h=this,i=new a.Deferred,j=b.getResponseHeader("Retry-After");return d>1&&(!b.statusCodes||a.inArray(f.status,b.statusCodes)>-1)?(j&&(e=isNaN(j)?new Date(j).getTime()-a.now():1e3*parseInt(j,10),(isNaN(e)||0>e)&&(e=b.timeout)),void 0!==e?setTimeout(g,e):g()):i.rejectWith(this,arguments),i}}a.ajaxPrefilter(function(a,c,d){d.retry=function(a){return a.timeout&&(this.timeout=a.timeout),a.statusCodes&&(this.statusCodes=a.statusCodes),this.pipe(null,b(this,a))}})}),function(){function a(c,d){function e(a,b){return function(){return a.apply(b,arguments)}}var f;if(d=d||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=d.touchBoundary||10,this.layer=c,this.tapDelay=d.tapDelay||200,!a.notNeeded(c)){for(var g=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],h=this,i=0,j=g.length;j>i;i++)h[g[i]]=e(h[g[i]],h);b&&(c.addEventListener("mouseover",this.onMouse,!0),c.addEventListener("mousedown",this.onMouse,!0),c.addEventListener("mouseup",this.onMouse,!0)),c.addEventListener("click",this.onClick,!0),c.addEventListener("touchstart",this.onTouchStart,!1),c.addEventListener("touchmove",this.onTouchMove,!1),c.addEventListener("touchend",this.onTouchEnd,!1),c.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(c.removeEventListener=function(a,b,d){var e=Node.prototype.removeEventListener;"click"===a?e.call(c,a,b.hijacked||b,d):e.call(c,a,b,d)},c.addEventListener=function(a,b,d){var e=Node.prototype.addEventListener;"click"===a?e.call(c,a,b.hijacked||(b.hijacked=function(a){a.propagationStopped||b(a)}),d):e.call(c,a,b,d)}),"function"==typeof c.onclick&&(f=c.onclick,c.addEventListener("click",function(a){f(a)},!1),c.onclick=null)}}var b=navigator.userAgent.indexOf("Android")>0,c=/iP(ad|hone|od)/.test(navigator.userAgent),d=c&&/OS 4_\d(_\d)?/.test(navigator.userAgent),e=c&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),f=navigator.userAgent.indexOf("BB10")>0;a.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return!0;break;case"input":if(c&&"file"===a.type||a.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(a.className)},a.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!b;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}},a.prototype.sendClick=function(a,b){var c,d;document.activeElement&&document.activeElement!==a&&document.activeElement.blur(),d=b.changedTouches[0],c=document.createEvent("MouseEvents"),c.initMouseEvent(this.determineEventType(a),!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),c.forwardedTouchEvent=!0,a.dispatchEvent(c)},a.prototype.determineEventType=function(a){return b&&"select"===a.tagName.toLowerCase()?"mousedown":"click"},a.prototype.focus=function(a){var b;c&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type&&"month"!==a.type?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()},a.prototype.updateScrollParent=function(a){var b,c;if(b=a.fastClickScrollParent,!b||!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c,a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.fastClickLastScrollTop=b.scrollTop)},a.prototype.getTargetElementFromEventTarget=function(a){return a.nodeType===Node.TEXT_NODE?a.parentNode:a},a.prototype.onTouchStart=function(a){var b,e,f;if(a.targetTouches.length>1)return!0;
if(b=this.getTargetElementFromEventTarget(a.target),e=a.targetTouches[0],c){if(f=window.getSelection(),f.rangeCount&&!f.isCollapsed)return!0;if(!d){if(e.identifier&&e.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=e.identifier,this.updateScrollParent(b)}}return this.trackingClick=!0,this.trackingClickStart=a.timeStamp,this.targetElement=b,this.touchStartX=e.pageX,this.touchStartY=e.pageY,a.timeStamp-this.lastClickTime<this.tapDelay&&a.preventDefault(),!0},a.prototype.touchHasMoved=function(a){var b=a.changedTouches[0],c=this.touchBoundary;return Math.abs(b.pageX-this.touchStartX)>c||Math.abs(b.pageY-this.touchStartY)>c?!0:!1},a.prototype.onTouchMove=function(a){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},a.prototype.findControl=function(a){return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},a.prototype.onTouchEnd=function(a){var f,g,h,i,j,k=this.targetElement;if(!this.trackingClick)return!0;if(a.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(this.cancelNextClick=!1,this.lastClickTime=a.timeStamp,g=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,e&&(j=a.changedTouches[0],k=document.elementFromPoint(j.pageX-window.pageXOffset,j.pageY-window.pageYOffset)||k,k.fastClickScrollParent=this.targetElement.fastClickScrollParent),h=k.tagName.toLowerCase(),"label"===h){if(f=this.findControl(k)){if(this.focus(k),b)return!1;k=f}}else if(this.needsFocus(k))return a.timeStamp-g>100||c&&window.top!==window&&"input"===h?(this.targetElement=null,!1):(this.focus(k),this.sendClick(k,a),c&&"select"===h||(this.targetElement=null,a.preventDefault()),!1);return c&&!d&&(i=k.fastClickScrollParent,i&&i.fastClickLastScrollTop!==i.scrollTop)?!0:(this.needsClick(k)||(a.preventDefault(),this.sendClick(k,a)),!1)},a.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},a.prototype.onMouse=function(a){return this.targetElement?a.forwardedTouchEvent?!0:a.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1):!0:!0},a.prototype.onClick=function(a){var b;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===a.target.type&&0===a.detail?!0:(b=this.onMouse(a),b||(this.targetElement=null),b)},a.prototype.destroy=function(){var a=this.layer;b&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0)),a.removeEventListener("click",this.onClick,!0),a.removeEventListener("touchstart",this.onTouchStart,!1),a.removeEventListener("touchmove",this.onTouchMove,!1),a.removeEventListener("touchend",this.onTouchEnd,!1),a.removeEventListener("touchcancel",this.onTouchCancel,!1)},a.notNeeded=function(a){var c,d,e;if("undefined"==typeof window.ontouchstart)return!0;if(d=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!b)return!0;if(c=document.querySelector("meta[name=viewport]")){if(-1!==c.content.indexOf("user-scalable=no"))return!0;if(d>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(f&&(e=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),e[1]>=10&&e[2]>=3&&(c=document.querySelector("meta[name=viewport]")))){if(-1!==c.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===a.style.msTouchAction?!0:!1},a.attach=function(b,c){return new a(b,c)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return a}):"undefined"!=typeof module&&module.exports?(module.exports=a.attach,module.exports.FastClick=a):window.FastClick=a}(),"undefined"==typeof links&&(links={}),"undefined"==typeof google&&(google=void 0),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;d>c;++c)a.call(b||this,this[c],c,this)}),links.Timeline=function(a,b){if(a){this.dom={},this.conversion={},this.eventParams={},this.groups=[],this.groupIndexes={},this.items=[],this.renderQueue={show:[],hide:[],update:[]},this.renderedItems=[],this.clusterGenerator=new links.Timeline.ClusterGenerator(this),this.currentClusters=[],this.selection=void 0,this.listeners={},this.size={actualHeight:0,axis:{characterMajorHeight:0,characterMajorWidth:0,characterMinorHeight:0,characterMinorWidth:0,height:0,labelMajorTop:0,labelMinorTop:0,line:0,lineMajorWidth:0,lineMinorHeight:0,lineMinorTop:0,lineMinorWidth:0,top:0},contentHeight:0,contentLeft:0,contentWidth:0,frameHeight:0,frameWidth:0,groupsLeft:0,groupsWidth:0,items:{top:0}},this.dom.container=a,this.options={width:"100%",height:"auto",minHeight:0,groupMinHeight:0,autoHeight:!0,eventMargin:10,eventMarginAxis:20,dragAreaWidth:10,min:void 0,max:void 0,zoomMin:10,zoomMax:31536e10,moveable:!0,zoomable:!0,selectable:!0,unselectable:!0,editable:!1,snapEvents:!0,groupChangeable:!0,timeChangeable:!0,showCurrentTime:!0,showCustomTime:!1,showMajorLabels:!0,showMinorLabels:!0,showNavigation:!1,showButtonNew:!1,groupsOnRight:!1,groupsOrder:!0,axisOnTop:!1,stackEvents:!0,animate:!0,animateZoom:!0,cluster:!1,clusterMaxItems:5,style:"box",customStackOrder:!1,locale:"en",MONTHS:["January","February","March","April","May","June","July","August","September","October","November","December"],MONTHS_SHORT:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAYS:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DAYS_SHORT:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ZOOM_IN:"Zoom in",ZOOM_OUT:"Zoom out",MOVE_LEFT:"Move left",MOVE_RIGHT:"Move right",NEW:"New",CREATE_NEW_EVENT:"Create new event"},this.setOptions(b),this.clientTimeOffset=0;for(var c=this.dom;c.container.hasChildNodes();)c.container.removeChild(c.container.firstChild);this.step=new links.Timeline.StepDate,this.itemTypes={box:links.Timeline.ItemBox,range:links.Timeline.ItemRange,floatingRange:links.Timeline.ItemFloatingRange,dot:links.Timeline.ItemDot},this.data=[],this.firstDraw=!0,this.setVisibleChartRange(void 0,void 0,!1),this.render();var d=this;setTimeout(function(){d.trigger("ready")},0)}},links.Timeline.prototype.draw=function(a,b){b&&console.log("WARNING: Passing options in draw() is deprecated. Pass options to the constructur or use setOptions() instead!"),this.setOptions(b),this.options.selectable&&links.Timeline.addClassName(this.dom.frame,"timeline-selectable"),this.setData(a),b&&(b.start||b.end)?this.setVisibleChartRange(b.start,b.end):this.firstDraw&&this.setVisibleChartRangeAuto(),this.firstDraw=!1},links.Timeline.prototype.setOptions=function(a){if(a){for(var b in a)a.hasOwnProperty(b)&&(this.options[b]=a[b]);if("undefined"!=typeof links.locales&&"en"!==this.options.locale){var c=links.locales[this.options.locale];if(c)for(var d in c)c.hasOwnProperty(d)&&(this.options[d]=c[d])}void 0!=a.showButtonAdd&&(this.options.showButtonNew=a.showButtonAdd,console.log("WARNING: Option showButtonAdd is deprecated. Use showButtonNew instead")),void 0!=a.intervalMin&&(this.options.zoomMin=a.intervalMin,console.log("WARNING: Option intervalMin is deprecated. Use zoomMin instead")),void 0!=a.intervalMax&&(this.options.zoomMax=a.intervalMax,console.log("WARNING: Option intervalMax is deprecated. Use zoomMax instead")),a.scale&&a.step&&this.step.setScale(a.scale,a.step)}this.options.autoHeight="auto"===this.options.height},links.Timeline.prototype.getOptions=function(){return this.options},links.Timeline.prototype.addItemType=function(a,b){this.itemTypes[a]=b},links.Timeline.mapColumnIds=function(a){for(var b={},c=a.getNumberOfColumns(),d=!0,e=0;c>e;e++){var f=a.getColumnId(e)||a.getColumnLabel(e);b[f]=e,("start"==f||"end"==f||"content"==f||"group"==f||"className"==f||"editable"==f||"type"==f)&&(d=!1)}return d&&(b.start=0,b.end=1,b.content=2,c>3&&(b.group=3),c>4&&(b.className=4),c>5&&(b.editable=5),c>6&&(b.type=6)),b},links.Timeline.prototype.setData=function(a){this.unselectItem(),a||(a=[]),this.stackCancelAnimation(),this.clearItems(),this.data=a;var b=this.items;if(this.deleteGroups(),google&&google.visualization&&a instanceof google.visualization.DataTable)for(var c=links.Timeline.mapColumnIds(a),d=0,e=a.getNumberOfRows();e>d;d++)b.push(this.createItem({start:void 0!=c.start?a.getValue(d,c.start):void 0,end:void 0!=c.end?a.getValue(d,c.end):void 0,content:void 0!=c.content?a.getValue(d,c.content):void 0,group:void 0!=c.group?a.getValue(d,c.group):void 0,className:void 0!=c.className?a.getValue(d,c.className):void 0,editable:void 0!=c.editable?a.getValue(d,c.editable):void 0,type:void 0!=c.type?a.getValue(d,c.type):void 0}));else{if(!links.Timeline.isArray(a))throw"Unknown data type. DataTable or Array expected.";for(var d=0,e=a.length;e>d;d++){var f=a[d],g=this.createItem(f);b.push(g)}}this.options.cluster&&this.clusterGenerator.setData(this.items),this.render({animate:!1})},links.Timeline.prototype.getData=function(){return this.data},links.Timeline.prototype.updateData=function(a,b){var c,d=this.data;if(google&&google.visualization&&d instanceof google.visualization.DataTable){var e=a+1-d.getNumberOfRows();e>0&&d.addRows(e);var f=links.Timeline.mapColumnIds(d);for(c in b)if(b.hasOwnProperty(c)){var g=f[c];if(void 0==g){var h=b[c],i="string";"number"==typeof h?i="number":"boolean"==typeof h?i="boolean":h instanceof Date&&(i="datetime"),g=d.addColumn(i,c)}d.setValue(a,g,b[c])}}else{if(!links.Timeline.isArray(d))throw"Cannot update data, unknown type of data";var j=d[a];void 0==j&&(j={},d[a]=j);for(c in b)b.hasOwnProperty(c)&&(j[c]=b[c])}},links.Timeline.prototype.getItemIndex=function(a){for(var b=a,c=this.dom,d=c.items.frame,e=this.items,f=void 0;b.parentNode&&b.parentNode!==d;)b=b.parentNode;if(b.parentNode===d)for(var g=0,h=e.length;h>g;g++)if(e[g].dom===b){f=g;break}return f},links.Timeline.prototype.getClusterIndex=function(a){var b=a,c=this.dom,d=c.items.frame,e=this.clusters,f=void 0;if(this.clusters){for(;b.parentNode&&b.parentNode!==d;)b=b.parentNode;if(b.parentNode===d)for(var g=0,h=e.length;h>g;g++)if(e[g].dom===b){f=g;break}}return f},links.Timeline.prototype.getVisibleItems=function(a,b){var c=this.items,d=[];if(c)for(var e=0,f=c.length;f>e;e++){var g=c[e];g.end?a<=g.start&&g.end<=b&&d.push({row:e}):a<=g.start&&g.start<=b&&d.push({row:e})}return d},links.Timeline.prototype.setSize=function(a,b){a&&(this.options.width=a,this.dom.frame.style.width=a),b&&(this.options.height=b,this.options.autoHeight="auto"===this.options.height,"auto"!==b&&(this.dom.frame.style.height=b)),this.render({animate:!1})},links.Timeline.prototype.setVisibleChartRange=function(a,b,c){var d={};a&&b||(d=this.getDataRange(!0)),a||(b?d.min&&d.min.valueOf()<b.valueOf()?a=d.min:(a=new Date(b.valueOf()),a.setDate(a.getDate()-7)):(a=new Date,a.setDate(a.getDate()-3))),b||(d.max?b=d.max:(b=new Date(a.valueOf()),b.setDate(b.getDate()+7))),a>=b&&(b=new Date(a.valueOf()),b.setDate(b.getDate()+7));var e=this.options.min?this.options.min:void 0;void 0!=e&&a.valueOf()<e.valueOf()&&(a=new Date(e.valueOf()));var f=this.options.max?this.options.max:void 0;void 0!=f&&b.valueOf()>f.valueOf()&&(b=new Date(f.valueOf())),this.applyRange(a,b),void 0==c||1==c?this.render({animate:!1}):this.recalcConversion()},links.Timeline.prototype.setVisibleChartRangeAuto=function(){var a=this.getDataRange(!0);this.setVisibleChartRange(a.min,a.max)},links.Timeline.prototype.setVisibleChartRangeNow=function(){var a=new Date,b=this.end.valueOf()-this.start.valueOf(),c=new Date(a.valueOf()-b/2),d=new Date(c.valueOf()+b);this.setVisibleChartRange(c,d)},links.Timeline.prototype.getVisibleChartRange=function(){return{start:new Date(this.start.valueOf()),end:new Date(this.end.valueOf())}},links.Timeline.prototype.getDataRange=function(a){var b=this.items,c=void 0,d=void 0;if(b)for(var e=0,f=b.length;f>e;e++){var g=b[e],h=void 0!=g.start?g.start.valueOf():void 0,i=void 0!=g.end?g.end.valueOf():h;void 0!=h&&(c=void 0!=c?Math.min(c.valueOf(),h.valueOf()):h),void 0!=i&&(d=void 0!=d?Math.max(d.valueOf(),i.valueOf()):i)}if(c&&d&&a){var j=d-c;c-=.05*j,d+=.05*j}return{min:void 0!=c?new Date(c):void 0,max:void 0!=d?new Date(d):void 0}},links.Timeline.prototype.render=function(a){var b=(this.reflowFrame(),this.reflowAxis(),this.reflowGroups(),this.reflowItems(),this.options.animate);a&&void 0!=a.animate&&(b=a.animate),this.recalcConversion(),this.clusterItems(),this.filterItems(),this.stackItems(b),this.recalcItems();var c=this.repaint();if(c){var d=a?a.renderTimesLeft:void 0;void 0==d&&(d=5),d>0&&this.render({animate:a?a.animate:void 0,renderTimesLeft:d-1})}},links.Timeline.prototype.repaint=function(){var a=this.repaintFrame(),b=this.repaintAxis(),c=this.repaintGroups(),d=this.repaintItems();return this.repaintCurrentTime(),this.repaintCustomTime(),a||b||c||d},links.Timeline.prototype.reflowFrame=function(){var a=this.dom,b=(this.options,this.size),c=!1,d=a.frame?a.frame.offsetWidth:0,e=a.frame?a.frame.clientHeight:0;return c=c||b.frameWidth!==d,c=c||b.frameHeight!==e,b.frameWidth=d,b.frameHeight=e,c},links.Timeline.prototype.repaintFrame=function(){var a=!1,b=this.dom,c=this.options,d=this.size;b.frame||(b.frame=document.createElement("DIV"),b.frame.className="timeline-frame ui-widget ui-widget-content ui-corner-all",b.container.appendChild(b.frame),a=!0);var e=c.autoHeight?d.actualHeight+"px":c.height||"100%",f=c.width||"100%";if(a=a||b.frame.style.height!=e,a=a||b.frame.style.width!=f,b.frame.style.height=e,b.frame.style.width=f,!b.content){b.content=document.createElement("DIV"),b.content.className="timeline-content",b.frame.appendChild(b.content);var g=document.createElement("DIV");g.style.position="absolute",g.style.left="0px",g.style.top="0px",g.style.height="100%",g.style.width="0px",b.content.appendChild(g),b.contentTimelines=g;var h=this.eventParams,i=this;h.onMouseDown||(h.onMouseDown=function(a){i.onMouseDown(a)},links.Timeline.addEventListener(b.content,"mousedown",h.onMouseDown)),h.onTouchStart||(h.onTouchStart=function(a){i.onTouchStart(a)},links.Timeline.addEventListener(b.content,"touchstart",h.onTouchStart)),h.onMouseWheel||(h.onMouseWheel=function(a){i.onMouseWheel(a)},links.Timeline.addEventListener(b.content,"mousewheel",h.onMouseWheel)),h.onDblClick||(h.onDblClick=function(a){i.onDblClick(a)},links.Timeline.addEventListener(b.content,"dblclick",h.onDblClick)),a=!0}return b.content.style.left=d.contentLeft+"px",b.content.style.top="0px",b.content.style.width=d.contentWidth+"px",b.content.style.height=d.frameHeight+"px",this.repaintNavigation(),a},links.Timeline.prototype.reflowAxis=function(){var a=!1,b=this.dom,c=this.options,d=this.size,e=b.axis,f=e&&e.characterMinor?e.characterMinor.clientWidth:0,g=e&&e.characterMinor?e.characterMinor.clientHeight:0,h=e&&e.characterMajor?e.characterMajor.clientWidth:0,i=e&&e.characterMajor?e.characterMajor.clientHeight:0,j=(c.showMinorLabels?g:0)+(c.showMajorLabels?i:0),k=c.axisOnTop?0:d.frameHeight-j,l=c.axisOnTop?j:k;a=a||d.axis.top!==k,a=a||d.axis.line!==l,a=a||d.axis.height!==j,d.axis.top=k,d.axis.line=l,d.axis.height=j,d.axis.labelMajorTop=c.axisOnTop?0:l+(c.showMinorLabels?g:0),d.axis.labelMinorTop=c.axisOnTop?c.showMajorLabels?i:0:l,d.axis.lineMinorTop=c.axisOnTop?d.axis.labelMinorTop:0,d.axis.lineMinorHeight=c.showMajorLabels?d.frameHeight-i:d.frameHeight,d.axis.lineMinorWidth=e&&e.minorLines&&e.minorLines.length?e.minorLines[0].offsetWidth:1,d.axis.lineMajorWidth=e&&e.majorLines&&e.majorLines.length?e.majorLines[0].offsetWidth:1,a=a||d.axis.characterMinorWidth!==f,a=a||d.axis.characterMinorHeight!==g,a=a||d.axis.characterMajorWidth!==h,a=a||d.axis.characterMajorHeight!==i,d.axis.characterMinorWidth=f,d.axis.characterMinorHeight=g,d.axis.characterMajorWidth=h,d.axis.characterMajorHeight=i;var m=Math.max(d.frameHeight-j,0);return d.contentLeft=c.groupsOnRight?0:d.groupsWidth,d.contentWidth=Math.max(d.frameWidth-d.groupsWidth,0),d.contentHeight=m,a},links.Timeline.prototype.repaintAxis=function(){var a=!1,b=this.dom,c=this.options,d=this.size,e=this.step,f=b.axis;f||(f={},b.axis=f),d.axis.properties||(d.axis.properties={}),f.minorTexts||(f.minorTexts=[]),f.minorLines||(f.minorLines=[]),f.majorTexts||(f.majorTexts=[]),f.majorLines||(f.majorLines=[]),f.frame||(f.frame=document.createElement("DIV"),f.frame.style.position="absolute",f.frame.style.left="0px",f.frame.style.top="0px",b.content.appendChild(f.frame)),b.content.removeChild(f.frame),f.frame.style.width=d.contentWidth+"px",f.frame.style.height=d.axis.height+"px";var g=this.screenToTime(0),h=this.screenToTime(d.contentWidth);d.axis.characterMinorWidth&&(this.minimumStep=this.screenToTime(6*d.axis.characterMinorWidth)-this.screenToTime(0),e.setRange(g,h,this.minimumStep));var i=this.repaintAxisCharacters();a=a||i,this.repaintAxisStartOverwriting(),e.start();for(var j=void 0,k=0;!e.end()&&1e3>k;){k++;var l=e.getCurrent(),m=this.timeToScreen(l),n=e.isMajor();c.showMinorLabels&&this.repaintAxisMinorText(m,e.getLabelMinor(c)),n&&c.showMajorLabels?(m>0&&(void 0==j&&(j=m),this.repaintAxisMajorText(m,e.getLabelMajor(c))),this.repaintAxisMajorLine(m)):this.repaintAxisMinorLine(m),e.next()}if(c.showMajorLabels){var o=this.screenToTime(0),p=this.step.getLabelMajor(c,o),q=p.length*d.axis.characterMajorWidth+10;(void 0==j||j>q)&&this.repaintAxisMajorText(0,p,o)}return this.repaintAxisEndOverwriting(),this.repaintAxisHorizontal(),b.content.insertBefore(f.frame,b.content.firstChild),a},links.Timeline.prototype.repaintAxisCharacters=function(){var a,b=!1,c=this.dom,d=c.axis;if(!d.characterMinor){a=document.createTextNode("0");var e=document.createElement("DIV");e.className="timeline-axis-text timeline-axis-text-minor",e.appendChild(a),e.style.position="absolute",e.style.visibility="hidden",e.style.paddingLeft="0px",e.style.paddingRight="0px",d.frame.appendChild(e),d.characterMinor=e,b=!0}if(!d.characterMajor){a=document.createTextNode("0");var f=document.createElement("DIV");f.className="timeline-axis-text timeline-axis-text-major",f.appendChild(a),f.style.position="absolute",f.style.visibility="hidden",f.style.paddingLeft="0px",f.style.paddingRight="0px",d.frame.appendChild(f),d.characterMajor=f,b=!0}return b},links.Timeline.prototype.repaintAxisStartOverwriting=function(){var a=this.size.axis.properties;a.minorTextNum=0,a.minorLineNum=0,a.majorTextNum=0,a.majorLineNum=0},links.Timeline.prototype.repaintAxisEndOverwriting=function(){var a,b=this.dom,c=this.size.axis.properties,d=this.dom.axis.frame,e=b.axis.minorTexts;for(a=c.minorTextNum;e.length>a;){var f=e[a];d.removeChild(f),e.splice(a,1)}var g=b.axis.minorLines;for(a=c.minorLineNum;g.length>a;){var h=g[a];d.removeChild(h),g.splice(a,1)}var i=b.axis.majorTexts;for(a=c.majorTextNum;i.length>a;){var j=i[a];d.removeChild(j),i.splice(a,1)}var k=b.axis.majorLines;for(a=c.majorLineNum;k.length>a;){var l=k[a];d.removeChild(l),k.splice(a,1)}},links.Timeline.prototype.repaintAxisHorizontal=function(){var a=this.dom.axis,b=this.size,c=this.options,d=c.showMinorLabels||c.showMajorLabels;if(d){if(!a.backgroundLine){var e=document.createElement("DIV");e.className="timeline-axis",e.style.position="absolute",e.style.left="0px",e.style.width="100%",e.style.border="none",a.frame.insertBefore(e,a.frame.firstChild),a.backgroundLine=e}a.backgroundLine&&(a.backgroundLine.style.top=b.axis.top+"px",a.backgroundLine.style.height=b.axis.height+"px")}else a.backgroundLine&&(a.frame.removeChild(a.backgroundLine),delete a.backgroundLine);if(d){if(a.line){var f=a.frame.removeChild(a.line);a.frame.appendChild(f)}else{var f=document.createElement("DIV");f.className="timeline-axis",f.style.position="absolute",f.style.left="0px",f.style.width="100%",f.style.height="0px",a.frame.appendChild(f),a.line=f}a.line.style.top=b.axis.line+"px"}else a.line&&a.line.parentElement&&(a.frame.removeChild(a.line),delete a.line)},links.Timeline.prototype.repaintAxisMinorText=function(a,b){var c,d=this.size,e=this.dom,f=d.axis.properties,g=e.axis.frame,h=e.axis.minorTexts,i=f.minorTextNum;if(i<h.length)c=h[i];else{var j=document.createTextNode("");c=document.createElement("DIV"),c.appendChild(j),c.className="timeline-axis-text timeline-axis-text-minor",c.style.position="absolute",g.appendChild(c),h.push(c)}c.childNodes[0].nodeValue=b,c.style.left=a+"px",c.style.top=d.axis.labelMinorTop+"px",f.minorTextNum++},links.Timeline.prototype.repaintAxisMinorLine=function(a){var b,c=this.size.axis,d=this.dom,e=c.properties,f=d.axis.frame,g=d.axis.minorLines,h=e.minorLineNum;h<g.length?b=g[h]:(b=document.createElement("DIV"),b.className="timeline-axis-grid timeline-axis-grid-minor",b.style.position="absolute",b.style.width="0px",f.appendChild(b),g.push(b)),b.style.top=c.lineMinorTop+"px",b.style.height=c.lineMinorHeight+"px",b.style.left=a-c.lineMinorWidth/2+"px",e.minorLineNum++},links.Timeline.prototype.repaintAxisMajorText=function(a,b){var c,d=this.size,e=d.axis.properties,f=this.dom.axis.frame,g=this.dom.axis.majorTexts,h=e.majorTextNum;if(h<g.length)c=g[h];else{var i=document.createTextNode(b);c=document.createElement("DIV"),c.className="timeline-axis-text timeline-axis-text-major",c.appendChild(i),c.style.position="absolute",c.style.top="0px",f.appendChild(c),g.push(c)}c.childNodes[0].nodeValue=b,c.style.top=d.axis.labelMajorTop+"px",c.style.left=a+"px",e.majorTextNum++},links.Timeline.prototype.repaintAxisMajorLine=function(a){var b,c=this.size,d=c.axis.properties,e=this.size.axis,f=this.dom.axis.frame,g=this.dom.axis.majorLines,h=d.majorLineNum;h<g.length?b=g[h]:(b=document.createElement("DIV"),b.className="timeline-axis-grid timeline-axis-grid-major",b.style.position="absolute",b.style.top="0px",b.style.width="0px",f.appendChild(b),g.push(b)),b.style.left=a-e.lineMajorWidth/2+"px",b.style.height=c.frameHeight+"px",d.majorLineNum++},links.Timeline.prototype.reflowItems=function(){var a,b,c,d=!1,e=this.groups,f=this.renderedItems;for(e&&e.forEach(function(a){a.itemsHeight=0}),a=0,b=f.length;b>a;a++){var g=f[a],h=g.dom;if(c=g.group,h){var i=h?h.clientWidth:0,j=h?h.clientHeight:0;d=d||g.width!=i,d=d||g.height!=j,g.width=i,g.height=j,g.reflow()}c&&(c.itemsHeight=Math.max(this.options.groupMinHeight,c.itemsHeight?Math.max(c.itemsHeight,g.height):g.height))}return d},links.Timeline.prototype.recalcItems=function(){var a,b,c,d,e,f,g=!1,h=this.groups,i=this.size,j=this.options,k=this.renderedItems,l=0;if(0==h.length){if(j.autoHeight||j.cluster){var m=0,n=0;if(this.stack&&this.stack.finalItems)for(e=this.stack.finalItems,d=e[0],d&&d.top&&(m=d.top,n=d.top+d.height),a=1,b=e.length;b>a;a++)d=e[a],m=Math.min(m,d.top),n=Math.max(n,d.top+d.height);else for(c=k[0],c&&c.top&&(m=c.top,n=c.top+c.height),a=1,b=k.length;b>a;a++)c=k[a],c.top&&(m=Math.min(m,c.top),n=Math.max(n,c.top+c.height));if(l=n-m+2*j.eventMarginAxis+i.axis.height,l<j.minHeight&&(l=j.minHeight),i.actualHeight!=l&&j.autoHeight&&!j.axisOnTop){var o=l-i.actualHeight;if(this.stack&&this.stack.finalItems)for(e=this.stack.finalItems,a=0,b=e.length;b>a;a++)e[a].top+=o,e[a].item.top+=o;else for(a=0,b=k.length;b>a;a++)k[a].top+=o}}}else{for(l=i.axis.height+2*j.eventMarginAxis,a=0,b=h.length;b>a;a++){f=h[a];var p=f.itemsHeight;g=g||p!=f.height,f.height=Math.max(p,j.groupMinHeight),l+=h[a].height+j.eventMargin}var q=j.eventMargin,r=j.axisOnTop?j.eventMarginAxis+q/2:i.contentHeight-j.eventMarginAxis+q/2,s=i.axis.height;for(a=0,b=h.length;b>a;a++)f=h[a],j.axisOnTop?(f.top=r+s,f.labelTop=r+s+(f.height-f.labelHeight)/2,f.lineTop=r+s+f.height+q/2,r+=f.height+q):(r-=f.height+q,f.top=r,f.labelTop=r+(f.height-f.labelHeight)/2,f.lineTop=r-q/2);g=!0}return l<j.minHeight&&(l=j.minHeight),g=g||l!=i.actualHeight,i.actualHeight=l,g},links.Timeline.prototype.clearItems=function(){var a=this.renderQueue.hide;this.renderedItems.forEach(function(b){a.push(b)}),this.clusterGenerator.clear(),this.items=[]},links.Timeline.prototype.repaintItems=function(){var a,b,c=!1,d=this.dom,e=this.size,f=this,g=this.renderedItems;d.items||(d.items={});var h=d.items.frame;h||(h=document.createElement("DIV"),h.style.position="relative",d.content.appendChild(h),d.items.frame=h),h.style.left="0px",h.style.top=e.items.top+"px",h.style.height="0px",d.content.removeChild(h);var i=this.renderQueue,j=[];for(c=c||i.show.length>0||i.update.length>0||i.hide.length>0;a=i.show.shift();)a.showDOM(h),a.getImageUrls(j),g.push(a);for(;a=i.update.shift();)a.updateDOM(h),a.getImageUrls(j),b=this.renderedItems.indexOf(a),-1==b&&g.push(a);for(;a=i.hide.shift();)a.hideDOM(h),b=this.renderedItems.indexOf(a),-1!=b&&g.splice(b,1);if(g.forEach(function(a){a.updatePosition(f)}),this.repaintDeleteButton(),this.repaintDragAreas(),d.content.appendChild(h),j.length){var k=function(){f.render()},l=!1;links.imageloader.loadAll(j,k,l)}return c},links.Timeline.prototype.reflowGroups=function(){for(var a=!1,b=this.options,c=this.size,d=this.dom,e=0,f=this.groups,g=this.dom.groups?this.dom.groups.labels:[],h=0,i=f.length;i>h;h++){var j=f[h],k=g[h];j.labelWidth=k?k.clientWidth:0,j.labelHeight=k?k.clientHeight:0,j.width=j.labelWidth,e=Math.max(e,j.width)}void 0!==b.groupsWidth&&(e=d.groups.frame?d.groups.frame.clientWidth:0),e+=1;var l=b.groupsOnRight?c.frameWidth-e:0;return a=a||c.groupsWidth!==e,a=a||c.groupsLeft!==l,c.groupsWidth=e,c.groupsLeft=l,a},links.Timeline.prototype.repaintGroups=function(){var a=this.dom,b=this,c=this.options,d=this.size,e=this.groups;void 0===a.groups&&(a.groups={});var f=a.groups.labels;f||(f=[],a.groups.labels=f);var g=a.groups.labelLines;g||(g=[],a.groups.labelLines=g);var h=a.groups.itemLines;h||(h=[],a.groups.itemLines=h);var i=a.groups.frame;i||(i=document.createElement("DIV"),i.className="timeline-groups-axis",i.style.position="absolute",i.style.overflow="hidden",i.style.top="0px",i.style.height="100%",a.frame.appendChild(i),a.groups.frame=i),i.style.left=d.groupsLeft+"px",i.style.width=void 0!==c.groupsWidth?c.groupsWidth:d.groupsWidth+"px",i.style.display=0==e.length?"none":"";for(var j=f.length,k=e.length,l=0,m=Math.min(j,k);m>l;l++){var n=e[l],o=f[l];o.innerHTML=this.getGroupName(n),o.style.display=""}for(var l=j;k>l;l++){var n=e[l],o=document.createElement("DIV");o.className="timeline-groups-text",o.style.position="absolute",void 0===c.groupsWidth&&(o.style.whiteSpace="nowrap"),o.innerHTML=this.getGroupName(n),i.appendChild(o),f[l]=o;var p=document.createElement("DIV");p.className="timeline-axis-grid timeline-axis-grid-minor",p.style.position="absolute",p.style.left="0px",p.style.width="100%",p.style.height="0px",p.style.borderTopStyle="solid",i.appendChild(p),g[l]=p;var q=document.createElement("DIV");q.className="timeline-axis-grid timeline-axis-grid-minor",q.style.position="absolute",q.style.left="0px",q.style.width="100%",q.style.height="0px",q.style.borderTopStyle="solid",a.content.insertBefore(q,a.content.firstChild),h[l]=q}for(var l=k;j>l;l++){var o=f[l],p=g[l],q=h[l];i.removeChild(o),i.removeChild(p),a.content.removeChild(q)}f.splice(k,j-k),g.splice(k,j-k),h.splice(k,j-k),links.Timeline.addClassName(i,c.groupsOnRight?"timeline-groups-axis-onright":"timeline-groups-axis-onleft");for(var l=0,m=e.length;m>l;l++){var n=e[l],o=f[l],p=g[l],q=h[l];o.style.top=n.labelTop+"px",p.style.top=n.lineTop+"px",q.style.top=n.lineTop+"px",q.style.width=d.contentWidth+"px"}if(!a.groups.background){var r=document.createElement("DIV");r.className="timeline-axis",r.style.position="absolute",r.style.left="0px",r.style.width="100%",r.style.border="none",i.appendChild(r),a.groups.background=r}if(a.groups.background.style.top=d.axis.top+"px",a.groups.background.style.height=d.axis.height+"px",!a.groups.line){var s=document.createElement("DIV");s.className="timeline-axis",s.style.position="absolute",s.style.left="0px",s.style.width="100%",s.style.height="0px",i.appendChild(s),a.groups.line=s}if(a.groups.line.style.top=d.axis.line+"px",a.groups.frame&&e.length){var t=[];if(links.imageloader.filterImageUrls(a.groups.frame,t),t.length){var u=function(){b.render()},v=!1;links.imageloader.loadAll(t,u,v)}}},links.Timeline.prototype.repaintCurrentTime=function(){var a=this.options,b=this.dom,c=this.size;if(!a.showCurrentTime)return void(b.currentTime&&(b.contentTimelines.removeChild(b.currentTime),delete b.currentTime));if(!b.currentTime){var d=document.createElement("DIV");d.className="timeline-currenttime",d.style.position="absolute",d.style.top="0px",d.style.height="100%",b.contentTimelines.appendChild(d),b.currentTime=d}var e=new Date,f=new Date(e.valueOf()+this.clientTimeOffset),g=this.timeToScreen(f),h=g>-c.contentWidth&&g<2*c.contentWidth;b.currentTime.style.display=h?"":"none",b.currentTime.style.left=g+"px",b.currentTime.title="Current time: "+f,void 0!=this.currentTimeTimer&&(clearTimeout(this.currentTimeTimer),delete this.currentTimeTimer);var i=this,j=function(){i.repaintCurrentTime()},k=1/this.conversion.factor/2;30>k&&(k=30),this.currentTimeTimer=setTimeout(j,k)},links.Timeline.prototype.repaintCustomTime=function(){var a=this.options,b=this.dom,c=this.size;if(!a.showCustomTime)return void(b.customTime&&(b.contentTimelines.removeChild(b.customTime),delete b.customTime));if(!b.customTime){var d=document.createElement("DIV");d.className="timeline-customtime",d.style.position="absolute",d.style.top="0px",d.style.height="100%";var e=document.createElement("DIV");e.style.position="relative",e.style.top="0px",e.style.left="-10px",e.style.height="100%",e.style.width="20px",d.appendChild(e),b.contentTimelines.appendChild(d),b.customTime=d,this.customTime=new Date}var f=this.timeToScreen(this.customTime),g=f>-c.contentWidth&&f<2*c.contentWidth;b.customTime.style.display=g?"":"none",b.customTime.style.left=f+"px",b.customTime.title="Time: "+this.customTime},links.Timeline.prototype.repaintDeleteButton=function(){var a=this.dom,b=a.items.frame,c=a.items.deleteButton;c||(c=document.createElement("DIV"),c.className="timeline-navigation-delete",c.style.position="absolute",b.appendChild(c),a.items.deleteButton=c);var d=this.selection&&void 0!==this.selection.index?this.selection.index:-1,e=this.selection&&void 0!==this.selection.index?this.items[d]:void 0;if(e&&e.rendered&&this.isEditable(e)){var f=e.getRight(this),g=e.top;c.style.left=f+"px",c.style.top=g+"px",c.style.display="",b.removeChild(c),b.appendChild(c)}else c.style.display="none"},links.Timeline.prototype.repaintDragAreas=function(){var a=this.options,b=this.dom,c=this.dom.items.frame,d=b.items.dragLeft;d||(d=document.createElement("DIV"),d.className="timeline-event-range-drag-left",d.style.position="absolute",c.appendChild(d),b.items.dragLeft=d);var e=b.items.dragRight;e||(e=document.createElement("DIV"),e.className="timeline-event-range-drag-right",e.style.position="absolute",c.appendChild(e),b.items.dragRight=e);var f=this.selection&&void 0!==this.selection.index?this.selection.index:-1,g=this.selection&&void 0!==this.selection.index?this.items[f]:void 0;if(g&&g.rendered&&this.isEditable(g)&&(g instanceof links.Timeline.ItemRange||g instanceof links.Timeline.ItemFloatingRange)){var h=g.getLeft(this),i=g.getRight(this),j=g.top,k=g.height;d.style.left=h+"px",d.style.top=j+"px",d.style.width=a.dragAreaWidth+"px",d.style.height=k+"px",d.style.display="",c.removeChild(d),c.appendChild(d),e.style.left=i-a.dragAreaWidth+"px",e.style.top=j+"px",e.style.width=a.dragAreaWidth+"px",e.style.height=k+"px",e.style.display="",c.removeChild(e),c.appendChild(e)}else d.style.display="none",e.style.display="none"},links.Timeline.prototype.repaintNavigation=function(){var a=this,b=this.options,c=this.dom,d=c.frame,e=c.navBar;if(!e){var f=b.showButtonNew&&b.editable,g=b.showNavigation&&(b.zoomable||b.moveable);if((g||f)&&(e=document.createElement("DIV"),e.style.position="absolute",e.className="timeline-navigation ui-widget ui-state-highlight ui-corner-all",b.groupsOnRight?e.style.left="10px":e.style.right="10px",b.axisOnTop?e.style.bottom="10px":e.style.top="10px",c.navBar=e,d.appendChild(e)),f){e.addButton=document.createElement("DIV"),e.addButton.className="timeline-navigation-new",e.addButton.title=b.CREATE_NEW_EVENT;
var h=document.createElement("SPAN");h.className="ui-icon ui-icon-circle-plus",e.addButton.appendChild(h);var i=function(c){links.Timeline.preventDefault(c),links.Timeline.stopPropagation(c);var d=a.size.contentWidth,e=d/2,f=a.screenToTime(e);b.snapEvents&&a.step.snap(f);var g=b.NEW,h=a.groups.length?a.groups[0].content:void 0,i=!0;a.addItem({start:f,content:g,group:h},i);var j=a.items.length-1;a.selectItem(j),a.applyAdd=!0,a.trigger("add"),a.applyAdd?(a.render({animate:!1}),a.selectItem(j)):a.deleteItem(j)};links.Timeline.addEventListener(e.addButton,"mousedown",i),e.appendChild(e.addButton)}if(f&&g&&links.Timeline.addClassName(e.addButton,"timeline-navigation-new-line"),g){if(b.zoomable){e.zoomInButton=document.createElement("DIV"),e.zoomInButton.className="timeline-navigation-zoom-in",e.zoomInButton.title=this.options.ZOOM_IN;var j=document.createElement("SPAN");j.className="ui-icon ui-icon-circle-zoomin",e.zoomInButton.appendChild(j);var k=function(b){links.Timeline.preventDefault(b),links.Timeline.stopPropagation(b),a.zoom(.4),a.trigger("rangechange"),a.trigger("rangechanged")};links.Timeline.addEventListener(e.zoomInButton,"mousedown",k),e.appendChild(e.zoomInButton),e.zoomOutButton=document.createElement("DIV"),e.zoomOutButton.className="timeline-navigation-zoom-out",e.zoomOutButton.title=this.options.ZOOM_OUT;var l=document.createElement("SPAN");l.className="ui-icon ui-icon-circle-zoomout",e.zoomOutButton.appendChild(l);var m=function(b){links.Timeline.preventDefault(b),links.Timeline.stopPropagation(b),a.zoom(-.4),a.trigger("rangechange"),a.trigger("rangechanged")};links.Timeline.addEventListener(e.zoomOutButton,"mousedown",m),e.appendChild(e.zoomOutButton)}if(b.moveable){e.moveLeftButton=document.createElement("DIV"),e.moveLeftButton.className="timeline-navigation-move-left",e.moveLeftButton.title=this.options.MOVE_LEFT;var n=document.createElement("SPAN");n.className="ui-icon ui-icon-circle-arrow-w",e.moveLeftButton.appendChild(n);var o=function(b){links.Timeline.preventDefault(b),links.Timeline.stopPropagation(b),a.move(-.2),a.trigger("rangechange"),a.trigger("rangechanged")};links.Timeline.addEventListener(e.moveLeftButton,"mousedown",o),e.appendChild(e.moveLeftButton),e.moveRightButton=document.createElement("DIV"),e.moveRightButton.className="timeline-navigation-move-right",e.moveRightButton.title=this.options.MOVE_RIGHT;var p=document.createElement("SPAN");p.className="ui-icon ui-icon-circle-arrow-e",e.moveRightButton.appendChild(p);var q=function(b){links.Timeline.preventDefault(b),links.Timeline.stopPropagation(b),a.move(.2),a.trigger("rangechange"),a.trigger("rangechanged")};links.Timeline.addEventListener(e.moveRightButton,"mousedown",q),e.appendChild(e.moveRightButton)}}}},links.Timeline.prototype.setCurrentTime=function(a){var b=new Date;this.clientTimeOffset=a.valueOf()-b.valueOf(),this.repaintCurrentTime()},links.Timeline.prototype.getCurrentTime=function(){var a=new Date;return new Date(a.valueOf()+this.clientTimeOffset)},links.Timeline.prototype.setCustomTime=function(a){this.customTime=new Date(a.valueOf()),this.repaintCustomTime()},links.Timeline.prototype.getCustomTime=function(){return new Date(this.customTime.valueOf())},links.Timeline.prototype.setScale=function(a,b){this.step.setScale(a,b),this.render()},links.Timeline.prototype.setAutoScale=function(a){this.step.setAutoScale(a),this.render()},links.Timeline.prototype.redraw=function(){this.setData(this.data)},links.Timeline.prototype.checkResize=function(){this.render()},links.Timeline.prototype.isEditable=function(a){return a?void 0!=a.editable?a.editable:this.options.editable:!1},links.Timeline.prototype.recalcConversion=function(){this.conversion.offset=this.start.valueOf(),this.conversion.factor=this.size.contentWidth/(this.end.valueOf()-this.start.valueOf())},links.Timeline.prototype.screenToTime=function(a){var b=this.conversion;return new Date(a/b.factor+b.offset)},links.Timeline.prototype.timeToScreen=function(a){var b=this.conversion;return(a.valueOf()-b.offset)*b.factor},links.Timeline.prototype.onTouchStart=function(a){var b=this.eventParams,c=this;if(!b.touchDown){b.touchDown=!0,b.zoomed=!1,this.onMouseDown(a),b.onTouchMove||(b.onTouchMove=function(a){c.onTouchMove(a)},links.Timeline.addEventListener(document,"touchmove",b.onTouchMove)),b.onTouchEnd||(b.onTouchEnd=function(a){c.onTouchEnd(a)},links.Timeline.addEventListener(document,"touchend",b.onTouchEnd));var d=links.Timeline.getTarget(a),e=this.getItemIndex(d);b.doubleTapStartPrev=b.doubleTapStart,b.doubleTapStart=(new Date).valueOf(),b.doubleTapItemPrev=b.doubleTapItem,b.doubleTapItem=e,links.Timeline.preventDefault(a)}},links.Timeline.prototype.onTouchMove=function(a){var b=this.eventParams;if(a.scale&&1!==a.scale&&(b.zoomed=!0),b.zoomed){if(this.options.zoomable){b.zoomed=!0;var c=a.scale,d=b.end.valueOf()-b.start.valueOf(),e=d/c,f=e-d,g=new Date(parseInt(b.start.valueOf()-f/2)),h=new Date(parseInt(b.end.valueOf()+f/2));this.setVisibleChartRange(g,h),this.trigger("rangechange")}}else this.onMouseMove(a);links.Timeline.preventDefault(a)},links.Timeline.prototype.onTouchEnd=function(a){var b=this.eventParams,c=this;b.touchDown=!1,b.zoomed&&this.trigger("rangechanged"),b.onTouchMove&&(links.Timeline.removeEventListener(document,"touchmove",b.onTouchMove),delete b.onTouchMove),b.onTouchEnd&&(links.Timeline.removeEventListener(document,"touchend",b.onTouchEnd),delete b.onTouchEnd),this.onMouseUp(a);var d=500,e=(new Date).valueOf(),f=links.Timeline.getTarget(a);this.getItemIndex(f),b.doubleTapStartPrev&&e-b.doubleTapStartPrev<d&&b.doubleTapItem==b.doubleTapItemPrev&&(b.touchDown=!0,c.onDblClick(a),b.touchDown=!1),links.Timeline.preventDefault(a)},links.Timeline.prototype.onMouseDown=function(a){a=a||window.event;var b=this.eventParams,c=this.options,d=this.dom,e=a.which?1==a.which:1==a.button;if(e||b.touchDown){b.mouseX=links.Timeline.getPageX(a),b.mouseY=links.Timeline.getPageY(a),b.frameLeft=links.Timeline.getAbsoluteLeft(this.dom.content),b.frameTop=links.Timeline.getAbsoluteTop(this.dom.content),b.previousLeft=0,b.previousOffset=0,b.moved=!1,b.start=new Date(this.start.valueOf()),b.end=new Date(this.end.valueOf()),b.target=links.Timeline.getTarget(a);var f=d.items&&d.items.dragLeft?d.items.dragLeft:void 0,g=d.items&&d.items.dragRight?d.items.dragRight:void 0;if(b.itemDragLeft=b.target===f,b.itemDragRight=b.target===g,b.itemDragLeft||b.itemDragRight?(b.itemIndex=this.selection&&void 0!==this.selection.index?this.selection.index:void 0,delete b.clusterIndex):(b.itemIndex=this.getItemIndex(b.target),b.clusterIndex=this.getClusterIndex(b.target)),b.customTime=b.target===d.customTime||b.target.parentNode===d.customTime?this.customTime:void 0,b.addItem=c.editable&&a.ctrlKey,b.addItem){var h=b.mouseX-b.frameLeft,i=b.mouseY-b.frameTop,j=this.screenToTime(h);c.snapEvents&&this.step.snap(j);var k=new Date(j.valueOf()),l=c.NEW,m=this.getGroupFromHeight(i);this.addItem({start:j,end:k,content:l,group:this.getGroupName(m)}),b.itemIndex=this.items.length-1,delete b.clusterIndex,this.selectItem(b.itemIndex),b.itemDragRight=!0}var n=this.items[b.itemIndex],o=this.isSelected(b.itemIndex);if(b.editItem=o&&this.isEditable(n),b.editItem?(b.itemStart=n.start,b.itemEnd=n.end,b.itemGroup=n.group,b.itemLeft=n.getLeft(this),b.itemRight=n.getRight(this)):this.dom.frame.style.cursor="move",!b.touchDown){var p=this;b.onMouseMove||(b.onMouseMove=function(a){p.onMouseMove(a)},links.Timeline.addEventListener(document,"mousemove",b.onMouseMove)),b.onMouseUp||(b.onMouseUp=function(a){p.onMouseUp(a)},links.Timeline.addEventListener(document,"mouseup",b.onMouseUp)),links.Timeline.preventDefault(a)}}},links.Timeline.prototype.onMouseMove=function(a){a=a||window.event;var b=this.eventParams,c=this.size,d=this.dom,e=this.options,f=links.Timeline.getPageX(a),g=links.Timeline.getPageY(a);void 0==b.mouseX&&(b.mouseX=f),void 0==b.mouseY&&(b.mouseY=g);var h=f-b.mouseX,i=g-b.mouseY;if(Math.abs(i)>=1&&(newy=$.mobile.window.scrollTop(),$.mobile.window.scrollTop(newy-i)),Math.abs(h)>=1&&(b.moved=!0),b.customTime){var j=this.timeToScreen(b.customTime),k=j+h;this.customTime=this.screenToTime(k),this.repaintCustomTime(),this.trigger("timechange")}else if(b.editItem){var l,m,n=this.items[b.itemIndex];b.itemDragLeft&&e.timeChangeable?(l=b.itemLeft+h,m=b.itemRight,n.start=this.screenToTime(l),e.snapEvents&&(this.step.snap(n.start),l=this.timeToScreen(n.start)),l>m&&(l=m,n.start=this.screenToTime(l)),this.trigger("change")):b.itemDragRight&&e.timeChangeable?(l=b.itemLeft,m=b.itemRight+h,n.end=this.screenToTime(m),e.snapEvents&&(this.step.snap(n.end),m=this.timeToScreen(n.end)),l>m&&(m=l,n.end=this.screenToTime(m)),this.trigger("change")):e.timeChangeable&&(l=b.itemLeft+h,n.start=this.screenToTime(l),e.snapEvents&&(this.step.snap(n.start),l=this.timeToScreen(n.start)),n.end&&(m=l+(b.itemRight-b.itemLeft),n.end=this.screenToTime(m)),this.trigger("change")),n.setPosition(l,m);var o=b.itemDragLeft||b.itemDragRight;if(this.groups.length&&!o){var p=g-b.frameTop,q=this.getGroupFromHeight(p);if(e.groupsChangeable&&n.group!==q){var r=this.items.indexOf(n);this.changeItem(r,{group:this.getGroupName(q)})}else this.repaintDeleteButton(),this.repaintDragAreas()}else this.render()}else if(e.moveable){var s=b.end.valueOf()-b.start.valueOf(),t=Math.round(-h/c.contentWidth*s),u=new Date(b.start.valueOf()+t),v=new Date(b.end.valueOf()+t);this.applyRange(u,v);var w=this.start.valueOf()-u.valueOf();w&&(t+=w),this.recalcConversion();var x=b.previousLeft||0,y=parseFloat(d.items.frame.style.left)||0,z=b.previousOffset||0,A=z+(y-x),B=-t/s*c.contentWidth+A;d.items.frame.style.left=B+"px",b.previousOffset=A,b.previousLeft=parseFloat(d.items.frame.style.left)||B,this.repaintCurrentTime(),this.repaintCustomTime(),this.repaintAxis(),this.trigger("rangechange")}links.Timeline.preventDefault(a)},links.Timeline.prototype.onMouseUp=function(a){var b=this.eventParams,c=this.options;if(a=a||window.event,this.dom.frame.style.cursor="auto",b.onMouseMove&&(links.Timeline.removeEventListener(document,"mousemove",b.onMouseMove),delete b.onMouseMove),b.onMouseUp&&(links.Timeline.removeEventListener(document,"mouseup",b.onMouseUp),delete b.onMouseUp),b.customTime)this.trigger("timechanged");else if(b.editItem){var d=this.items[b.itemIndex];if(b.moved||b.addItem){if(this.applyChange=!0,this.applyAdd=!0,this.updateData(b.itemIndex,{start:d.start,end:d.end}),this.trigger(b.addItem?"add":"changed"),d=this.items[b.itemIndex],b.addItem)this.applyAdd?this.updateData(b.itemIndex,{start:d.start,end:d.end,content:d.content,group:this.getGroupName(d.group)}):this.deleteItem(b.itemIndex);else if(this.applyChange)this.updateData(b.itemIndex,{start:d.start,end:d.end});else{delete this.applyChange,delete this.applyAdd;var d=this.items[b.itemIndex];d.dom,d.start=b.itemStart,d.end=b.itemEnd,d.group=b.itemGroup,d.setPosition(b.itemLeft,b.itemRight),this.updateData(b.itemIndex,{start:b.itemStart,end:b.itemEnd})}this.options.cluster&&this.clusterGenerator.updateData(),this.render()}}else b.moved||b.zoomed?(this.render(),(b.moved&&c.moveable||b.zoomed&&c.zoomable)&&this.trigger("rangechanged")):b.target===this.dom.items.deleteButton?this.selection&&void 0!==this.selection.index&&this.confirmDeleteItem(this.selection.index):c.selectable&&(void 0!=b.itemIndex?this.isSelected(b.itemIndex)||(this.selectItem(b.itemIndex),this.trigger("select")):void 0!=b.clusterIndex?(this.selectCluster(b.clusterIndex),this.trigger("select")):c.unselectable&&(this.unselectItem(),this.trigger("select")))},links.Timeline.prototype.onDblClick=function(a){var b=this.eventParams,c=this.options,d=this.dom;if(this.size,a=a||window.event,void 0!=b.itemIndex){var e=this.items[b.itemIndex];e&&this.isEditable(e)&&this.trigger("edit")}else if(c.editable){b.mouseX=links.Timeline.getPageX(a),b.mouseY=links.Timeline.getPageY(a);var f=b.mouseX-links.Timeline.getAbsoluteLeft(d.content),g=b.mouseY-links.Timeline.getAbsoluteTop(d.content),h=this.screenToTime(f);c.snapEvents&&this.step.snap(h);var i=c.NEW,j=this.getGroupFromHeight(g),k=!0;this.addItem({start:h,content:i,group:this.getGroupName(j)},k),b.itemIndex=this.items.length-1,this.selectItem(b.itemIndex),this.applyAdd=!0,this.trigger("add"),this.applyAdd?(this.render({animate:!1}),this.selectItem(b.itemIndex)):this.deleteItem(b.itemIndex)}links.Timeline.preventDefault(a)},links.Timeline.prototype.onMouseWheel=function(a){if(this.options.zoomable){a||(a=window.event);var b=0;if(a.wheelDelta?b=a.wheelDelta/120:a.detail&&(b=-a.detail/3),b){var c=this,d=function(){var d=b/5,e=links.Timeline.getAbsoluteLeft(c.dom.content),f=links.Timeline.getPageX(a),g=void 0!=f&&void 0!=e?c.screenToTime(f-e):void 0;c.zoom(d,g),c.trigger("rangechange"),c.trigger("rangechanged")},e=function(){c.move(b*-.2),c.trigger("rangechange"),c.trigger("rangechanged")};a.shiftKey?e():d()}links.Timeline.preventDefault(a)}},links.Timeline.prototype.zoom=function(a,b){void 0==b&&(b=new Date((this.start.valueOf()+this.end.valueOf())/2)),a>=1&&(a=.9),-1>=a&&(a=-.9),0>a&&(a/=1+a);var c=this.start.valueOf()-b,d=this.end.valueOf()-b,e=new Date(this.start.valueOf()-c*a),f=new Date(this.end.valueOf()-d*a),g=f.valueOf()-e.valueOf(),h=Number(this.options.zoomMin)||10;10>h&&(h=10),g>=h&&(this.applyRange(e,f,b),this.render({animate:this.options.animate&&this.options.animateZoom}))},links.Timeline.prototype.move=function(a){var b=this.end.valueOf()-this.start.valueOf(),c=new Date(this.start.valueOf()+b*a),d=new Date(this.end.valueOf()+b*a);this.applyRange(c,d),this.render()},links.Timeline.prototype.applyRange=function(a,b,c){var d=a.valueOf(),e=b.valueOf(),f=e-d,g=this.options,h=31536e6,i=Number(g.zoomMin)||10;10>i&&(i=10);var j=Number(g.zoomMax)||1e4*h;j>1e4*h&&(j=1e4*h),i>j&&(j=i);var k=g.min?g.min.valueOf():void 0,l=g.max?g.max.valueOf():void 0;if(void 0!=k&&void 0!=l){if(k>=l){var m=864e5;l=k+m}j>l-k&&(j=l-k),i>l-k&&(i=l-k)}if(d>=e&&(e+=864e5),i>f){var n=i-f,o=c?(c.valueOf()-d)/f:.5;d-=Math.round(n*o),e+=Math.round(n*(1-o))}if(f>j){var n=f-j,o=c?(c.valueOf()-d)/f:.5;d+=Math.round(n*o),e-=Math.round(n*(1-o))}if(void 0!=k){var n=d-k;0>n&&(d-=n,e-=n)}if(void 0!=l){var n=l-e;0>n&&(d+=n,e+=n)}this.start=new Date(d),this.end=new Date(e)},links.Timeline.prototype.confirmDeleteItem=function(a){this.applyDelete=!0,this.isSelected(a)||this.selectItem(a),this.trigger("delete"),this.applyDelete&&this.deleteItem(a),delete this.applyDelete},links.Timeline.prototype.deleteItem=function(a,b){if(a>=this.items.length)throw"Cannot delete row, index out of range";this.selection&&void 0!==this.selection.index&&(this.selection.index==a?this.unselectItem():this.selection.index>a&&this.selection.index--);var c=this.items.splice(a,1)[0];if(this.renderQueue.hide.push(c),this.data)if(google&&google.visualization&&this.data instanceof google.visualization.DataTable)this.data.removeRow(a);else{if(!links.Timeline.isArray(this.data))throw"Cannot delete row from data, unknown data type";this.data.splice(a,1)}this.options.cluster&&this.clusterGenerator.updateData(),b||this.render()},links.Timeline.prototype.deleteAllItems=function(){if(this.unselectItem(),this.clearItems(),this.deleteGroups(),this.data)if(google&&google.visualization&&this.data instanceof google.visualization.DataTable)this.data.removeRows(0,this.data.getNumberOfRows());else{if(!links.Timeline.isArray(this.data))throw"Cannot delete row from data, unknown data type";this.data.splice(0,this.data.length)}this.options.cluster&&this.clusterGenerator.updateData(),this.render()},links.Timeline.prototype.getGroupFromHeight=function(a){var b,c,d=this.groups;if(d.length){if(this.options.axisOnTop){for(b=d.length-1;b>=0;b--)if(c=d[b],a>c.top)return c}else for(b=0;b<d.length;b++)if(c=d[b],a>c.top)return c;return c}return void 0},links.Timeline.Item=function(a,b){if(a&&(this.start=a.start,this.end=a.end,this.content=a.content,this.className=a.className,this.editable=a.editable,this.group=a.group,this.type=a.type),this.top=0,this.left=0,this.width=0,this.height=0,this.lineWidth=0,this.dotWidth=0,this.dotHeight=0,this.rendered=!1,b)for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])},links.Timeline.Item.prototype.reflow=function(){return!1},links.Timeline.Item.prototype.getImageUrls=function(a){this.dom&&links.imageloader.filterImageUrls(this.dom,a)},links.Timeline.Item.prototype.select=function(){},links.Timeline.Item.prototype.unselect=function(){},links.Timeline.Item.prototype.createDOM=function(){},links.Timeline.Item.prototype.showDOM=function(){},links.Timeline.Item.prototype.hideDOM=function(){},links.Timeline.Item.prototype.updateDOM=function(){},links.Timeline.Item.prototype.updatePosition=function(){},links.Timeline.Item.prototype.isRendered=function(){return this.rendered},links.Timeline.Item.prototype.isVisible=function(){return!1},links.Timeline.Item.prototype.setPosition=function(){},links.Timeline.Item.prototype.getLeft=function(){return 0},links.Timeline.Item.prototype.getRight=function(){return 0},links.Timeline.Item.prototype.getWidth=function(){return this.width||0},links.Timeline.ItemBox=function(a,b){links.Timeline.Item.call(this,a,b)},links.Timeline.ItemBox.prototype=new links.Timeline.Item,links.Timeline.ItemBox.prototype.reflow=function(){var a=this.dom,b=a.dot.offsetHeight,c=a.dot.offsetWidth,d=a.line.offsetWidth,e=this.dotHeight!=b||this.dotWidth!=c||this.lineWidth!=d;return this.dotHeight=b,this.dotWidth=c,this.lineWidth=d,e},links.Timeline.ItemBox.prototype.select=function(){var a=this.dom;links.Timeline.addClassName(a,"timeline-event-selected ui-state-active"),links.Timeline.addClassName(a.line,"timeline-event-selected ui-state-active"),links.Timeline.addClassName(a.dot,"timeline-event-selected ui-state-active")},links.Timeline.ItemBox.prototype.unselect=function(){var a=this.dom;links.Timeline.removeClassName(a,"timeline-event-selected ui-state-active"),links.Timeline.removeClassName(a.line,"timeline-event-selected ui-state-active"),links.Timeline.removeClassName(a.dot,"timeline-event-selected ui-state-active")},links.Timeline.ItemBox.prototype.createDOM=function(){var a=document.createElement("DIV");a.style.position="absolute",a.style.left=this.left+"px",a.style.top=this.top+"px";var b=document.createElement("DIV");b.className="timeline-event-content",b.innerHTML=this.content,a.appendChild(b);var c=document.createElement("DIV");c.style.position="absolute",c.style.width="0px",a.line=c;var d=document.createElement("DIV");return d.style.position="absolute",d.style.width="0px",d.style.height="0px",a.dot=d,this.dom=a,this.updateDOM(),a},links.Timeline.ItemBox.prototype.showDOM=function(a){var b=this.dom;b||(b=this.createDOM()),b.parentNode!=a&&(b.parentNode&&this.hideDOM(),a.appendChild(b),a.insertBefore(b.line,a.firstChild),a.appendChild(b.dot),this.rendered=!0)},links.Timeline.ItemBox.prototype.hideDOM=function(){var a=this.dom;a&&(a.parentNode&&a.parentNode.removeChild(a),a.line&&a.line.parentNode&&a.line.parentNode.removeChild(a.line),a.dot&&a.dot.parentNode&&a.dot.parentNode.removeChild(a.dot),this.rendered=!1)},links.Timeline.ItemBox.prototype.updateDOM=function(){var a=this.dom;if(a){var b=a.line,c=a.dot;a.firstChild.innerHTML=this.content,a.className="timeline-event timeline-event-box ui-widget ui-state-default",b.className="timeline-event timeline-event-line ui-widget ui-state-default",c.className="timeline-event timeline-event-dot ui-widget ui-state-default",this.isCluster&&(links.Timeline.addClassName(a,"timeline-event-cluster ui-widget-header"),links.Timeline.addClassName(b,"timeline-event-cluster ui-widget-header"),links.Timeline.addClassName(c,"timeline-event-cluster ui-widget-header")),this.className&&(links.Timeline.addClassName(a,this.className),links.Timeline.addClassName(b,this.className),links.Timeline.addClassName(c,this.className))}},links.Timeline.ItemBox.prototype.updatePosition=function(a){var b=this.dom;if(b){var c=a.timeToScreen(this.start),d=a.options.axisOnTop,e=a.size.axis.top,f=a.size.axis.height,g=a.options.box&&a.options.box.align?a.options.box.align:void 0;b.style.top=this.top+"px",b.style.left="right"==g?c-this.width+"px":"left"==g?c+"px":c-this.width/2+"px";var h=b.line,i=b.dot;h.style.left=c-this.lineWidth/2+"px",i.style.left=c-this.dotWidth/2+"px",d?(h.style.top=f+"px",h.style.height=Math.max(this.top-f,0)+"px",i.style.top=f-this.dotHeight/2+"px"):(h.style.top=this.top+this.height+"px",h.style.height=Math.max(e-this.top-this.height,0)+"px",i.style.top=e-this.dotHeight/2+"px")}},links.Timeline.ItemBox.prototype.isVisible=function(a,b){return this.cluster?!1:this.start>a&&this.start<b},links.Timeline.ItemBox.prototype.setPosition=function(a){var b=this.dom;b.style.left=a-this.width/2+"px",b.line.style.left=a-this.lineWidth/2+"px",b.dot.style.left=a-this.dotWidth/2+"px",this.group&&(this.top=this.group.top,b.style.top=this.top+"px")},links.Timeline.ItemBox.prototype.getLeft=function(a){var b=a.options.box&&a.options.box.align?a.options.box.align:void 0,c=a.timeToScreen(this.start);return c-="right"==b?width:this.width/2},links.Timeline.ItemBox.prototype.getRight=function(a){var b,c=a.options.box&&a.options.box.align?a.options.box.align:void 0,d=a.timeToScreen(this.start);return b="right"==c?d:"left"==c?d+this.width:d+this.width/2},links.Timeline.ItemRange=function(a,b){links.Timeline.Item.call(this,a,b)},links.Timeline.ItemRange.prototype=new links.Timeline.Item,links.Timeline.ItemRange.prototype.select=function(){var a=this.dom;links.Timeline.addClassName(a,"timeline-event-selected ui-state-active")},links.Timeline.ItemRange.prototype.unselect=function(){var a=this.dom;links.Timeline.removeClassName(a,"timeline-event-selected ui-state-active")},links.Timeline.ItemRange.prototype.createDOM=function(){var a=document.createElement("DIV");a.style.position="absolute";var b=document.createElement("DIV");return b.className="timeline-event-content",a.appendChild(b),this.dom=a,this.updateDOM(),a},links.Timeline.ItemRange.prototype.showDOM=function(a){var b=this.dom;b||(b=this.createDOM()),b.parentNode!=a&&(b.parentNode&&this.hideDOM(),a.appendChild(b),this.rendered=!0)},links.Timeline.ItemRange.prototype.hideDOM=function(){var a=this.dom;a&&(a.parentNode&&a.parentNode.removeChild(a),this.rendered=!1)},links.Timeline.ItemRange.prototype.updateDOM=function(){var a=this.dom;a&&(a.firstChild.innerHTML=this.content,a.className="timeline-event timeline-event-range ui-widget ui-state-default",this.isCluster&&links.Timeline.addClassName(a,"timeline-event-cluster ui-widget-header"),this.className&&links.Timeline.addClassName(a,this.className))},links.Timeline.ItemRange.prototype.updatePosition=function(a){var b=this.dom;if(b){var c=a.size.contentWidth,d=a.timeToScreen(this.start),e=a.timeToScreen(this.end);-c>d&&(d=-c),e>2*c&&(e=2*c),b.style.top=this.top+"px",b.style.left=d+"px",b.style.width=Math.max(e-d,1)+"px"}},links.Timeline.ItemRange.prototype.isVisible=function(a,b){return this.cluster?!1:this.end>a&&this.start<b},links.Timeline.ItemRange.prototype.setPosition=function(a,b){var c=this.dom;c.style.left=a+"px",c.style.width=b-a+"px",this.group&&(this.top=this.group.top,c.style.top=this.top+"px")},links.Timeline.ItemRange.prototype.getLeft=function(a){return a.timeToScreen(this.start)},links.Timeline.ItemRange.prototype.getRight=function(a){return a.timeToScreen(this.end)},links.Timeline.ItemRange.prototype.getWidth=function(a){return a.timeToScreen(this.end)-a.timeToScreen(this.start)},links.Timeline.ItemFloatingRange=function(a,b){links.Timeline.Item.call(this,a,b)},links.Timeline.ItemFloatingRange.prototype=new links.Timeline.Item,links.Timeline.ItemFloatingRange.prototype.select=function(){var a=this.dom;links.Timeline.addClassName(a,"timeline-event-selected ui-state-active")},links.Timeline.ItemFloatingRange.prototype.unselect=function(){var a=this.dom;links.Timeline.removeClassName(a,"timeline-event-selected ui-state-active")},links.Timeline.ItemFloatingRange.prototype.createDOM=function(){var a=document.createElement("DIV");a.style.position="absolute";var b=document.createElement("DIV");return b.className="timeline-event-content",a.appendChild(b),this.dom=a,this.updateDOM(),a},links.Timeline.ItemFloatingRange.prototype.showDOM=function(a){var b=this.dom;b||(b=this.createDOM()),b.parentNode!=a&&(b.parentNode&&this.hideDOM(),a.appendChild(b),this.rendered=!0)},links.Timeline.ItemFloatingRange.prototype.hideDOM=function(){var a=this.dom;a&&(a.parentNode&&a.parentNode.removeChild(a),this.rendered=!1)},links.Timeline.ItemFloatingRange.prototype.updateDOM=function(){var a=this.dom;a&&(a.firstChild.innerHTML=this.content,a.className="timeline-event timeline-event-range ui-widget ui-state-default",this.isCluster&&links.Timeline.addClassName(a,"timeline-event-cluster ui-widget-header"),this.className&&links.Timeline.addClassName(a,this.className))},links.Timeline.ItemFloatingRange.prototype.updatePosition=function(a){var b=this.dom;if(b){var c=a.size.contentWidth,d=this.getLeft(a),e=this.getRight(a);-c>d&&(d=-c),e>2*c&&(e=2*c),b.style.top=this.top+"px",b.style.left=d+"px",b.style.width=Math.max(e-d,1)+"px"}},links.Timeline.ItemFloatingRange.prototype.isVisible=function(a,b){return this.cluster?!1:this.end&&this.start?this.end>a&&this.start<b:this.start?this.start<b:this.end?this.end>a:!0},links.Timeline.ItemFloatingRange.prototype.setPosition=function(a,b){var c=this.dom;c.style.left=a+"px",c.style.width=b-a+"px",this.group&&(this.top=this.group.top,c.style.top=this.top+"px")},links.Timeline.ItemFloatingRange.prototype.getLeft=function(a){return this.start?a.timeToScreen(this.start):0},links.Timeline.ItemFloatingRange.prototype.getRight=function(a){return this.end?a.timeToScreen(this.end):a.size.contentWidth},links.Timeline.ItemFloatingRange.prototype.getWidth=function(a){return this.getRight(a)-this.getLeft(a)},links.Timeline.ItemDot=function(a,b){links.Timeline.Item.call(this,a,b)},links.Timeline.ItemDot.prototype=new links.Timeline.Item,links.Timeline.ItemDot.prototype.reflow=function(){var a=this.dom,b=a.dot.offsetHeight,c=a.dot.offsetWidth,d=a.content.offsetHeight,e=this.dotHeight!=b||this.dotWidth!=c||this.contentHeight!=d;return this.dotHeight=b,this.dotWidth=c,this.contentHeight=d,e},links.Timeline.ItemDot.prototype.select=function(){var a=this.dom;links.Timeline.addClassName(a,"timeline-event-selected ui-state-active")},links.Timeline.ItemDot.prototype.unselect=function(){var a=this.dom;links.Timeline.removeClassName(a,"timeline-event-selected ui-state-active")},links.Timeline.ItemDot.prototype.createDOM=function(){var a=document.createElement("DIV");a.style.position="absolute";var b=document.createElement("DIV");b.className="timeline-event-content",a.appendChild(b);var c=document.createElement("DIV");return c.style.position="absolute",c.style.width="0px",c.style.height="0px",a.appendChild(c),a.content=b,a.dot=c,this.dom=a,this.updateDOM(),a},links.Timeline.ItemDot.prototype.showDOM=function(a){var b=this.dom;b||(b=this.createDOM()),b.parentNode!=a&&(b.parentNode&&this.hideDOM(),a.appendChild(b),this.rendered=!0)},links.Timeline.ItemDot.prototype.hideDOM=function(){var a=this.dom;a&&(a.parentNode&&a.parentNode.removeChild(a),this.rendered=!1)},links.Timeline.ItemDot.prototype.updateDOM=function(){if(this.dom){var a=this.dom,b=a.dot;a.firstChild.innerHTML=this.content,a.className="timeline-event-dot-container",b.className="timeline-event timeline-event-dot ui-widget ui-state-default",this.isCluster&&(links.Timeline.addClassName(a,"timeline-event-cluster ui-widget-header"),links.Timeline.addClassName(b,"timeline-event-cluster ui-widget-header")),this.className&&(links.Timeline.addClassName(a,this.className),links.Timeline.addClassName(b,this.className))}},links.Timeline.ItemDot.prototype.updatePosition=function(a){var b=this.dom;if(b){var c=a.timeToScreen(this.start);b.style.top=this.top+"px",b.style.left=c-this.dotWidth/2+"px",b.content.style.marginLeft=1.5*this.dotWidth+"px",b.dot.style.top=(this.height-this.dotHeight)/2+"px"}},links.Timeline.ItemDot.prototype.isVisible=function(a,b){return this.cluster?!1:this.start>a&&this.start<b},links.Timeline.ItemDot.prototype.setPosition=function(a){var b=this.dom;b.style.left=a-this.dotWidth/2+"px",this.group&&(this.top=this.group.top,b.style.top=this.top+"px")},links.Timeline.ItemDot.prototype.getLeft=function(a){return a.timeToScreen(this.start)},links.Timeline.ItemDot.prototype.getRight=function(a){return a.timeToScreen(this.start)+this.width},links.Timeline.prototype.getItem=function(a){if(a>=this.items.length)throw"Cannot get item, index out of range";var b,c=this.data;if(google&&google.visualization&&c instanceof google.visualization.DataTable){var d=links.Timeline.mapColumnIds(c);b={};for(var e in d)d.hasOwnProperty(e)&&(b[e]=this.data.getValue(a,d[e]))}else{if(!links.Timeline.isArray(this.data))throw"Unknown data type. DataTable or Array expected.";b=links.Timeline.clone(this.data[a])}var f=this.items[a];return b.start=new Date(f.start.valueOf()),f.end&&(b.end=new Date(f.end.valueOf())),b.content=f.content,f.group&&(b.group=this.getGroupName(f.group)),f.className&&(b.className=f.className),"undefined"!=typeof f.editable&&(b.editable=f.editable),f.type&&(b.type=f.type),b},links.Timeline.prototype.getCluster=function(a){if(a>=this.clusters.length)throw"Cannot get cluster, index out of range";var b={},c=this.clusters[a],d=c.items;b.start=new Date(c.start.valueOf()),c.type&&(b.type=c.type),b.items=[];for(var e=0;e<d.length;e++)for(var f=0;f<this.items.length;f++)if(this.items[f]==d[e]){b.items.push(this.getItem(f));break}return b},links.Timeline.prototype.addItem=function(a,b){var c=[a];this.addItems(c,b)},links.Timeline.prototype.addItems=function(a,b){var c=this,d=this.items;a.forEach(function(a){var b=d.length;d.push(c.createItem(a)),c.updateData(b,a)}),this.options.cluster&&this.clusterGenerator.updateData(),b||this.render({animate:!1})},links.Timeline.prototype.createItem=function(a){var b=a.type||(a.end?"range":this.options.style),c=links.Timeline.clone(a);c.type=b,c.group=this.getGroup(a.group);var d,e=this.options;return d=e.axisOnTop?this.size.axis.height+e.eventMarginAxis+e.eventMargin/2:this.size.contentHeight-e.eventMarginAxis-e.eventMargin/2,b in this.itemTypes?new this.itemTypes[b](c,{top:d}):(console.log('ERROR: Unknown event type "'+b+'"'),new links.Timeline.Item(c,{top:d}))},links.Timeline.prototype.changeItem=function(a,b,c){var d=this.items[a];if(!d)throw"Cannot change item, index out of range";var e=this.createItem({start:b.hasOwnProperty("start")?b.start:d.start,end:b.hasOwnProperty("end")?b.end:d.end,content:b.hasOwnProperty("content")?b.content:d.content,group:b.hasOwnProperty("group")?b.group:this.getGroupName(d.group),className:b.hasOwnProperty("className")?b.className:d.className,editable:b.hasOwnProperty("editable")?b.editable:d.editable,type:b.hasOwnProperty("type")?b.type:d.type});this.items[a]=e,this.renderQueue.hide.push(d),this.renderQueue.show.push(e),this.updateData(a,b),this.options.cluster&&this.clusterGenerator.updateData(),c||(this.render({animate:!1}),this.selection&&this.selection.index==a&&e.select())},links.Timeline.prototype.deleteGroups=function(){this.groups=[],this.groupIndexes={}},links.Timeline.prototype.getGroup=function(a){var b=this.groups,c=this.groupIndexes,d=void 0,e=c[a];if(void 0==e&&void 0!=a){d={content:a,labelTop:0,lineTop:0},b.push(d),1==this.options.groupsOrder?b=b.sort(function(a,b){return a.content>b.content?1:a.content<b.content?-1:0}):"function"==typeof this.options.groupsOrder&&(b=b.sort(this.options.groupsOrder));for(var f=0,g=b.length;g>f;f++)c[b[f].content]=f}else d=b[e];return d},links.Timeline.prototype.getGroupName=function(a){return a?a.content:void 0},links.Timeline.prototype.cancelChange=function(){this.applyChange=!1},links.Timeline.prototype.cancelDelete=function(){this.applyDelete=!1},links.Timeline.prototype.cancelAdd=function(){this.applyAdd=!1},links.Timeline.prototype.setSelection=function(a){if(void 0!=a&&a.length>0){if(void 0!=a[0].row){var b=a[0].row;if(this.items[b]){var c=this.items[b];
this.selectItem(b);var d,e=c.start,f=c.end;d=void 0!=f?(f.valueOf()+e.valueOf())/2:e.valueOf();var g=this.end.valueOf()-this.start.valueOf(),h=new Date(d-g/2),i=new Date(d+g/2);return this.setVisibleChartRange(h,i),!0}}}else this.unselectItem();return!1},links.Timeline.prototype.getSelection=function(){var a=[];return this.selection&&a.push(void 0!==this.selection.index?{row:this.selection.index}:{cluster:this.selection.cluster}),a},links.Timeline.prototype.selectItem=function(a){if(this.unselectItem(),this.selection=void 0,void 0!=this.items[a]){var b=this.items[a];b.dom,this.selection={index:a},b&&b.dom&&(this.isEditable(b)&&(b.dom.style.cursor="move"),b.select()),this.repaintDeleteButton(),this.repaintDragAreas()}},links.Timeline.prototype.selectCluster=function(a){this.unselectItem(),this.selection=void 0,void 0!=this.clusters[a]&&(this.selection={cluster:a},this.repaintDeleteButton(),this.repaintDragAreas())},links.Timeline.prototype.isSelected=function(a){return this.selection&&this.selection.index==a},links.Timeline.prototype.unselectItem=function(){if(this.selection&&void 0!==this.selection.index){var a=this.items[this.selection.index];if(a&&a.dom){var b=a.dom;b.style.cursor="",a.unselect()}this.selection=void 0,this.repaintDeleteButton(),this.repaintDragAreas()}},links.Timeline.prototype.stackItems=function(a){void 0==a&&(a=!1);var b=this.stack;if(b||(b={},this.stack=b),b.sortedItems=this.stackOrder(this.renderedItems),b.finalItems=this.stackCalculateFinal(b.sortedItems),a||b.timer){var c=this,d=function(){var a=c.stackMoveOneStep(b.sortedItems,b.finalItems);c.repaint(),a?delete b.timer:b.timer=setTimeout(d,30)};b.timer||(b.timer=setTimeout(d,30))}else this.stackMoveToFinal(b.sortedItems,b.finalItems)},links.Timeline.prototype.stackCancelAnimation=function(){this.stack&&this.stack.timer&&(clearTimeout(this.stack.timer),delete this.stack.timer)},links.Timeline.prototype.getItemsByGroup=function(a){for(var b={},c=0;c<a.length;++c){var d=a[c],e="undefined";d.group&&(e=d.group.content?d.group.content:d.group),b[e]||(b[e]=[]),b[e].push(d)}return b},links.Timeline.prototype.stackOrder=function(a){var b=a.concat([]),c=this.options.customStackOrder&&"function"==typeof this.options.customStackOrder?this.options.customStackOrder:function(a,b){return(a instanceof links.Timeline.ItemRange||a instanceof links.Timeline.ItemFloatingRange)&&!(b instanceof links.Timeline.ItemRange||b instanceof links.Timeline.ItemFloatingRange)?-1:a instanceof links.Timeline.ItemRange||a instanceof links.Timeline.ItemFloatingRange||!(b instanceof links.Timeline.ItemRange||b instanceof links.Timeline.ItemFloatingRange)?a.left-b.left:1};return b.sort(c),b},links.Timeline.prototype.stackCalculateFinal=function(a){var b,c,d=this.size,e=this.options,f=e.axisOnTop,g=e.eventMargin,h=e.eventMarginAxis,i=f?d.axis.height+h+g/2:d.contentHeight-h-g/2,k=[];for(b=this.getItemsByGroup(a),j=0;j<this.groups.length;++j){var l=this.groups[j];b[l.content]?(c=this.finalItemsPosition(b[l.content],i,l),c.forEach(function(a){k.push(a)}),f?i+=l.itemsHeight+g:i-=l.itemsHeight+g):f?i+=e.groupMinHeight+g:i-=e.groupMinHeight+g}return b.undefined&&(c=this.finalItemsPosition(b.undefined,i),c.forEach(function(a){k.push(a)})),k},links.Timeline.prototype.finalItemsPosition=function(a,b,c){var d,e,f,g=this.options,h=g.axisOnTop,i=g.eventMargin;for(f=this.initialItemsPosition(a,b),d=0,e=f.length;e>d;d++){var j=f[d],k=null;if(this.options.stackEvents)do k=this.stackItemsCheckOverlap(f,d,0,d-1),null!=k&&(j.top=h?k.top+k.height+i:k.top-j.height-i,j.bottom=j.top+j.height);while(k);c&&(c.itemsHeight=h?c.itemsHeight?Math.max(c.itemsHeight,j.bottom-b):j.height+i:c.itemsHeight?Math.max(c.itemsHeight,b-j.top):j.height+i)}return f},links.Timeline.prototype.initialItemsPosition=function(a,b){for(var c=this.options,d=c.axisOnTop,e=[],f=0,g=a.length;g>f;++f){var h,i,j=a[f],k=j.height,l=j.getWidth(this),m=j.getRight(this),n=m-l;h=d?b:b-k,i=h+k,e.push({left:n,top:h,right:m,bottom:i,height:k,item:j})}return e},links.Timeline.prototype.stackMoveOneStep=function(a,b){for(var c=!0,d=0,e=b.length;e>d;d++){var f=b[d],g=f.item,h=parseInt(g.top),i=parseInt(f.top),j=i-h;if(j){var k=i==h?0:i>h?1:-1;Math.abs(j)>4&&(k=j/4);var l=parseInt(h+k);l!=i&&(c=!1),g.top=l,g.bottom=g.top+g.height}else g.top=f.top,g.bottom=f.bottom;g.left=f.left,g.right=f.right}return c},links.Timeline.prototype.stackMoveToFinal=function(a,b){for(var c=0,d=b.length;d>c;c++){var e=b[c],f=e.item;f.left=e.left,f.top=e.top,f.right=e.right,f.bottom=e.bottom}},links.Timeline.prototype.stackItemsCheckOverlap=function(a,b,c,d){for(var e=this.options.eventMargin,f=this.collision,g=a[b],h=d;h>=c;h--){var i=a[h];if(f(g,i,e)&&h!=b)return i}return void 0},links.Timeline.prototype.collision=function(a,b,c){return void 0==c&&(c=0),a.left-c<b.right&&a.right+c>b.left&&a.top-c<b.bottom&&a.bottom+c>b.top},links.Timeline.prototype.trigger=function(a){var b=null;switch(a){case"rangechange":case"rangechanged":b={start:new Date(this.start.valueOf()),end:new Date(this.end.valueOf())};break;case"timechange":case"timechanged":b={time:new Date(this.customTime.valueOf())}}links.events.trigger(this,a,b),google&&google.visualization&&google.visualization.events.trigger(this,a,b)},links.Timeline.prototype.clusterItems=function(){if(this.options.cluster){var a=this.clusterGenerator.getClusters(this.conversion.factor,this.options.clusterMaxItems);if(this.clusters!=a){var b=this.renderQueue;this.clusters&&this.clusters.forEach(function(a){b.hide.push(a),a.items.forEach(function(a){a.cluster=void 0})}),a.forEach(function(a){a.items.forEach(function(b){b.cluster=a})}),this.clusters=a}}},links.Timeline.prototype.filterItems=function(){function a(a){a.forEach(function(a){var c=a.rendered,f=a.isVisible(d,e);c!=f&&(c&&b.hide.push(a),f&&-1==b.show.indexOf(a)&&b.show.push(a))})}var b=this.renderQueue,c=this.end-this.start,d=new Date(this.start.valueOf()-c),e=new Date(this.end.valueOf()+c);a(this.items),this.clusters&&a(this.clusters)},links.Timeline.ClusterGenerator=function(a){this.timeline=a,this.clear()},links.Timeline.ClusterGenerator.prototype.clear=function(){this.items=[],this.groups={},this.clearCache()},links.Timeline.ClusterGenerator.prototype.clearCache=function(){this.cache={},this.cacheLevel=-1,this.cache[this.cacheLevel]=[]},links.Timeline.ClusterGenerator.prototype.setData=function(a,b){this.items=a||[],this.dataChanged=!0,this.applyOnChangedLevel=!0,b&&b.applyOnChangedLevel&&(this.applyOnChangedLevel=b.applyOnChangedLevel)},links.Timeline.ClusterGenerator.prototype.updateData=function(){this.dataChanged=!0,this.applyOnChangedLevel=!1},links.Timeline.ClusterGenerator.prototype.filterData=function(){var a=this.items||[],b={};this.groups=b,a.forEach(function(a){var c=a.group?a.group.content:"",d=b[c];d||(d=[],b[c]=d),d.push(a),a.start&&(a.center=a.end?(a.start.valueOf()+a.end.valueOf())/2:a.start.valueOf())});for(var c in b)b.hasOwnProperty(c)&&b[c].sort(function(a,b){return a.center-b.center});this.dataChanged=!1},links.Timeline.ClusterGenerator.prototype.getClusters=function(a,b){var c=-1,d=2,e=0;if(a>0&&(c=Math.round(Math.log(100/a)/Math.log(d)),e=Math.pow(d,c)),this.dataChanged){var f=c!=this.cacheLevel,g=this.applyOnChangedLevel?f:!0;g&&(this.clearCache(),this.filterData())}this.cacheLevel=c;var h=this.cache[c];if(!h){h=[];for(var i in this.groups)if(this.groups.hasOwnProperty(i))for(var j=this.groups[i],k=j.length,l=0;k>l;){for(var m=j[l],n=1,o=l-1;o>=0&&m.center-j[o].center<e/2;)j[o].cluster||n++,o--;for(var p=l+1;p<j.length&&j[p].center-m.center<e/2;)n++,p++;for(var q=h.length-1;q>=0&&m.center-h[q].center<e/2;)m.group==h[q].group&&n++,q--;if(n>b){for(var r=n-b+1,s=[],t=void 0,u=void 0,v=void 0,w=!1,x=0,y=l;s.length<r&&y<j.length;){var z=j[y],A=z.start.valueOf(),B=z.end?z.end.valueOf():z.start.valueOf();s.push(z),t=x?x/(x+1)*t+1/(x+1)*z.center:z.center,u=void 0!=u?Math.min(u,A):A,v=void 0!=v?Math.max(v,B):B,w=w||z instanceof links.Timeline.ItemRange||z instanceof links.Timeline.ItemFloatingRange,x++,y++}var C,D="Cluster containing "+x+" events. Zoom in to see the individual events.",E='<div title="'+D+'">'+x+" events</div>",F=m.group?m.group.content:void 0;C=this.timeline.createItem(w?{start:new Date(u),end:new Date(v),content:E,group:F}:{start:new Date(t),content:E,group:F}),C.isCluster=!0,C.items=s,C.items.forEach(function(a){a.cluster=C}),h.push(C),l+=r}else delete m.cluster,l+=1}this.cache[c]=h}return h},links.events=links.events||{listeners:[],indexOf:function(a){for(var b=this.listeners,c=0,d=this.listeners.length;d>c;c++){var e=b[c];if(e&&e.object==a)return c}return-1},addListener:function(a,b,c){var d=this.indexOf(a),e=this.listeners[d];e||(e={object:a,events:{}},this.listeners.push(e));var f=e.events[b];f||(f=[],e.events[b]=f),-1==f.indexOf(c)&&f.push(c)},removeListener:function(a,b,c){var d=this.indexOf(a),e=this.listeners[d];if(e){var f=e.events[b];if(f){var d=f.indexOf(c);-1!=d&&f.splice(d,1),0==f.length&&delete e.events[b]}var g=0,h=e.events;for(var i in h)h.hasOwnProperty(i)&&g++;0==g&&delete this.listeners[d]}},removeAllListeners:function(){this.listeners=[]},trigger:function(a,b,c){var d=this.indexOf(a),e=this.listeners[d];if(e){var f=e.events[b];if(f)for(var g=0,h=f.length;h>g;g++)f[g](c)}}},links.Timeline.StepDate=function(a,b,c){this.current=new Date,this._start=new Date,this._end=new Date,this.autoScale=!0,this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=1,this.setRange(a,b,c)},links.Timeline.StepDate.SCALE={MILLISECOND:1,SECOND:2,MINUTE:3,HOUR:4,DAY:5,WEEKDAY:6,MONTH:7,YEAR:8},links.Timeline.StepDate.prototype.setRange=function(a,b,c){a instanceof Date&&b instanceof Date&&(this._start=void 0!=a?new Date(a.valueOf()):new Date,this._end=void 0!=b?new Date(b.valueOf()):new Date,this.autoScale&&this.setMinimumStep(c))},links.Timeline.StepDate.prototype.start=function(){this.current=new Date(this._start.valueOf()),this.roundToMinor()},links.Timeline.StepDate.prototype.roundToMinor=function(){switch(this.scale){case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.step*Math.floor(this.current.getFullYear()/this.step)),this.current.setMonth(0);case links.Timeline.StepDate.SCALE.MONTH:this.current.setDate(1);case links.Timeline.StepDate.SCALE.DAY:case links.Timeline.StepDate.SCALE.WEEKDAY:this.current.setHours(0);case links.Timeline.StepDate.SCALE.HOUR:this.current.setMinutes(0);case links.Timeline.StepDate.SCALE.MINUTE:this.current.setSeconds(0);case links.Timeline.StepDate.SCALE.SECOND:this.current.setMilliseconds(0)}if(1!=this.step)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current.setMilliseconds(this.current.getMilliseconds()-this.current.getMilliseconds()%this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()-this.current.getSeconds()%this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()-this.current.getMinutes()%this.step);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.setHours(this.current.getHours()-this.current.getHours()%this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()-1-(this.current.getDate()-1)%this.step+1);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()-this.current.getMonth()%this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()-this.current.getFullYear()%this.step)}},links.Timeline.StepDate.prototype.end=function(){return this.current.valueOf()>this._end.valueOf()},links.Timeline.StepDate.prototype.next=function(){var a=this.current.valueOf();if(this.current.getMonth()<6)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current=new Date(this.current.valueOf()+this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current=new Date(this.current.valueOf()+1e3*this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current=new Date(this.current.valueOf()+1e3*this.step*60);break;case links.Timeline.StepDate.SCALE.HOUR:this.current=new Date(this.current.valueOf()+1e3*this.step*60*60);var b=this.current.getHours();this.current.setHours(b-b%this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()+this.step);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+this.step)}else switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current=new Date(this.current.valueOf()+this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()+this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()+this.step);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.setHours(this.current.getHours()+this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()+this.step);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+this.step)}if(1!=this.step)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current.getMilliseconds()<this.step&&this.current.setMilliseconds(0);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.getSeconds()<this.step&&this.current.setSeconds(0);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.getMinutes()<this.step&&this.current.setMinutes(0);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.getHours()<this.step&&this.current.setHours(0);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.getDate()<this.step+1&&this.current.setDate(1);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.getMonth()<this.step&&this.current.setMonth(0);break;case links.Timeline.StepDate.SCALE.YEAR:}this.current.valueOf()==a&&(this.current=new Date(this._end.valueOf()))},links.Timeline.StepDate.prototype.getCurrent=function(){return this.current},links.Timeline.StepDate.prototype.setScale=function(a,b){this.scale=a,b>0&&(this.step=b),this.autoScale=!1},links.Timeline.StepDate.prototype.setAutoScale=function(a){this.autoScale=a},links.Timeline.StepDate.prototype.setMinimumStep=function(a){if(void 0!=a){var b=31104e6,c=2592e6,d=864e5,e=36e5,f=6e4,g=1e3,h=1;1e3*b>a&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=1e3),500*b>a&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=500),100*b>a&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=100),50*b>a&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=50),10*b>a&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=10),5*b>a&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=5),b>a&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=1),3*c>a&&(this.scale=links.Timeline.StepDate.SCALE.MONTH,this.step=3),c>a&&(this.scale=links.Timeline.StepDate.SCALE.MONTH,this.step=1),5*d>a&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=5),2*d>a&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=2),d>a&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=1),d/2>a&&(this.scale=links.Timeline.StepDate.SCALE.WEEKDAY,this.step=1),4*e>a&&(this.scale=links.Timeline.StepDate.SCALE.HOUR,this.step=4),e>a&&(this.scale=links.Timeline.StepDate.SCALE.HOUR,this.step=1),15*f>a&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=15),10*f>a&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=10),5*f>a&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=5),f>a&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=1),15*g>a&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=15),10*g>a&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=10),5*g>a&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=5),g>a&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=1),200*h>a&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=200),100*h>a&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=100),50*h>a&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=50),10*h>a&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=10),5*h>a&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=5),h>a&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=1)}},links.Timeline.StepDate.prototype.snap=function(a){if(this.scale==links.Timeline.StepDate.SCALE.YEAR){var b=a.getFullYear()+Math.round(a.getMonth()/12);a.setFullYear(Math.round(b/this.step)*this.step),a.setMonth(0),a.setDate(0),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.MONTH)a.getDate()>15?(a.setDate(1),a.setMonth(a.getMonth()+1)):a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);else if(this.scale==links.Timeline.StepDate.SCALE.DAY||this.scale==links.Timeline.StepDate.SCALE.WEEKDAY){switch(this.step){case 5:case 2:a.setHours(24*Math.round(a.getHours()/24));break;default:a.setHours(12*Math.round(a.getHours()/12))}a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.HOUR){switch(this.step){case 4:a.setMinutes(60*Math.round(a.getMinutes()/60));break;default:a.setMinutes(30*Math.round(a.getMinutes()/30))}a.setSeconds(0),a.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.MINUTE){switch(this.step){case 15:case 10:a.setMinutes(5*Math.round(a.getMinutes()/5)),a.setSeconds(0);break;case 5:a.setSeconds(60*Math.round(a.getSeconds()/60));break;default:a.setSeconds(30*Math.round(a.getSeconds()/30))}a.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.SECOND)switch(this.step){case 15:case 10:a.setSeconds(5*Math.round(a.getSeconds()/5)),a.setMilliseconds(0);break;case 5:a.setMilliseconds(1e3*Math.round(a.getMilliseconds()/1e3));break;default:a.setMilliseconds(500*Math.round(a.getMilliseconds()/500))}else if(this.scale==links.Timeline.StepDate.SCALE.MILLISECOND){var c=this.step>5?this.step/2:1;a.setMilliseconds(Math.round(a.getMilliseconds()/c)*c)}},links.Timeline.StepDate.prototype.isMajor=function(){switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return 0==this.current.getMilliseconds();case links.Timeline.StepDate.SCALE.SECOND:return 0==this.current.getSeconds();case links.Timeline.StepDate.SCALE.MINUTE:return 0==this.current.getHours()&&0==this.current.getMinutes();case links.Timeline.StepDate.SCALE.HOUR:return 0==this.current.getHours();case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:return 1==this.current.getDate();case links.Timeline.StepDate.SCALE.MONTH:return 0==this.current.getMonth();case links.Timeline.StepDate.SCALE.YEAR:return!1;default:return!1}},links.Timeline.StepDate.prototype.getLabelMinor=function(a,b){switch(void 0==b&&(b=this.current),this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return String(b.getMilliseconds());case links.Timeline.StepDate.SCALE.SECOND:return String(b.getSeconds());case links.Timeline.StepDate.SCALE.MINUTE:return this.addZeros(b.getHours(),2)+":"+this.addZeros(b.getMinutes(),2);case links.Timeline.StepDate.SCALE.HOUR:return this.addZeros(b.getHours(),2)+":"+this.addZeros(b.getMinutes(),2);case links.Timeline.StepDate.SCALE.WEEKDAY:return a.DAYS_SHORT[b.getDay()]+" "+b.getDate();case links.Timeline.StepDate.SCALE.DAY:return String(b.getDate());case links.Timeline.StepDate.SCALE.MONTH:return a.MONTHS_SHORT[b.getMonth()];case links.Timeline.StepDate.SCALE.YEAR:return String(b.getFullYear());default:return""}},links.Timeline.StepDate.prototype.getLabelMajor=function(a,b){switch(void 0==b&&(b=this.current),this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return this.addZeros(b.getHours(),2)+":"+this.addZeros(b.getMinutes(),2)+":"+this.addZeros(b.getSeconds(),2);case links.Timeline.StepDate.SCALE.SECOND:return b.getDate()+" "+a.MONTHS[b.getMonth()]+" "+this.addZeros(b.getHours(),2)+":"+this.addZeros(b.getMinutes(),2);case links.Timeline.StepDate.SCALE.MINUTE:return a.DAYS[b.getDay()]+" "+b.getDate()+" "+a.MONTHS[b.getMonth()]+" "+b.getFullYear();case links.Timeline.StepDate.SCALE.HOUR:return a.DAYS[b.getDay()]+" "+b.getDate()+" "+a.MONTHS[b.getMonth()]+" "+b.getFullYear();case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:return a.MONTHS[b.getMonth()]+" "+b.getFullYear();case links.Timeline.StepDate.SCALE.MONTH:return String(b.getFullYear());default:return""}},links.Timeline.StepDate.prototype.addZeros=function(a,b){for(var c=""+a;c.length<b;)c="0"+c;return c},links.imageloader=function(){function a(a){if(1==f[a])return!0;var b=new Image;return b.src=a,b.complete?!0:!1}function b(a){return void 0!=g[a]}function c(c,d,e){if(void 0==e&&(e=!0),a(c))return void(e&&d(c));if(!b(c)||e){var h=g[c];if(!h){var i=new Image;i.src=c,h=[],g[c]=h,i.onload=function(){f[c]=!0,delete g[c];for(var a=0;a<h.length;a++)h[a](c)}}-1==h.indexOf(d)&&h.push(d)}}function d(b,d,e){var f=[];if(b.forEach(function(b){a(b)||f.push(b)}),f.length){var g=f.length;f.forEach(function(a){c(a,function(){g--,0==g&&d()},e)})}else e&&d()}function e(a,b){for(var c=a.firstChild;c;){if("IMG"==c.tagName){var d=c.src;-1==b.indexOf(d)&&b.push(d)}e(c,b),c=c.nextSibling}}var f={},g={};return{isLoaded:a,isLoading:b,load:c,loadAll:d,filterImageUrls:e}}(),links.Timeline.addEventListener=function(a,b,c,d){a.addEventListener?(void 0===d&&(d=!1),"mousewheel"===b&&navigator.userAgent.indexOf("Firefox")>=0&&(b="DOMMouseScroll"),a.addEventListener(b,c,d)):a.attachEvent("on"+b,c)},links.Timeline.removeEventListener=function(a,b,c,d){a.removeEventListener?(void 0===d&&(d=!1),"mousewheel"===b&&navigator.userAgent.indexOf("Firefox")>=0&&(b="DOMMouseScroll"),a.removeEventListener(b,c,d)):a.detachEvent("on"+b,c)},links.Timeline.getTarget=function(a){a||(a=window.event);var b;return a.target?b=a.target:a.srcElement&&(b=a.srcElement),void 0!=b.nodeType&&3==b.nodeType&&(b=b.parentNode),b},links.Timeline.stopPropagation=function(a){a||(a=window.event),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},links.Timeline.preventDefault=function(a){a||(a=window.event),a.preventDefault?a.preventDefault():a.returnValue=!1},links.Timeline.getAbsoluteLeft=function(a){for(var b=document.documentElement,c=document.body,d=a.offsetLeft,e=a.offsetParent;null!=e&&e!=c&&e!=b;)d+=e.offsetLeft,d-=e.scrollLeft,e=e.offsetParent;return d},links.Timeline.getAbsoluteTop=function(a){for(var b=document.documentElement,c=document.body,d=a.offsetTop,e=a.offsetParent;null!=e&&e!=c&&e!=b;)d+=e.offsetTop,d-=e.scrollTop,e=e.offsetParent;return d},links.Timeline.getPageY=function(a){if("targetTouches"in a&&a.targetTouches.length&&(a=a.targetTouches[0]),"pageY"in a)return a.pageY;var b=a.clientY,c=document.documentElement,d=document.body;return b+(c&&c.scrollTop||d&&d.scrollTop||0)-(c&&c.clientTop||d&&d.clientTop||0)},links.Timeline.getPageX=function(a){if("targetTouches"in a&&a.targetTouches.length&&(a=a.targetTouches[0]),"pageX"in a)return a.pageX;var b=a.clientX,c=document.documentElement,d=document.body;return b+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c&&c.clientLeft||d&&d.clientLeft||0)},links.Timeline.addClassName=function(a,b){for(var c=a.className.split(" "),d=b.split(" "),e=!1,f=0;f<d.length;f++)-1==c.indexOf(d[f])&&(c.push(d[f]),e=!0);e&&(a.className=c.join(" "))},links.Timeline.removeClassName=function(a,b){for(var c=a.className.split(" "),d=b.split(" "),e=!1,f=0;f<d.length;f++){var g=c.indexOf(d[f]);-1!=g&&(c.splice(g,1),e=!0)}e&&(a.className=c.join(" "))},links.Timeline.isArray=function(a){return a instanceof Array?!0:"[object Array]"===Object.prototype.toString.call(a)},links.Timeline.clone=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},links.Timeline.parseJSONDate=function(a){if(void 0==a)return void 0;if(a instanceof Date)return a;var b=a.match(/\/Date\((-?\d+)([-\+]?\d{2})?(\d{2})?\)\//i);if(b){var c=b[2]?36e5*b[2]+6e4*b[3]*(b[2]/Math.abs(b[2])):0;return new Date(1*b[1]+c)}return Date.parse(a)},!function(a){a.color={},a.color.make=function(b,c,d,e){var f={};return f.r=b||0,f.g=c||0,f.b=d||0,f.a=null!=e?e:1,f.add=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]+=b;return f.normalize()},f.scale=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]*=b;return f.normalize()},f.toString=function(){return f.a>=1?"rgb("+[f.r,f.g,f.b].join(",")+")":"rgba("+[f.r,f.g,f.b,f.a].join(",")+")"},f.normalize=function(){function a(a,b,c){return a>b?a:b>c?c:b}return f.r=a(0,parseInt(f.r),255),f.g=a(0,parseInt(f.g),255),f.b=a(0,parseInt(f.b),255),f.a=a(0,f.a,1),f},f.clone=function(){return a.color.make(f.r,f.b,f.g,f.a)},f.normalize()},a.color.extract=function(b,c){var d;do{if(d=b.css(c).toLowerCase(),""!=d&&"transparent"!=d)break;b=b.parent()}while(b.length&&!a.nodeName(b.get(0),"body"));return"rgba(0, 0, 0, 0)"==d&&(d="transparent"),a.color.parse(d)},a.color.parse=function(c){var d,e=a.color.make;if(d=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return e(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10));if(d=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c))return e(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10),parseFloat(d[4]));if(d=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return e(2.55*parseFloat(d[1]),2.55*parseFloat(d[2]),2.55*parseFloat(d[3]));if(d=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c))return e(2.55*parseFloat(d[1]),2.55*parseFloat(d[2]),2.55*parseFloat(d[3]),parseFloat(d[4]));if(d=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return e(parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16));if(d=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return e(parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16));var f=a.trim(c).toLowerCase();return"transparent"==f?e(255,255,255,0):(d=b[f]||[0,0,0],e(d[0],d[1],d[2]))};var b={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(a){function b(b,c){var d=c.children("."+b)[0];if(null==d&&(d=document.createElement("canvas"),d.className=b,a(d).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(c),!d.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");d=window.G_vmlCanvasManager.initElement(d)}this.element=d;var e=this.context=d.getContext("2d"),f=window.devicePixelRatio||1,g=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;this.pixelRatio=f/g,this.resize(c.width(),c.height()),this.textContainer=null,this.text={},this._textCache={}}function c(c,e,f,g){function h(a,b){b=[qb].concat(b);for(var c=0;c<a.length;++c)a[c].apply(this,b)}function i(){for(var c={Canvas:b},d=0;d<g.length;++d){var e=g[d];e.init(qb,c),e.options&&a.extend(!0,eb,e.options)}}function j(b){a.extend(!0,eb,b),b&&b.colors&&(eb.colors=b.colors),null==eb.xaxis.color&&(eb.xaxis.color=a.color.parse(eb.grid.color).scale("a",.22).toString()),null==eb.yaxis.color&&(eb.yaxis.color=a.color.parse(eb.grid.color).scale("a",.22).toString()),null==eb.xaxis.tickColor&&(eb.xaxis.tickColor=eb.grid.tickColor||eb.xaxis.color),null==eb.yaxis.tickColor&&(eb.yaxis.tickColor=eb.grid.tickColor||eb.yaxis.color),null==eb.grid.borderColor&&(eb.grid.borderColor=eb.grid.color),null==eb.grid.tickColor&&(eb.grid.tickColor=a.color.parse(eb.grid.color).scale("a",.22).toString());var d,e,f,g=c.css("font-size"),i=g?+g.replace("px",""):13,j={style:c.css("font-style"),size:Math.round(.8*i),variant:c.css("font-variant"),weight:c.css("font-weight"),family:c.css("font-family")};for(f=eb.xaxes.length||1,d=0;f>d;++d)e=eb.xaxes[d],e&&!e.tickColor&&(e.tickColor=e.color),e=a.extend(!0,{},eb.xaxis,e),eb.xaxes[d]=e,e.font&&(e.font=a.extend({},j,e.font),e.font.color||(e.font.color=e.color),e.font.lineHeight||(e.font.lineHeight=Math.round(1.15*e.font.size)));for(f=eb.yaxes.length||1,d=0;f>d;++d)e=eb.yaxes[d],e&&!e.tickColor&&(e.tickColor=e.color),e=a.extend(!0,{},eb.yaxis,e),eb.yaxes[d]=e,e.font&&(e.font=a.extend({},j,e.font),e.font.color||(e.font.color=e.color),e.font.lineHeight||(e.font.lineHeight=Math.round(1.15*e.font.size)));for(eb.xaxis.noTicks&&null==eb.xaxis.ticks&&(eb.xaxis.ticks=eb.xaxis.noTicks),eb.yaxis.noTicks&&null==eb.yaxis.ticks&&(eb.yaxis.ticks=eb.yaxis.noTicks),eb.x2axis&&(eb.xaxes[1]=a.extend(!0,{},eb.xaxis,eb.x2axis),eb.xaxes[1].position="top",null==eb.x2axis.min&&(eb.xaxes[1].min=null),null==eb.x2axis.max&&(eb.xaxes[1].max=null)),eb.y2axis&&(eb.yaxes[1]=a.extend(!0,{},eb.yaxis,eb.y2axis),eb.yaxes[1].position="right",null==eb.y2axis.min&&(eb.yaxes[1].min=null),null==eb.y2axis.max&&(eb.yaxes[1].max=null)),eb.grid.coloredAreas&&(eb.grid.markings=eb.grid.coloredAreas),eb.grid.coloredAreasColor&&(eb.grid.markingsColor=eb.grid.coloredAreasColor),eb.lines&&a.extend(!0,eb.series.lines,eb.lines),eb.points&&a.extend(!0,eb.series.points,eb.points),eb.bars&&a.extend(!0,eb.series.bars,eb.bars),null!=eb.shadowSize&&(eb.series.shadowSize=eb.shadowSize),null!=eb.highlightColor&&(eb.series.highlightColor=eb.highlightColor),d=0;d<eb.xaxes.length;++d)q(kb,d+1).options=eb.xaxes[d];for(d=0;d<eb.yaxes.length;++d)q(lb,d+1).options=eb.yaxes[d];for(var k in pb)eb.hooks[k]&&eb.hooks[k].length&&(pb[k]=pb[k].concat(eb.hooks[k]));h(pb.processOptions,[eb])}function k(a){db=l(a),r(),s()}function l(b){for(var c=[],d=0;d<b.length;++d){var e=a.extend(!0,{},eb.series);null!=b[d].data?(e.data=b[d].data,delete b[d].data,a.extend(!0,e,b[d]),b[d].data=e.data):e.data=b[d],c.push(e)}return c}function m(a,b){var c=a[b+"axis"];return"object"==typeof c&&(c=c.n),"number"!=typeof c&&(c=1),c}function n(){return a.grep(kb.concat(lb),function(a){return a})}function o(a){var b,c,d={};for(b=0;b<kb.length;++b)c=kb[b],c&&c.used&&(d["x"+c.n]=c.c2p(a.left));for(b=0;b<lb.length;++b)c=lb[b],c&&c.used&&(d["y"+c.n]=c.c2p(a.top));return void 0!==d.x1&&(d.x=d.x1),void 0!==d.y1&&(d.y=d.y1),d}function p(a){var b,c,d,e={};for(b=0;b<kb.length;++b)if(c=kb[b],c&&c.used&&(d="x"+c.n,null==a[d]&&1==c.n&&(d="x"),null!=a[d])){e.left=c.p2c(a[d]);break}for(b=0;b<lb.length;++b)if(c=lb[b],c&&c.used&&(d="y"+c.n,null==a[d]&&1==c.n&&(d="y"),null!=a[d])){e.top=c.p2c(a[d]);break}return e}function q(b,c){return b[c-1]||(b[c-1]={n:c,direction:b==kb?"x":"y",options:a.extend(!0,{},b==kb?eb.xaxis:eb.yaxis)}),b[c-1]}function r(){var b,c=db.length,d=-1;for(b=0;b<db.length;++b){var e=db[b].color;null!=e&&(c--,"number"==typeof e&&e>d&&(d=e))}d>=c&&(c=d+1);
var f,g=[],h=eb.colors,i=h.length,j=0;for(b=0;c>b;b++)f=a.color.parse(h[b%i]||"#666"),b%i==0&&b&&(j=j>=0?.5>j?-j-.2:0:-j),g[b]=f.scale("rgb",1+j);var k,l=0;for(b=0;b<db.length;++b){if(k=db[b],null==k.color?(k.color=g[l].toString(),++l):"number"==typeof k.color&&(k.color=g[k.color].toString()),null==k.lines.show){var n,o=!0;for(n in k)if(k[n]&&k[n].show){o=!1;break}o&&(k.lines.show=!0)}null==k.lines.zero&&(k.lines.zero=!!k.lines.fill),k.xaxis=q(kb,m(k,"x")),k.yaxis=q(lb,m(k,"y"))}}function s(){function b(a,b,c){b<a.datamin&&b!=-s&&(a.datamin=b),c>a.datamax&&c!=s&&(a.datamax=c)}var c,d,e,f,g,i,j,k,l,m,o,p,q=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=Number.MAX_VALUE;for(a.each(n(),function(a,b){b.datamin=q,b.datamax=r,b.used=!1}),c=0;c<db.length;++c)g=db[c],g.datapoints={points:[]},h(pb.processRawData,[g,g.data,g.datapoints]);for(c=0;c<db.length;++c){if(g=db[c],o=g.data,p=g.datapoints.format,!p){if(p=[],p.push({x:!0,number:!0,required:!0}),p.push({y:!0,number:!0,required:!0}),g.bars.show||g.lines.show&&g.lines.fill){var t=!!(g.bars.show&&g.bars.zero||g.lines.show&&g.lines.zero);p.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:t}),g.bars.horizontal&&(delete p[p.length-1].y,p[p.length-1].x=!0)}g.datapoints.format=p}if(null==g.datapoints.pointsize){g.datapoints.pointsize=p.length,j=g.datapoints.pointsize,i=g.datapoints.points;var u=g.lines.show&&g.lines.steps;for(g.xaxis.used=g.yaxis.used=!0,d=e=0;d<o.length;++d,e+=j){m=o[d];var v=null==m;if(!v)for(f=0;j>f;++f)k=m[f],l=p[f],l&&(l.number&&null!=k&&(k=+k,isNaN(k)?k=null:1/0==k?k=s:k==-1/0&&(k=-s)),null==k&&(l.required&&(v=!0),null!=l.defaultValue&&(k=l.defaultValue))),i[e+f]=k;if(v)for(f=0;j>f;++f)k=i[e+f],null!=k&&(l=p[f],l.autoscale!==!1&&(l.x&&b(g.xaxis,k,k),l.y&&b(g.yaxis,k,k))),i[e+f]=null;else if(u&&e>0&&null!=i[e-j]&&i[e-j]!=i[e]&&i[e-j+1]!=i[e+1]){for(f=0;j>f;++f)i[e+j+f]=i[e+f];i[e+1]=i[e-j+1],e+=j}}}}for(c=0;c<db.length;++c)g=db[c],h(pb.processDatapoints,[g,g.datapoints]);for(c=0;c<db.length;++c){g=db[c],i=g.datapoints.points,j=g.datapoints.pointsize,p=g.datapoints.format;var w=q,x=q,y=r,z=r;for(d=0;d<i.length;d+=j)if(null!=i[d])for(f=0;j>f;++f)k=i[d+f],l=p[f],l&&l.autoscale!==!1&&k!=s&&k!=-s&&(l.x&&(w>k&&(w=k),k>y&&(y=k)),l.y&&(x>k&&(x=k),k>z&&(z=k)));if(g.bars.show){var A;switch(g.bars.align){case"left":A=0;break;case"right":A=-g.bars.barWidth;break;default:A=-g.bars.barWidth/2}g.bars.horizontal?(x+=A,z+=A+g.bars.barWidth):(w+=A,y+=A+g.bars.barWidth)}b(g.xaxis,w,y),b(g.yaxis,x,z)}a.each(n(),function(a,b){b.datamin==q&&(b.datamin=null),b.datamax==r&&(b.datamax=null)})}function t(){c.css("padding",0).children().filter(function(){return!a(this).hasClass("flot-overlay")&&!a(this).hasClass("flot-base")}).remove(),"static"==c.css("position")&&c.css("position","relative"),fb=new b("flot-base",c),gb=new b("flot-overlay",c),ib=fb.context,jb=gb.context,hb=a(gb.element).unbind();var d=c.data("plot");d&&(d.shutdown(),gb.clear()),c.data("plot",qb)}function u(){eb.grid.hoverable&&(hb.mousemove(T),hb.bind("mouseleave",U)),eb.grid.clickable&&hb.click(V),h(pb.bindEvents,[hb])}function v(){sb&&clearTimeout(sb),hb.unbind("mousemove",T),hb.unbind("mouseleave",U),hb.unbind("click",V),h(pb.shutdown,[hb])}function w(a){function b(a){return a}var c,d,e=a.options.transform||b,f=a.options.inverseTransform;"x"==a.direction?(c=a.scale=nb/Math.abs(e(a.max)-e(a.min)),d=Math.min(e(a.max),e(a.min))):(c=a.scale=ob/Math.abs(e(a.max)-e(a.min)),c=-c,d=Math.max(e(a.max),e(a.min))),a.p2c=e==b?function(a){return(a-d)*c}:function(a){return(e(a)-d)*c},a.c2p=f?function(a){return f(d+a/c)}:function(a){return d+a/c}}function x(a){for(var b=a.options,c=a.ticks||[],d=b.labelWidth||0,e=b.labelHeight||0,f=d||("x"==a.direction?Math.floor(fb.width/(c.length||1)):null),g=a.direction+"Axis "+a.direction+a.n+"Axis",h="flot-"+a.direction+"-axis flot-"+a.direction+a.n+"-axis "+g,i=b.font||"flot-tick-label tickLabel",j=0;j<c.length;++j){var k=c[j];if(k.label){var l=fb.getTextInfo(h,k.label,i,null,f);d=Math.max(d,l.width),e=Math.max(e,l.height)}}a.labelWidth=b.labelWidth||d,a.labelHeight=b.labelHeight||e}function y(b){var c=b.labelWidth,d=b.labelHeight,e=b.options.position,f="x"===b.direction,g=b.options.tickLength,h=eb.grid.axisMargin,i=eb.grid.labelMargin,j=!0,k=!0,l=!0,m=!1;a.each(f?kb:lb,function(a,c){c&&(c.show||c.reserveSpace)&&(c===b?m=!0:c.options.position===e&&(m?k=!1:j=!1),m||(l=!1))}),k&&(h=0),null==g&&(g=l?"full":5),isNaN(+g)||(i+=+g),f?(d+=i,"bottom"==e?(mb.bottom+=d+h,b.box={top:fb.height-mb.bottom,height:d}):(b.box={top:mb.top+h,height:d},mb.top+=d+h)):(c+=i,"left"==e?(b.box={left:mb.left+h,width:c},mb.left+=c+h):(mb.right+=c+h,b.box={left:fb.width-mb.right,width:c})),b.position=e,b.tickLength=g,b.box.padding=i,b.innermost=j}function z(a){"x"==a.direction?(a.box.left=mb.left-a.labelWidth/2,a.box.width=fb.width-mb.left-mb.right+a.labelWidth):(a.box.top=mb.top-a.labelHeight/2,a.box.height=fb.height-mb.bottom-mb.top+a.labelHeight)}function A(){var b,c=eb.grid.minBorderMargin;if(null==c)for(c=0,b=0;b<db.length;++b)c=Math.max(c,2*(db[b].points.radius+db[b].points.lineWidth/2));var d={left:c,right:c,top:c,bottom:c};a.each(n(),function(a,b){b.reserveSpace&&b.ticks&&b.ticks.length&&("x"===b.direction?(d.left=Math.max(d.left,b.labelWidth/2),d.right=Math.max(d.right,b.labelWidth/2)):(d.bottom=Math.max(d.bottom,b.labelHeight/2),d.top=Math.max(d.top,b.labelHeight/2)))}),mb.left=Math.ceil(Math.max(d.left,mb.left)),mb.right=Math.ceil(Math.max(d.right,mb.right)),mb.top=Math.ceil(Math.max(d.top,mb.top)),mb.bottom=Math.ceil(Math.max(d.bottom,mb.bottom))}function B(){var b,c=n(),d=eb.grid.show;for(var e in mb){var f=eb.grid.margin||0;mb[e]="number"==typeof f?f:f[e]||0}h(pb.processOffset,[mb]);for(var e in mb)mb[e]+="object"==typeof eb.grid.borderWidth?d?eb.grid.borderWidth[e]:0:d?eb.grid.borderWidth:0;if(a.each(c,function(a,b){var c=b.options;b.show=null==c.show?b.used:c.show,b.reserveSpace=null==c.reserveSpace?b.show:c.reserveSpace,C(b)}),d){var g=a.grep(c,function(a){return a.show||a.reserveSpace});for(a.each(g,function(a,b){D(b),E(b),F(b,b.ticks),x(b)}),b=g.length-1;b>=0;--b)y(g[b]);A(),a.each(g,function(a,b){z(b)})}nb=fb.width-mb.left-mb.right,ob=fb.height-mb.bottom-mb.top,a.each(c,function(a,b){w(b)}),d&&K(),R()}function C(a){var b=a.options,c=+(null!=b.min?b.min:a.datamin),d=+(null!=b.max?b.max:a.datamax),e=d-c;if(0==e){var f=0==d?1:.01;null==b.min&&(c-=f),(null==b.max||null!=b.min)&&(d+=f)}else{var g=b.autoscaleMargin;null!=g&&(null==b.min&&(c-=e*g,0>c&&null!=a.datamin&&a.datamin>=0&&(c=0)),null==b.max&&(d+=e*g,d>0&&null!=a.datamax&&a.datamax<=0&&(d=0)))}a.min=c,a.max=d}function D(b){var c,e=b.options;c="number"==typeof e.ticks&&e.ticks>0?e.ticks:.3*Math.sqrt("x"==b.direction?fb.width:fb.height);var f=(b.max-b.min)/c,g=-Math.floor(Math.log(f)/Math.LN10),h=e.tickDecimals;null!=h&&g>h&&(g=h);var i,j=Math.pow(10,-g),k=f/j;if(1.5>k?i=1:3>k?(i=2,k>2.25&&(null==h||h>=g+1)&&(i=2.5,++g)):i=7.5>k?5:10,i*=j,null!=e.minTickSize&&i<e.minTickSize&&(i=e.minTickSize),b.delta=f,b.tickDecimals=Math.max(0,null!=h?h:g),b.tickSize=e.tickSize||i,"time"==e.mode&&!b.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(b.tickGenerator||(b.tickGenerator=function(a){var b,c=[],e=d(a.min,a.tickSize),f=0,g=Number.NaN;do b=g,g=e+f*a.tickSize,c.push(g),++f;while(g<a.max&&g!=b);return c},b.tickFormatter=function(a,b){var c=b.tickDecimals?Math.pow(10,b.tickDecimals):1,d=""+Math.round(a*c)/c;if(null!=b.tickDecimals){var e=d.indexOf("."),f=-1==e?0:d.length-e-1;if(f<b.tickDecimals)return(f?d:d+".")+(""+c).substr(1,b.tickDecimals-f)}return d}),a.isFunction(e.tickFormatter)&&(b.tickFormatter=function(a,b){return""+e.tickFormatter(a,b)}),null!=e.alignTicksWithAxis){var l=("x"==b.direction?kb:lb)[e.alignTicksWithAxis-1];if(l&&l.used&&l!=b){var m=b.tickGenerator(b);if(m.length>0&&(null==e.min&&(b.min=Math.min(b.min,m[0])),null==e.max&&m.length>1&&(b.max=Math.max(b.max,m[m.length-1]))),b.tickGenerator=function(a){var b,c,d=[];for(c=0;c<l.ticks.length;++c)b=(l.ticks[c].v-l.min)/(l.max-l.min),b=a.min+b*(a.max-a.min),d.push(b);return d},!b.mode&&null==e.tickDecimals){var n=Math.max(0,-Math.floor(Math.log(b.delta)/Math.LN10)+1),o=b.tickGenerator(b);o.length>1&&/\..*0$/.test((o[1]-o[0]).toFixed(n))||(b.tickDecimals=n)}}}}function E(b){var c=b.options.ticks,d=[];null==c||"number"==typeof c&&c>0?d=b.tickGenerator(b):c&&(d=a.isFunction(c)?c(b):c);var e,f;for(b.ticks=[],e=0;e<d.length;++e){var g=null,h=d[e];"object"==typeof h?(f=+h[0],h.length>1&&(g=h[1])):f=+h,null==g&&(g=b.tickFormatter(f,b)),isNaN(f)||b.ticks.push({v:f,label:g})}}function F(a,b){a.options.autoscaleMargin&&b.length>0&&(null==a.options.min&&(a.min=Math.min(a.min,b[0].v)),null==a.options.max&&b.length>1&&(a.max=Math.max(a.max,b[b.length-1].v)))}function G(){fb.clear(),h(pb.drawBackground,[ib]);var a=eb.grid;a.show&&a.backgroundColor&&I(),a.show&&!a.aboveData&&J();for(var b=0;b<db.length;++b)h(pb.drawSeries,[ib,db[b]]),L(db[b]);h(pb.draw,[ib]),a.show&&a.aboveData&&J(),fb.render(),X()}function H(a,b){for(var c,d,e,f,g=n(),h=0;h<g.length;++h)if(c=g[h],c.direction==b&&(f=b+c.n+"axis",a[f]||1!=c.n||(f=b+"axis"),a[f])){d=a[f].from,e=a[f].to;break}if(a[f]||(c="x"==b?kb[0]:lb[0],d=a[b+"1"],e=a[b+"2"]),null!=d&&null!=e&&d>e){var i=d;d=e,e=i}return{from:d,to:e,axis:c}}function I(){ib.save(),ib.translate(mb.left,mb.top),ib.fillStyle=cb(eb.grid.backgroundColor,ob,0,"rgba(255, 255, 255, 0)"),ib.fillRect(0,0,nb,ob),ib.restore()}function J(){var b,c,d,e;ib.save(),ib.translate(mb.left,mb.top);var f=eb.grid.markings;if(f)for(a.isFunction(f)&&(c=qb.getAxes(),c.xmin=c.xaxis.min,c.xmax=c.xaxis.max,c.ymin=c.yaxis.min,c.ymax=c.yaxis.max,f=f(c)),b=0;b<f.length;++b){var g=f[b],h=H(g,"x"),i=H(g,"y");if(null==h.from&&(h.from=h.axis.min),null==h.to&&(h.to=h.axis.max),null==i.from&&(i.from=i.axis.min),null==i.to&&(i.to=i.axis.max),!(h.to<h.axis.min||h.from>h.axis.max||i.to<i.axis.min||i.from>i.axis.max)){h.from=Math.max(h.from,h.axis.min),h.to=Math.min(h.to,h.axis.max),i.from=Math.max(i.from,i.axis.min),i.to=Math.min(i.to,i.axis.max);var j=h.from===h.to,k=i.from===i.to;if(!j||!k)if(h.from=Math.floor(h.axis.p2c(h.from)),h.to=Math.floor(h.axis.p2c(h.to)),i.from=Math.floor(i.axis.p2c(i.from)),i.to=Math.floor(i.axis.p2c(i.to)),j||k){var l=g.lineWidth||eb.grid.markingsLineWidth,m=l%2?.5:0;ib.beginPath(),ib.strokeStyle=g.color||eb.grid.markingsColor,ib.lineWidth=l,j?(ib.moveTo(h.to+m,i.from),ib.lineTo(h.to+m,i.to)):(ib.moveTo(h.from,i.to+m),ib.lineTo(h.to,i.to+m)),ib.stroke()}else ib.fillStyle=g.color||eb.grid.markingsColor,ib.fillRect(h.from,i.to,h.to-h.from,i.from-i.to)}}c=n(),d=eb.grid.borderWidth;for(var o=0;o<c.length;++o){var p,q,r,s,t=c[o],u=t.box,v=t.tickLength;if(t.show&&0!=t.ticks.length){for(ib.lineWidth=1,"x"==t.direction?(p=0,q="full"==v?"top"==t.position?0:ob:u.top-mb.top+("top"==t.position?u.height:0)):(q=0,p="full"==v?"left"==t.position?0:nb:u.left-mb.left+("left"==t.position?u.width:0)),t.innermost||(ib.strokeStyle=t.options.color,ib.beginPath(),r=s=0,"x"==t.direction?r=nb+1:s=ob+1,1==ib.lineWidth&&("x"==t.direction?q=Math.floor(q)+.5:p=Math.floor(p)+.5),ib.moveTo(p,q),ib.lineTo(p+r,q+s),ib.stroke()),ib.strokeStyle=t.options.tickColor,ib.beginPath(),b=0;b<t.ticks.length;++b){var w=t.ticks[b].v;r=s=0,isNaN(w)||w<t.min||w>t.max||"full"==v&&("object"==typeof d&&d[t.position]>0||d>0)&&(w==t.min||w==t.max)||("x"==t.direction?(p=t.p2c(w),s="full"==v?-ob:v,"top"==t.position&&(s=-s)):(q=t.p2c(w),r="full"==v?-nb:v,"left"==t.position&&(r=-r)),1==ib.lineWidth&&("x"==t.direction?p=Math.floor(p)+.5:q=Math.floor(q)+.5),ib.moveTo(p,q),ib.lineTo(p+r,q+s))}ib.stroke()}}d&&(e=eb.grid.borderColor,"object"==typeof d||"object"==typeof e?("object"!=typeof d&&(d={top:d,right:d,bottom:d,left:d}),"object"!=typeof e&&(e={top:e,right:e,bottom:e,left:e}),d.top>0&&(ib.strokeStyle=e.top,ib.lineWidth=d.top,ib.beginPath(),ib.moveTo(0-d.left,0-d.top/2),ib.lineTo(nb,0-d.top/2),ib.stroke()),d.right>0&&(ib.strokeStyle=e.right,ib.lineWidth=d.right,ib.beginPath(),ib.moveTo(nb+d.right/2,0-d.top),ib.lineTo(nb+d.right/2,ob),ib.stroke()),d.bottom>0&&(ib.strokeStyle=e.bottom,ib.lineWidth=d.bottom,ib.beginPath(),ib.moveTo(nb+d.right,ob+d.bottom/2),ib.lineTo(0,ob+d.bottom/2),ib.stroke()),d.left>0&&(ib.strokeStyle=e.left,ib.lineWidth=d.left,ib.beginPath(),ib.moveTo(0-d.left/2,ob+d.bottom),ib.lineTo(0-d.left/2,0),ib.stroke())):(ib.lineWidth=d,ib.strokeStyle=eb.grid.borderColor,ib.strokeRect(-d/2,-d/2,nb+d,ob+d))),ib.restore()}function K(){a.each(n(),function(a,b){var c,d,e,f,g,h=b.box,i=b.direction+"Axis "+b.direction+b.n+"Axis",j="flot-"+b.direction+"-axis flot-"+b.direction+b.n+"-axis "+i,k=b.options.font||"flot-tick-label tickLabel";if(fb.removeText(j),b.show&&0!=b.ticks.length)for(var l=0;l<b.ticks.length;++l)c=b.ticks[l],!c.label||c.v<b.min||c.v>b.max||("x"==b.direction?(f="center",d=mb.left+b.p2c(c.v),"bottom"==b.position?e=h.top+h.padding:(e=h.top+h.height-h.padding,g="bottom")):(g="middle",e=mb.top+b.p2c(c.v),"left"==b.position?(d=h.left+h.width-h.padding,f="right"):d=h.left+h.padding),fb.addText(j,d,e,c.label,k,null,null,f,g))})}function L(a){a.lines.show&&M(a),a.bars.show&&P(a),a.points.show&&N(a)}function M(a){function b(a,b,c,d,e){var f=a.points,g=a.pointsize,h=null,i=null;ib.beginPath();for(var j=g;j<f.length;j+=g){var k=f[j-g],l=f[j-g+1],m=f[j],n=f[j+1];if(null!=k&&null!=m){if(n>=l&&l<e.min){if(n<e.min)continue;k=(e.min-l)/(n-l)*(m-k)+k,l=e.min}else if(l>=n&&n<e.min){if(l<e.min)continue;m=(e.min-l)/(n-l)*(m-k)+k,n=e.min}if(l>=n&&l>e.max){if(n>e.max)continue;k=(e.max-l)/(n-l)*(m-k)+k,l=e.max}else if(n>=l&&n>e.max){if(l>e.max)continue;m=(e.max-l)/(n-l)*(m-k)+k,n=e.max}if(m>=k&&k<d.min){if(m<d.min)continue;l=(d.min-k)/(m-k)*(n-l)+l,k=d.min}else if(k>=m&&m<d.min){if(k<d.min)continue;n=(d.min-k)/(m-k)*(n-l)+l,m=d.min}if(k>=m&&k>d.max){if(m>d.max)continue;l=(d.max-k)/(m-k)*(n-l)+l,k=d.max}else if(m>=k&&m>d.max){if(k>d.max)continue;n=(d.max-k)/(m-k)*(n-l)+l,m=d.max}(k!=h||l!=i)&&ib.moveTo(d.p2c(k)+b,e.p2c(l)+c),h=m,i=n,ib.lineTo(d.p2c(m)+b,e.p2c(n)+c)}}ib.stroke()}function c(a,b,c){for(var d=a.points,e=a.pointsize,f=Math.min(Math.max(0,c.min),c.max),g=0,h=!1,i=1,j=0,k=0;!(e>0&&g>d.length+e);){g+=e;var l=d[g-e],m=d[g-e+i],n=d[g],o=d[g+i];if(h){if(e>0&&null!=l&&null==n){k=g,e=-e,i=2;continue}if(0>e&&g==j+e){ib.fill(),h=!1,e=-e,i=1,g=j=k+e;continue}}if(null!=l&&null!=n){if(n>=l&&l<b.min){if(n<b.min)continue;m=(b.min-l)/(n-l)*(o-m)+m,l=b.min}else if(l>=n&&n<b.min){if(l<b.min)continue;o=(b.min-l)/(n-l)*(o-m)+m,n=b.min}if(l>=n&&l>b.max){if(n>b.max)continue;m=(b.max-l)/(n-l)*(o-m)+m,l=b.max}else if(n>=l&&n>b.max){if(l>b.max)continue;o=(b.max-l)/(n-l)*(o-m)+m,n=b.max}if(h||(ib.beginPath(),ib.moveTo(b.p2c(l),c.p2c(f)),h=!0),m>=c.max&&o>=c.max)ib.lineTo(b.p2c(l),c.p2c(c.max)),ib.lineTo(b.p2c(n),c.p2c(c.max));else if(m<=c.min&&o<=c.min)ib.lineTo(b.p2c(l),c.p2c(c.min)),ib.lineTo(b.p2c(n),c.p2c(c.min));else{var p=l,q=n;o>=m&&m<c.min&&o>=c.min?(l=(c.min-m)/(o-m)*(n-l)+l,m=c.min):m>=o&&o<c.min&&m>=c.min&&(n=(c.min-m)/(o-m)*(n-l)+l,o=c.min),m>=o&&m>c.max&&o<=c.max?(l=(c.max-m)/(o-m)*(n-l)+l,m=c.max):o>=m&&o>c.max&&m<=c.max&&(n=(c.max-m)/(o-m)*(n-l)+l,o=c.max),l!=p&&ib.lineTo(b.p2c(p),c.p2c(m)),ib.lineTo(b.p2c(l),c.p2c(m)),ib.lineTo(b.p2c(n),c.p2c(o)),n!=q&&(ib.lineTo(b.p2c(n),c.p2c(o)),ib.lineTo(b.p2c(q),c.p2c(o)))}}}}ib.save(),ib.translate(mb.left,mb.top),ib.lineJoin="round";var d=a.lines.lineWidth,e=a.shadowSize;if(d>0&&e>0){ib.lineWidth=e,ib.strokeStyle="rgba(0,0,0,0.1)";var f=Math.PI/18;b(a.datapoints,Math.sin(f)*(d/2+e/2),Math.cos(f)*(d/2+e/2),a.xaxis,a.yaxis),ib.lineWidth=e/2,b(a.datapoints,Math.sin(f)*(d/2+e/4),Math.cos(f)*(d/2+e/4),a.xaxis,a.yaxis)}ib.lineWidth=d,ib.strokeStyle=a.color;var g=Q(a.lines,a.color,0,ob);g&&(ib.fillStyle=g,c(a.datapoints,a.xaxis,a.yaxis)),d>0&&b(a.datapoints,0,0,a.xaxis,a.yaxis),ib.restore()}function N(a){function b(a,b,c,d,e,f,g,h){for(var i=a.points,j=a.pointsize,k=0;k<i.length;k+=j){var l=i[k],m=i[k+1];null==l||l<f.min||l>f.max||m<g.min||m>g.max||(ib.beginPath(),l=f.p2c(l),m=g.p2c(m)+d,"circle"==h?ib.arc(l,m,b,0,e?Math.PI:2*Math.PI,!1):h(ib,l,m,b,e),ib.closePath(),c&&(ib.fillStyle=c,ib.fill()),ib.stroke())}}ib.save(),ib.translate(mb.left,mb.top);var c=a.points.lineWidth,d=a.shadowSize,e=a.points.radius,f=a.points.symbol;if(0==c&&(c=1e-4),c>0&&d>0){var g=d/2;ib.lineWidth=g,ib.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,e,null,g+g/2,!0,a.xaxis,a.yaxis,f),ib.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,e,null,g/2,!0,a.xaxis,a.yaxis,f)}ib.lineWidth=c,ib.strokeStyle=a.color,b(a.datapoints,e,Q(a.points,a.color),0,!1,a.xaxis,a.yaxis,f),ib.restore()}function O(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,r,s,t;j?(s=q=r=!0,p=!1,l=c,m=a,o=b+d,n=b+e,l>m&&(t=m,m=l,l=t,p=!0,q=!1)):(p=q=r=!0,s=!1,l=a+d,m=a+e,n=c,o=b,n>o&&(t=o,o=n,n=t,s=!0,r=!1)),m<g.min||l>g.max||o<h.min||n>h.max||(l<g.min&&(l=g.min,p=!1),m>g.max&&(m=g.max,q=!1),n<h.min&&(n=h.min,s=!1),o>h.max&&(o=h.max,r=!1),l=g.p2c(l),n=h.p2c(n),m=g.p2c(m),o=h.p2c(o),f&&(i.fillStyle=f(n,o),i.fillRect(l,o,m-l,n-o)),k>0&&(p||q||r||s)&&(i.beginPath(),i.moveTo(l,n),p?i.lineTo(l,o):i.moveTo(l,o),r?i.lineTo(m,o):i.moveTo(m,o),q?i.lineTo(m,n):i.moveTo(m,n),s?i.lineTo(l,n):i.moveTo(l,n),i.stroke()))}function P(a){function b(b,c,d,e,f,g){for(var h=b.points,i=b.pointsize,j=0;j<h.length;j+=i)null!=h[j]&&O(h[j],h[j+1],h[j+2],c,d,e,f,g,ib,a.bars.horizontal,a.bars.lineWidth)}ib.save(),ib.translate(mb.left,mb.top),ib.lineWidth=a.bars.lineWidth,ib.strokeStyle=a.color;var c;switch(a.bars.align){case"left":c=0;break;case"right":c=-a.bars.barWidth;break;default:c=-a.bars.barWidth/2}var d=a.bars.fill?function(b,c){return Q(a.bars,a.color,b,c)}:null;b(a.datapoints,c,c+a.bars.barWidth,d,a.xaxis,a.yaxis),ib.restore()}function Q(b,c,d,e){var f=b.fill;if(!f)return null;if(b.fillColor)return cb(b.fillColor,d,e,c);var g=a.color.parse(c);return g.a="number"==typeof f?f:.4,g.normalize(),g.toString()}function R(){if(null!=eb.legend.container?a(eb.legend.container).html(""):c.find(".legend").remove(),eb.legend.show){for(var b,d,e=[],f=[],g=!1,h=eb.legend.labelFormatter,i=0;i<db.length;++i)b=db[i],b.label&&(d=h?h(b.label,b):b.label,d&&f.push({label:d,color:b.color}));if(eb.legend.sorted)if(a.isFunction(eb.legend.sorted))f.sort(eb.legend.sorted);else if("reverse"==eb.legend.sorted)f.reverse();else{var j="descending"!=eb.legend.sorted;f.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=j?1:-1})}for(var i=0;i<f.length;++i){var k=f[i];i%eb.legend.noColumns==0&&(g&&e.push("</tr>"),e.push("<tr>"),g=!0),e.push('<td class="legendColorBox"><div style="border:1px solid '+eb.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+k.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+k.label+"</td>")}if(g&&e.push("</tr>"),0!=e.length){var l='<table style="font-size:smaller;color:'+eb.grid.color+'">'+e.join("")+"</table>";if(null!=eb.legend.container)a(eb.legend.container).html(l);else{var m="",n=eb.legend.position,o=eb.legend.margin;null==o[0]&&(o=[o,o]),"n"==n.charAt(0)?m+="top:"+(o[1]+mb.top)+"px;":"s"==n.charAt(0)&&(m+="bottom:"+(o[1]+mb.bottom)+"px;"),"e"==n.charAt(1)?m+="right:"+(o[0]+mb.right)+"px;":"w"==n.charAt(1)&&(m+="left:"+(o[0]+mb.left)+"px;");var p=a('<div class="legend">'+l.replace('style="','style="position:absolute;'+m+";")+"</div>").appendTo(c);if(0!=eb.legend.backgroundOpacity){var q=eb.legend.backgroundColor;null==q&&(q=eb.grid.backgroundColor,q=q&&"string"==typeof q?a.color.parse(q):a.color.extract(p,"background-color"),q.a=1,q=q.toString());var r=p.children();a('<div style="position:absolute;width:'+r.width()+"px;height:"+r.height()+"px;"+m+"background-color:"+q+';"> </div>').prependTo(p).css("opacity",eb.legend.backgroundOpacity)}}}}}function S(a,b,c){var d,e,f,g=eb.grid.mouseActiveRadius,h=g*g+1,i=null;for(d=db.length-1;d>=0;--d)if(c(db[d])){var j=db[d],k=j.xaxis,l=j.yaxis,m=j.datapoints.points,n=k.c2p(a),o=l.c2p(b),p=g/k.scale,q=g/l.scale;if(f=j.datapoints.pointsize,k.options.inverseTransform&&(p=Number.MAX_VALUE),l.options.inverseTransform&&(q=Number.MAX_VALUE),j.lines.show||j.points.show)for(e=0;e<m.length;e+=f){var r=m[e],s=m[e+1];if(null!=r&&!(r-n>p||-p>r-n||s-o>q||-q>s-o)){var t=Math.abs(k.p2c(r)-a),u=Math.abs(l.p2c(s)-b),v=t*t+u*u;h>v&&(h=v,i=[d,e/f])}}if(j.bars.show&&!i){var w,x;switch(j.bars.align){case"left":w=0;break;case"right":w=-j.bars.barWidth;break;default:w=-j.bars.barWidth/2}for(x=w+j.bars.barWidth,e=0;e<m.length;e+=f){var r=m[e],s=m[e+1],y=m[e+2];null!=r&&(db[d].bars.horizontal?n<=Math.max(y,r)&&n>=Math.min(y,r)&&o>=s+w&&s+x>=o:n>=r+w&&r+x>=n&&o>=Math.min(y,s)&&o<=Math.max(y,s))&&(i=[d,e/f])}}}return i?(d=i[0],e=i[1],f=db[d].datapoints.pointsize,{datapoint:db[d].datapoints.points.slice(e*f,(e+1)*f),dataIndex:e,series:db[d],seriesIndex:d}):null}function T(a){eb.grid.hoverable&&W("plothover",a,function(a){return 0!=a.hoverable})}function U(a){eb.grid.hoverable&&W("plothover",a,function(){return!1})}function V(a){W("plotclick",a,function(a){return 0!=a.clickable})}function W(a,b,d){var e=hb.offset(),f=b.pageX-e.left-mb.left,g=b.pageY-e.top-mb.top,h=o({left:f,top:g});h.pageX=b.pageX,h.pageY=b.pageY;var i=S(f,g,d);if(i&&(i.pageX=parseInt(i.series.xaxis.p2c(i.datapoint[0])+e.left+mb.left,10),i.pageY=parseInt(i.series.yaxis.p2c(i.datapoint[1])+e.top+mb.top,10)),eb.grid.autoHighlight){for(var j=0;j<rb.length;++j){var k=rb[j];k.auto!=a||i&&k.series==i.series&&k.point[0]==i.datapoint[0]&&k.point[1]==i.datapoint[1]||$(k.series,k.point)}i&&Z(i.series,i.datapoint,a)}c.trigger(a,[h,i])}function X(){var a=eb.interaction.redrawOverlayInterval;return-1==a?void Y():void(sb||(sb=setTimeout(Y,a)))}function Y(){sb=null,jb.save(),gb.clear(),jb.translate(mb.left,mb.top);var a,b;for(a=0;a<rb.length;++a)b=rb[a],b.series.bars.show?bb(b.series,b.point):ab(b.series,b.point);jb.restore(),h(pb.drawOverlay,[jb])}function Z(a,b,c){if("number"==typeof a&&(a=db[a]),"number"==typeof b){var d=a.datapoints.pointsize;b=a.datapoints.points.slice(d*b,d*(b+1))}var e=_(a,b);-1==e?(rb.push({series:a,point:b,auto:c}),X()):c||(rb[e].auto=!1)}function $(a,b){if(null==a&&null==b)return rb=[],void X();if("number"==typeof a&&(a=db[a]),"number"==typeof b){var c=a.datapoints.pointsize;b=a.datapoints.points.slice(c*b,c*(b+1))}var d=_(a,b);-1!=d&&(rb.splice(d,1),X())}function _(a,b){for(var c=0;c<rb.length;++c){var d=rb[c];if(d.series==a&&d.point[0]==b[0]&&d.point[1]==b[1])return c}return-1}function ab(b,c){var d=c[0],e=c[1],f=b.xaxis,g=b.yaxis,h="string"==typeof b.highlightColor?b.highlightColor:a.color.parse(b.color).scale("a",.5).toString();if(!(d<f.min||d>f.max||e<g.min||e>g.max)){var i=b.points.radius+b.points.lineWidth/2;jb.lineWidth=i,jb.strokeStyle=h;var j=1.5*i;d=f.p2c(d),e=g.p2c(e),jb.beginPath(),"circle"==b.points.symbol?jb.arc(d,e,j,0,2*Math.PI,!1):b.points.symbol(jb,d,e,j,!1),jb.closePath(),jb.stroke()}}function bb(b,c){var d,e="string"==typeof b.highlightColor?b.highlightColor:a.color.parse(b.color).scale("a",.5).toString(),f=e;switch(b.bars.align){case"left":d=0;break;case"right":d=-b.bars.barWidth;break;default:d=-b.bars.barWidth/2}jb.lineWidth=b.bars.lineWidth,jb.strokeStyle=e,O(c[0],c[1],c[2]||0,d,d+b.bars.barWidth,function(){return f},b.xaxis,b.yaxis,jb,b.bars.horizontal,b.bars.lineWidth)}function cb(b,c,d,e){if("string"==typeof b)return b;for(var f=ib.createLinearGradient(0,d,0,c),g=0,h=b.colors.length;h>g;++g){var i=b.colors[g];if("string"!=typeof i){var j=a.color.parse(e);null!=i.brightness&&(j=j.scale("rgb",i.brightness)),null!=i.opacity&&(j.a*=i.opacity),i=j.toString()}f.addColorStop(g/(h-1),i)}return f}var db=[],eb={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},fb=null,gb=null,hb=null,ib=null,jb=null,kb=[],lb=[],mb={left:0,right:0,top:0,bottom:0},nb=0,ob=0,pb={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},qb=this;qb.setData=k,qb.setupGrid=B,qb.draw=G,qb.getPlaceholder=function(){return c},qb.getCanvas=function(){return fb.element},qb.getPlotOffset=function(){return mb},qb.width=function(){return nb},qb.height=function(){return ob},qb.offset=function(){var a=hb.offset();return a.left+=mb.left,a.top+=mb.top,a},qb.getData=function(){return db},qb.getAxes=function(){var b={};return a.each(kb.concat(lb),function(a,c){c&&(b[c.direction+(1!=c.n?c.n:"")+"axis"]=c)}),b},qb.getXAxes=function(){return kb},qb.getYAxes=function(){return lb},qb.c2p=o,qb.p2c=p,qb.getOptions=function(){return eb},qb.highlight=Z,qb.unhighlight=$,qb.triggerRedrawOverlay=X,qb.pointOffset=function(a){return{left:parseInt(kb[m(a,"x")-1].p2c(+a.x)+mb.left,10),top:parseInt(lb[m(a,"y")-1].p2c(+a.y)+mb.top,10)}},qb.shutdown=v,qb.destroy=function(){v(),c.removeData("plot").empty(),db=[],eb=null,fb=null,gb=null,hb=null,ib=null,jb=null,kb=[],lb=[],pb=null,rb=[],qb=null},qb.resize=function(){var a=c.width(),b=c.height();fb.resize(a,b),gb.resize(a,b)},qb.hooks=pb,i(qb),j(f),t(),k(e),B(),G(),u();var rb=[],sb=null}function d(a,b){return b*Math.floor(a/b)}var e=Object.prototype.hasOwnProperty;a.fn.detach||(a.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})}),b.prototype.resize=function(a,b){if(0>=a||0>=b)throw new Error("Invalid dimensions for plot, width = "+a+", height = "+b);var c=this.element,d=this.context,e=this.pixelRatio;this.width!=a&&(c.width=a*e,c.style.width=a+"px",this.width=a),this.height!=b&&(c.height=b*e,c.style.height=b+"px",this.height=b),d.restore(),d.save(),d.scale(e,e)},b.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},b.prototype.render=function(){var a=this._textCache;for(var b in a)if(e.call(a,b)){var c=this.getTextLayer(b),d=a[b];c.hide();for(var f in d)if(e.call(d,f)){var g=d[f];for(var h in g)if(e.call(g,h)){for(var i,j=g[h].positions,k=0;i=j[k];k++)i.active?i.rendered||(c.append(i.element),i.rendered=!0):(j.splice(k--,1),i.rendered&&i.element.detach());0==j.length&&delete g[h]}}c.show()}},b.prototype.getTextLayer=function(b){var c=this.text[b];return null==c&&(null==this.textContainer&&(this.textContainer=a("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),c=this.text[b]=a("<div></div>").addClass(b).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),c},b.prototype.getTextInfo=function(b,c,d,e,f){var g,h,i,j;if(c=""+c,g="object"==typeof d?d.style+" "+d.variant+" "+d.weight+" "+d.size+"px/"+d.lineHeight+"px "+d.family:d,h=this._textCache[b],null==h&&(h=this._textCache[b]={}),i=h[g],null==i&&(i=h[g]={}),j=i[c],null==j){var k=a("<div></div>").html(c).css({position:"absolute","max-width":f,top:-9999}).appendTo(this.getTextLayer(b));"object"==typeof d?k.css({font:g,color:d.color}):"string"==typeof d&&k.addClass(d),j=i[c]={width:k.outerWidth(!0),height:k.outerHeight(!0),element:k,positions:[]},k.detach()}return j},b.prototype.addText=function(a,b,c,d,e,f,g,h,i){var j=this.getTextInfo(a,d,e,f,g),k=j.positions;"center"==h?b-=j.width/2:"right"==h&&(b-=j.width),"middle"==i?c-=j.height/2:"bottom"==i&&(c-=j.height);for(var l,m=0;l=k[m];m++)if(l.x==b&&l.y==c)return void(l.active=!0);l={active:!0,rendered:!1,element:k.length?j.element.clone():j.element,x:b,y:c},k.push(l),l.element.css({top:Math.round(c),left:Math.round(b),"text-align":h})},b.prototype.removeText=function(a,b,c,d,f,g){if(null==d){var h=this._textCache[a];if(null!=h)for(var i in h)if(e.call(h,i)){var j=h[i];for(var k in j)if(e.call(j,k))for(var l,m=j[k].positions,n=0;l=m[n];n++)l.active=!1}}else for(var l,m=this.getTextInfo(a,d,f,g).positions,n=0;l=m[n];n++)l.x==b&&l.y==c&&(l.active=!1)},a.plot=function(b,d,e){var f=new c(a(b),d,e,a.plot.plugins);return f},a.plot.version="0.8.3",a.plot.plugins=[],a.fn.plot=function(b,c){return this.each(function(){a.plot(this,b,c)})}}(jQuery),!function(a){function b(a){function b(a,b,e){var g=null;if(c(b))if(l(b),d(a),f(a),k(b),s>=2){var h=m(b),i=0,j=n();i=o(h)?-1*p(r,h-1,Math.floor(s/2)-1)-j:p(r,Math.ceil(s/2),h-2)+j+2*u,g=q(e,b,i),e.points=g}else if(1==s){var j=-1*n();g=q(e,b,j),e.points=g}return g}function c(a){return null!=a.bars&&a.bars.show&&null!=a.bars.order}function d(a){var b=y?a.getPlaceholder().innerHeight():a.getPlaceholder().innerWidth(),c=y?e(a.getData(),1):e(a.getData(),0),d=c[1]-c[0];x=d/b}function e(a,b){for(var c=new Array,d=0;d<a.length;d++)c[0]=a[d].data[0][b],c[1]=a[d].data[a[d].data.length-1][b];return"string"==typeof c[0]&&(c[0]=0,c[1]=a[0].data.length-1),c}function f(a){r=g(a.getData()),s=r.length}function g(a){for(var b=new Array,c=0;c<a.length;c++)null!=a[c].bars.order&&a[c].bars.show&&b.push(a[c]);return h(b)}function h(a){var b=a.length;do{for(var c=0;b-1>c;c++)if(a[c].bars.order>a[c+1].bars.order){var d=a[c];a[c]=a[c+1],a[c+1]=d}else if(a[c].bars.order==a[c+1].bars.order){var e;a[c].sameSeriesArrayIndex?void 0!==a[c+1].sameSeriesArrayIndex&&(e=a[c].sameSeriesArrayIndex,a[c+1].sameSeriesArrayIndex=e,w[e].push(a[c+1]),w[e].sort(i),a[c]=w[e][0],j(a,c+1)):a[c+1].sameSeriesArrayIndex?void 0!==a[c].sameSeriesArrayIndex&&(e=a[c+1].sameSeriesArrayIndex,a[c].sameSeriesArrayIndex=e,w[e].push(a[c]),w[e].sort(i),a[c]=w[e][0],j(a,c+1)):(e=w.length,w[e]=new Array,a[c].sameSeriesArrayIndex=e,a[c+1].sameSeriesArrayIndex=e,w[e].push(a[c]),w[e].push(a[c+1]),w[e].sort(i),a[c]=w[e][0],j(a,c+1)),c--,b--}b-=1}while(b>1);for(var c=0;c<a.length;c++)a[c].sameSeriesArrayIndex&&(v[a[c].sameSeriesArrayIndex]=c);return a}function i(a,b){var c=a.bars.barWidth?a.bars.barWidth:1,d=b.bars.barWidth?b.bars.barWidth:1;return d>c?-1:c>d?1:0}function j(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=0>b?a.length+b:b,a.push.apply(a,d),a}function k(a){t="number"==typeof a.bars.lineWidth?a.bars.lineWidth:2,u=t*x}function l(a){a.bars.horizontal&&(y=!0)}function m(a){var b=0;if(a.sameSeriesArrayIndex)b=v[a.sameSeriesArrayIndex];else for(var c=0;c<r.length;++c)if(a==r[c]){b=c;break}return b+1}function n(){var a=0;return s%2!=0&&(a=r[Math.floor(s/2)].bars.barWidth/2),a}function o(a){return a<=Math.ceil(s/2)}function p(a,b,c){for(var d=0,e=b;c>=e;e++)d+=a[e].bars.barWidth+2*u;return d}function q(a,b,c){for(var d=a.pointsize,e=a.points,f=0,g=y?1:0;g<e.length;g+=d)e[g]+=c,b.data[f][3]=e[g],f++;return e}var r,s,t,u,v=new Array,w=new Array,x=1,y=!1;a.hooks.processDatapoints.push(b)}var c={series:{bars:{order:null}}};a.plot.plugins.push({init:b,options:c,name:"orderBars",version:"0.2"})}(jQuery),!function(a){function b(a,b){return b*Math.floor(a/b)}function c(a,b,c,d){if("function"==typeof a.strftime)return a.strftime(b);var e=function(a,b){return a=""+a,b=""+(null==b?"0":b),1==a.length?b+a:a},f=[],g=!1,h=a.getHours(),i=12>h;null==c&&(c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),null==d&&(d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);
var j;j=h>12?h-12:0==h?12:h;for(var k=0;k<b.length;++k){var l=b.charAt(k);if(g){switch(l){case"a":l=""+d[a.getDay()];break;case"b":l=""+c[a.getMonth()];break;case"d":l=e(a.getDate());break;case"e":l=e(a.getDate()," ");break;case"h":case"H":l=e(h);break;case"I":l=e(j);break;case"l":l=e(j," ");break;case"m":l=e(a.getMonth()+1);break;case"M":l=e(a.getMinutes());break;case"q":l=""+(Math.floor(a.getMonth()/3)+1);break;case"S":l=e(a.getSeconds());break;case"y":l=e(a.getFullYear()%100);break;case"Y":l=""+a.getFullYear();break;case"p":l=i?"am":"pm";break;case"P":l=i?"AM":"PM";break;case"w":l=""+a.getDay()}f.push(l),g=!1}else"%"==l?g=!0:f.push(l)}return f.join("")}function d(a){function b(a,b,c,d){a[b]=function(){return c[d].apply(c,arguments)}}var c={date:a};void 0!=a.strftime&&b(c,"strftime",a,"strftime"),b(c,"getTime",a,"getTime"),b(c,"setTime",a,"setTime");for(var d=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],e=0;e<d.length;e++)b(c,"get"+d[e],a,"getUTC"+d[e]),b(c,"set"+d[e],a,"setUTC"+d[e]);return c}function e(a,b){if("browser"==b.timezone)return new Date(a);if(b.timezone&&"utc"!=b.timezone){if("undefined"!=typeof timezoneJS&&"undefined"!=typeof timezoneJS.Date){var c=new timezoneJS.Date;return c.setTimezone(b.timezone),c.setTime(a),c}return d(new Date(a))}return d(new Date(a))}function f(d){d.hooks.processOptions.push(function(d){a.each(d.getAxes(),function(a,d){var f=d.options;"time"==f.mode&&(d.tickGenerator=function(a){var c=[],d=e(a.min,f),g=0,i=f.tickSize&&"quarter"===f.tickSize[1]||f.minTickSize&&"quarter"===f.minTickSize[1]?k:j;null!=f.minTickSize&&(g="number"==typeof f.tickSize?f.tickSize:f.minTickSize[0]*h[f.minTickSize[1]]);for(var l=0;l<i.length-1&&!(a.delta<(i[l][0]*h[i[l][1]]+i[l+1][0]*h[i[l+1][1]])/2&&i[l][0]*h[i[l][1]]>=g);++l);var m=i[l][0],n=i[l][1];if("year"==n){if(null!=f.minTickSize&&"year"==f.minTickSize[1])m=Math.floor(f.minTickSize[0]);else{var o=Math.pow(10,Math.floor(Math.log(a.delta/h.year)/Math.LN10)),p=a.delta/h.year/o;m=1.5>p?1:3>p?2:7.5>p?5:10,m*=o}1>m&&(m=1)}a.tickSize=f.tickSize||[m,n];var q=a.tickSize[0];n=a.tickSize[1];var r=q*h[n];"second"==n?d.setSeconds(b(d.getSeconds(),q)):"minute"==n?d.setMinutes(b(d.getMinutes(),q)):"hour"==n?d.setHours(b(d.getHours(),q)):"month"==n?d.setMonth(b(d.getMonth(),q)):"quarter"==n?d.setMonth(3*b(d.getMonth()/3,q)):"year"==n&&d.setFullYear(b(d.getFullYear(),q)),d.setMilliseconds(0),r>=h.minute&&d.setSeconds(0),r>=h.hour&&d.setMinutes(0),r>=h.day&&d.setHours(0),r>=4*h.day&&d.setDate(1),r>=2*h.month&&d.setMonth(b(d.getMonth(),3)),r>=2*h.quarter&&d.setMonth(b(d.getMonth(),6)),r>=h.year&&d.setMonth(0);var s,t=0,u=Number.NaN;do if(s=u,u=d.getTime(),c.push(u),"month"==n||"quarter"==n)if(1>q){d.setDate(1);var v=d.getTime();d.setMonth(d.getMonth()+("quarter"==n?3:1));var w=d.getTime();d.setTime(u+t*h.hour+(w-v)*q),t=d.getHours(),d.setHours(0)}else d.setMonth(d.getMonth()+q*("quarter"==n?3:1));else"year"==n?d.setFullYear(d.getFullYear()+q):d.setTime(u+r);while(u<a.max&&u!=s);return c},d.tickFormatter=function(a,b){var d=e(a,b.options);if(null!=f.timeformat)return c(d,f.timeformat,f.monthNames,f.dayNames);var g,i=b.options.tickSize&&"quarter"==b.options.tickSize[1]||b.options.minTickSize&&"quarter"==b.options.minTickSize[1],j=b.tickSize[0]*h[b.tickSize[1]],k=b.max-b.min,l=f.twelveHourClock?" %p":"",m=f.twelveHourClock?"%I":"%H";g=j<h.minute?m+":%M:%S"+l:j<h.day?k<2*h.day?m+":%M"+l:"%b %d "+m+":%M"+l:j<h.month?"%b %d":i&&j<h.quarter||!i&&j<h.year?k<h.year?"%b":"%b %Y":i&&j<h.year?k<h.year?"Q%q":"Q%q %Y":"%Y";var n=c(d,g,f.monthNames,f.dayNames);return n})})})}var g={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}},h={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,quarter:7776e6,year:525949.2*60*1e3},i=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],j=i.concat([[3,"month"],[6,"month"],[1,"year"]]),k=i.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);a.plot.plugins.push({init:f,options:g,name:"time",version:"1.0"}),a.plot.formatDate=c,a.plot.dateGenerator=e}(jQuery),function(a){var b,c=a({});a.ajaxQueue=function(d){function e(c){f=a.ajax(d).retry(d.retry),f.done(g.resolve).fail(g.reject).then(c,c),b=f}var f,g=a.Deferred(),h=g.promise();return c.queue(e),h.abort=function(b){if(f)return f.abort(b);var i=c.queue(),j=a.inArray(e,i);return j>-1&&i.splice(j,1),g.rejectWith(d.context||d,[h,b,""]),h},h},a.ajaxQueue.clear=function(){c.clearQueue(),b instanceof jQuery&&b.abort()}}(jQuery);